webpackJsonp([10],{"1Xk4":function(t,e,r){"use strict";var i=r("awF4"),n=r("Rl2i"),a=r("sD9O"),o=r("q+vg");function s(t,e,r){var i=t;return n(e)?(r=e,"string"==typeof t&&(i={uri:t})):i=o(e,{uri:t}),i.callback=r,i}function l(t,e,r){return u(e=s(t,e,r))}function u(t){if(void 0===t.callback)throw new Error("callback argument missing");var e=!1,r=function(r,i,n){e||(e=!0,t.callback(r,i,n))};function i(t){return clearTimeout(c),t instanceof Error||(t=new Error(""+(t||"Unknown XMLHttpRequest Error"))),t.statusCode=0,r(t,m)}function n(){if(!s){var e;clearTimeout(c),e=t.useXDR&&void 0===u.status?200:1223===u.status?204:u.status;var i=m,n=null;return 0!==e?(i={body:function(){var t=void 0;if(t=u.response?u.response:u.responseText||function(t){if("document"===t.responseType)return t.responseXML;var e=t.responseXML&&"parsererror"===t.responseXML.documentElement.nodeName;return""!==t.responseType||e?null:t.responseXML}(u),v)try{t=JSON.parse(t)}catch(t){}return t}(),statusCode:e,method:d,headers:{},url:h,rawRequest:u},u.getAllResponseHeaders&&(i.headers=a(u.getAllResponseHeaders()))):n=new Error("Internal XMLHttpRequest Error"),r(n,i,i.body)}}var o,s,u=t.xhr||null;u||(u=t.cors||t.useXDR?new l.XDomainRequest:new l.XMLHttpRequest);var c,h=u.url=t.uri||t.url,d=u.method=t.method||"GET",f=t.body||t.data,p=u.headers=t.headers||{},g=!!t.sync,v=!1,m={body:void 0,headers:{},statusCode:0,method:d,url:h,rawRequest:u};if("json"in t&&!1!==t.json&&(v=!0,p.accept||p.Accept||(p.Accept="application/json"),"GET"!==d&&"HEAD"!==d&&(p["content-type"]||p["Content-Type"]||(p["Content-Type"]="application/json"),f=JSON.stringify(!0===t.json?f:t.json))),u.onreadystatechange=function(){4===u.readyState&&setTimeout(n,0)},u.onload=n,u.onerror=i,u.onprogress=function(){},u.onabort=function(){s=!0},u.ontimeout=i,u.open(d,h,!g,t.username,t.password),g||(u.withCredentials=!!t.withCredentials),!g&&t.timeout>0&&(c=setTimeout(function(){if(!s){s=!0,u.abort("timeout");var t=new Error("XMLHttpRequest timeout");t.code="ETIMEDOUT",i(t)}},t.timeout)),u.setRequestHeader)for(o in p)p.hasOwnProperty(o)&&u.setRequestHeader(o,p[o]);else if(t.headers&&!function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0}(t.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in t&&(u.responseType=t.responseType),"beforeSend"in t&&"function"==typeof t.beforeSend&&t.beforeSend(u),u.send(f||null),u}t.exports=l,l.XMLHttpRequest=i.XMLHttpRequest||function(){},l.XDomainRequest="withCredentials"in new l.XMLHttpRequest?l.XMLHttpRequest:i.XDomainRequest,function(t,e){for(var r=0;r<t.length;r++)e(t[r])}(["get","put","post","patch","head","delete"],function(t){l["delete"===t?"del":t]=function(e,r,i){return(r=s(e,r,i)).method=t.toUpperCase(),u(r)}})},Bwfg:function(t,e){var r={"":!0,up:!0};function i(t){return"number"==typeof t&&t>=0&&t<=100}t.exports=function(){var t=100,e=3,n=0,a=100,o=0,s=100,l="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return t},set:function(e){if(!i(e))throw new Error("Width must be between 0 and 100.");t=e}},lines:{enumerable:!0,get:function(){return e},set:function(t){if("number"!=typeof t)throw new TypeError("Lines must be set to a number.");e=t}},regionAnchorY:{enumerable:!0,get:function(){return a},set:function(t){if(!i(t))throw new Error("RegionAnchorX must be between 0 and 100.");a=t}},regionAnchorX:{enumerable:!0,get:function(){return n},set:function(t){if(!i(t))throw new Error("RegionAnchorY must be between 0 and 100.");n=t}},viewportAnchorY:{enumerable:!0,get:function(){return s},set:function(t){if(!i(t))throw new Error("ViewportAnchorY must be between 0 and 100.");s=t}},viewportAnchorX:{enumerable:!0,get:function(){return o},set:function(t){if(!i(t))throw new Error("ViewportAnchorX must be between 0 and 100.");o=t}},scroll:{enumerable:!0,get:function(){return l},set:function(t){var e=function(t){return"string"==typeof t&&!!r[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");l=e}}})}},DuR2:function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},"I/+Z":function(t,e){t.exports=function(t,e){var r,i=null;try{r=JSON.parse(t,e)}catch(t){i=t}return[i,r]}},Ixwk:function(t,e,r){var i;"undefined"!=typeof self&&self,i=function(t,e){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=15)}([function(t,e,r){"use strict";e.a=function(t,e,r,i,n,a,o,s){var l=typeof(t=t||{}).default;"object"!==l&&"function"!==l||(t=t.default);var u,c="function"==typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=r,c._compiled=!0),i&&(c.functional=!0),a&&(c._scopeId=a),o?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},c._ssrRegister=u):n&&(u=s?function(){n.call(this,this.$root.$options.shadowRoot)}:n),u)if(c.functional){c._injectStyles=u;var h=c.render;c.render=function(t,e){return u.call(e),h(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,u):[u]}return{exports:t,options:c}}},function(t,e){function r(t,e){var r=t[1]||"",i=t[3];if(!i)return r;if(e&&"function"==typeof btoa){var n=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(i);return[r].concat(i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"})).concat([n]).join("\n")}return[r].join("\n")}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=r(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},n=0;n<this.length;n++){var a=this[n][0];"number"==typeof a&&(i[a]=!0)}for(n=0;n<t.length;n++){var o=t[n];"number"==typeof o[0]&&i[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),e.push(o))}},e}},function(t,e,r){"use strict";function i(t){for(var e=0;e<t.length;e++){var r=t[e],i=u[r.id];if(i){i.refs++;for(var n=0;n<i.parts.length;n++)i.parts[n](r.parts[n]);for(;n<r.parts.length;n++)i.parts.push(a(r.parts[n]));i.parts.length>r.parts.length&&(i.parts.length=r.parts.length)}else{var o=[];for(n=0;n<r.parts.length;n++)o.push(a(r.parts[n]));u[r.id]={id:r.id,refs:1,parts:o}}}}function n(){var t=document.createElement("style");return t.type="text/css",c.appendChild(t),t}function a(t){var e,r,i=document.querySelector("style["+v+'~="'+t.id+'"]');if(i){if(f)return p;i.parentNode.removeChild(i)}if(m){var a=d++;i=h||(h=n()),e=o.bind(null,i,a,!1),r=o.bind(null,i,a,!0)}else i=n(),e=function(t,e){var r=e.css,i=e.media,n=e.sourceMap;if(i&&t.setAttribute("media",i),g.ssrId&&t.setAttribute(v,e.id),n&&(r+="\n/*# sourceURL="+n.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */"),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,i),r=function(){i.parentNode.removeChild(i)};return e(t),function(i){if(i){if(i.css===t.css&&i.media===t.media&&i.sourceMap===t.sourceMap)return;e(t=i)}else r()}}function o(t,e,r,i){var n=r?"":i.css;if(t.styleSheet)t.styleSheet.cssText=y(e,n);else{var a=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(a,o[e]):t.appendChild(a)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,r,n){f=r,g=n||{};var a=Object(s.a)(t,e);return i(a),function(e){for(var r=[],n=0;n<a.length;n++){var o=a[n];(l=u[o.id]).refs--,r.push(l)}for(e?i(a=Object(s.a)(t,e)):a=[],n=0;n<r.length;n++){var l;if(0===(l=r[n]).refs){for(var c=0;c<l.parts.length;c++)l.parts[c]();delete u[l.id]}}}};var s=r(18),l="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!l)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var u={},c=l&&(document.head||document.getElementsByTagName("head")[0]),h=null,d=0,f=!1,p=function(){},g=null,v="data-vue-ssr-id",m="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase()),y=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},function(t,e,r){"use strict";function i(t){return console.warn("[Vue-APlayer] "+t)}e.d=function(t){if(t){for(var e=(t=t.replace(/([^\]^\n])\[/g,function(t,e){return e+"\n["})).split("\n"),r=[],i=e.length,n=0;n<i;n++){var a=e[n].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),o=e[n].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$/g,"");if(a)for(var s=a.length,l=0;l<s;l++){var u=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(a[l]),c=60*u[1]+parseInt(u[2])+(u[4]?parseInt(u[4])/(2===(u[4]+"").length?100:1e3):0);r.push([c,o])}}return r.sort(function(t,e){return t[0]-e[0]}),r}return[]},e.e=function(t,e){if(t===e)return 0;var r=t.split(".").map(Number),i=n(r,3),a=i[0],o=i[1],s=i[2],l=e.split(".").map(Number),u=n(l,3),c=u[0],h=u[1],d=u[2];if(a>c)return 1;if(a===c){if(o>h)return 1;if(o===h&&s>d)return 1}return-1},e.f=i,e.a=function(t,e,r){return i("'"+t+"' is deprecated since v"+e+", and will be removed in future releases, use '"+r+"' instead")},e.b=function(t){for(var e=t.offsetLeft,r=t.offsetParent;null!==r;)e+=r.offsetLeft,r=r.offsetParent;return e-(document.body.scrollLeft+document.documentElement.scrollLeft)},e.c=function(t){for(var e=t.offsetTop,r=t.offsetParent;null!==r;)e+=r.offsetTop,r=r.offsetParent;return e-(document.body.scrollTop+document.documentElement.scrollTop)};var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},function(t,e,r){"use strict";var i=r(7),n=r(44),a=r(0),o=function(t){r(25)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){"use strict";var i=r(19),n=r.n(i),a=r(20),o=r(46),s=r(50),l=r(62),u=r(3),c=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=!1,d=Object(u.e)(n.a.version,"2.3.0")>=0,f={},p=null,g="none",v="music",m="no-repeat",y="repeat-one",b="repeat-all",_={name:"APlayer",disableVersionBadge:!1,components:{Thumbnail:a.a,Controls:s.a,MusicList:o.a,Lyrics:l.a},props:{music:{type:Object,required:!0,validator:function(t){return t.url&&Object(u.a)("music.url","1.4.0","music.src"),t.author&&Object(u.a)("music.author","1.4.1","music.artist"),t.src||t.url}},list:{type:Array,default:function(){return[]}},mini:{type:Boolean,default:!1},showLrc:{type:Boolean,default:!1},mutex:{type:Boolean,default:!0},theme:{type:String,default:"#41b883"},listMaxHeight:String,listFolded:{type:Boolean,default:!1},float:{type:Boolean,default:!1},autoplay:{type:Boolean,default:!1},controls:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},preload:String,volume:{type:Number,default:.8,validator:function(t){return t>=0&&t<=1}},shuffle:{type:Boolean,default:!1},repeat:{type:String,default:m},listmaxheight:{type:String,validator:function(t){return t&&Object(u.a)("listmaxheight","1.1.2","listMaxHeight"),!0}},narrow:{type:Boolean,default:!1,validator:function(t){return t&&Object(u.a)("narrow","1.1.2","mini"),!0}},showlrc:{type:Boolean,default:!1,validator:function(t){return t&&Object(u.a)("showlrc","1.2.2","showLrc"),!0}}},data:function(){return{internalMusic:this.music,isPlaying:!1,isSeeking:!1,wasPlayingBeforeSeeking:!1,isMobile:/mobile/i.test(window.navigator.userAgent),playStat:{duration:0,loadedTime:0,playedTime:0},showList:!this.listFolded,audioPlayPromise:Promise.resolve(),floatOriginX:0,floatOriginY:0,floatOffsetLeft:0,floatOffsetTop:0,selfAdaptingTheme:null,internalMuted:this.muted,internalVolume:this.volume,isLoading:!1,internalShuffle:this.shuffle,internalRepeat:this.repeat,shuffledList:[]}},computed:{audio:function(){return this.$refs.audio},currentMusic:{get:function(){return this.internalMusic},set:function(t){d&&this.$emit("update:music",t),this.internalMusic=t}},isMiniMode:function(){return this.mini||this.narrow},shouldShowLrc:function(){return this.showLrc||this.showlrc},currentTheme:function(){return this.selfAdaptingTheme||this.currentMusic.theme||this.theme},isFloatMode:function(){return this.float&&!this.isMobile},shouldAutoplay:function(){return!this.isMobile&&this.autoplay},musicList:function(){return this.list},shouldShowNativeControls:function(){return!1},floatStyleObj:function(){return{transform:"translate("+this.floatOffsetLeft+"px, "+this.floatOffsetTop+"px)",webkitTransform:"translate("+this.floatOffsetLeft+"px, "+this.floatOffsetTop+"px)"}},currentPicStyleObj:function(){return this.currentMusic&&this.currentMusic.pic?{backgroundImage:"url("+this.currentMusic.pic+")"}:{}},loadProgress:function(){return 0===this.playStat.duration?0:this.playStat.loadedTime/this.playStat.duration},playProgress:function(){return 0===this.playStat.duration?0:this.playStat.playedTime/this.playStat.duration},playIndex:{get:function(){return this.shuffledList.indexOf(this.currentMusic)},set:function(t){this.currentMusic=this.shuffledList[t%this.shuffledList.length]}},shouldRepeat:function(){return this.repeatMode!==m},isAudioMuted:{get:function(){return this.internalMuted},set:function(t){d&&this.$emit("update:muted",t),this.internalMuted=t}},audioVolume:{get:function(){return this.internalVolume},set:function(t){d&&this.$emit("update:volume",t),this.internalVolume=t}},shouldShuffle:{get:function(){return this.internalShuffle},set:function(t){d&&this.$emit("update:shuffle",t),this.internalShuffle=t}},repeatMode:{get:function(){switch(this.internalRepeat){case g:case m:return m;case v:case y:return y;default:return b}},set:function(t){d&&this.$emit("update:repeat",t),this.internalRepeat=t}}},methods:{onDragBegin:function(){this.floatOriginX=this.floatOffsetLeft,this.floatOriginY=this.floatOffsetTop},onDragAround:function(t){var e=t.offsetLeft,r=t.offsetTop;this.floatOffsetLeft=this.floatOriginX+e,this.floatOffsetTop=this.floatOriginY+r},setNextMode:function(){this.repeatMode===b?this.repeatMode=y:this.repeatMode===y?this.repeatMode=m:this.repeatMode=b},thenPlay:function(){var t=this;this.$nextTick(function(){t.play()})},toggle:function(){this.audio.paused?this.play():this.pause()},play:function(){var t=this;this.mutex&&(p&&p!==this&&p.pause(),p=this);var e=this.audio.play();if(e)return this.audioPlayPromise=new Promise(function(r,i){t.rejectPlayPromise=i,e.then(function(e){t.rejectPlayPromise=null,r(e)}).catch(u.f)})},pause:function(){var t=this;this.audioPlayPromise.then(function(){t.audio.pause()}).catch(function(){t.audio.pause()}),this.rejectPlayPromise&&(this.rejectPlayPromise(),this.rejectPlayPromise=null)},onProgressDragBegin:function(t){this.wasPlayingBeforeSeeking=this.isPlaying,this.pause(),this.isSeeking=!0,isNaN(this.audio.duration)||(this.audio.currentTime=this.audio.duration*t)},onProgressDragging:function(t){isNaN(this.audio.duration)?this.playStat.playedTime=0:this.audio.currentTime=this.audio.duration*t},onProgressDragEnd:function(t){this.isSeeking=!1,this.wasPlayingBeforeSeeking&&this.thenPlay()},toggleMute:function(){this.setAudioMuted(!this.audio.muted)},setAudioMuted:function(t){this.audio.muted=t},setAudioVolume:function(t){this.audio.volume=t,t>0&&this.setAudioMuted(!1)},getShuffledList:function(){if(!this.list.length)return[this.internalMusic];var t=[].concat(function(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}(this.list));if(!this.internalShuffle||t.length<=1)return t;var e=t.indexOf(this.internalMusic);if(2===t.length&&-1!==e)return 0===e?t:[this.internalMusic,t[0]];for(var r=t.length-1;r>0;r--){var i=Math.floor(Math.random()*(r+1)),n=t[r];t[r]=t[i],t[i]=n}if(-1!==e&&0!==(e=t.indexOf(this.internalMusic))){var a=[t[e],t[0]];t[0]=a[0],t[e]=a[1]}return t},onSelectSong:function(t){this.currentMusic===t?this.toggle():(this.currentMusic=t,this.thenPlay())},onAudioPlay:function(){this.isPlaying=!0},onAudioPause:function(){this.isPlaying=!1},onAudioWaiting:function(){this.isLoading=!0},onAudioCanplay:function(){this.isLoading=!1},onAudioDurationChange:function(){1!==this.audio.duration&&(this.playStat.duration=this.audio.duration)},onAudioProgress:function(){this.audio.buffered.length?this.playStat.loadedTime=this.audio.buffered.end(this.audio.buffered.length-1):this.playStat.loadedTime=0},onAudioTimeUpdate:function(){this.playStat.playedTime=this.audio.currentTime},onAudioSeeking:function(){this.playStat.playedTime=this.audio.currentTime},onAudioSeeked:function(){this.playStat.playedTime=this.audio.currentTime},onAudioVolumeChange:function(){this.audioVolume=this.audio.volume,this.isAudioMuted=this.audio.muted},onAudioEnded:function(){this.repeatMode===b?(this.shouldShuffle&&this.playIndex===this.shuffledList.length-1&&(this.shuffledList=this.getShuffledList()),this.playIndex++,this.thenPlay()):this.repeatMode===y?this.thenPlay():(this.playIndex++,0!==this.playIndex?this.thenPlay():1===this.shuffledList.length&&(this.audio.currentTime=0))},initAudio:function(){var t=this;this.audio.controls=this.shouldShowNativeControls,this.audio.muted=this.muted,this.audio.preload=this.preload,this.audio.volume=this.volume,["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"].forEach(function(e){t.audio.addEventListener(e,function(r){return t.$emit(e,r)})}),this.audio.addEventListener("play",this.onAudioPlay),this.audio.addEventListener("pause",this.onAudioPause),this.audio.addEventListener("abort",this.onAudioPause),this.audio.addEventListener("waiting",this.onAudioWaiting),this.audio.addEventListener("canplay",this.onAudioCanplay),this.audio.addEventListener("progress",this.onAudioProgress),this.audio.addEventListener("durationchange",this.onAudioDurationChange),this.audio.addEventListener("seeking",this.onAudioSeeking),this.audio.addEventListener("seeked",this.onAudioSeeked),this.audio.addEventListener("timeupdate",this.onAudioTimeUpdate),this.audio.addEventListener("volumechange",this.onAudioVolumeChange),this.audio.addEventListener("ended",this.onAudioEnded),this.currentMusic&&(this.audio.src=this.currentMusic.src||this.currentMusic.url)},setSelfAdaptingTheme:function(){var t=this;if("pic"===(this.currentMusic.theme||this.theme)){var e=this.currentMusic.pic;if(f[e])this.selfAdaptingTheme=f[e];else try{(new ColorThief).getColorAsync(e,function(r){var i=c(r,3),n=i[0],a=i[1],o=i[2];f[e]="rgb("+n+", "+a+", "+o+")",t.selfAdaptingTheme="rgb("+n+", "+a+", "+o+")"})}catch(t){Object(u.f)("color-thief is required to support self-adapting theme")}}else this.selfAdaptingTheme=null}},watch:{music:function(t){this.internalMusic=t},currentMusic:{handler:function(t){this.setSelfAdaptingTheme();var e=t.src||t.url;if(/\.m3u8(?=(#|\?|$))/.test(e))if(this.audio.canPlayType("application/x-mpegURL")||this.audio.canPlayType("application/vnd.apple.mpegURL"))this.audio.src=e;else try{var i=r(66);i.isSupported()?(this.hls||(this.hls=new i),this.hls.loadSource(e),this.hls.attachMedia(this.audio)):(Object(u.f)("HLS is not supported on your browser"),this.audio.src=e)}catch(t){Object(u.f)("hls.js is required to support m3u8"),this.audio.src=e}else this.audio.src=e}},shouldShowNativeControls:function(t){this.audio.controls=t},isAudioMuted:function(t){this.audio.muted=t},preload:function(t){this.audio.preload=t},audioVolume:function(t){this.audio.volume=t},muted:function(t){this.internalMuted=t},volume:function(t){this.internalVolume=t},shuffle:function(t){this.internalShuffle=t},repeat:function(t){this.internalRepeat=t}},beforeCreate:function(){_.disableVersionBadge||h||(console.log("\n\n %c Vue-APlayer 1.6.1 %c vue-aplayer.js.org \n","color: #fff; background:#41b883; padding:5px 0;","color: #fff; background: #35495e; padding:5px 0;"),h=!0)},created:function(){this.shuffledList=this.getShuffledList()},mounted:function(){this.initAudio(),this.setSelfAdaptingTheme(),this.autoplay&&this.play()},beforeDestroy:function(){p===this&&(p=null),this.hls&&this.hls.destroy()}};e.a=_},function(t,e,r){"use strict";var i=r(4);e.a={components:{IconButton:i.a},props:{pic:String,theme:String,playing:{type:Boolean,default:!1},enableDrag:{type:Boolean,default:!1}},data:function(){return{hasMovedSinceMouseDown:!1,dragStartX:0,dragStartY:0}},computed:{currentPicStyleObj:function(){return this.pic?{backgroundImage:"url("+this.pic+")",backgroundColor:this.theme}:{}}},methods:{onDragBegin:function(t){this.enableDrag&&(this.hasMovedSinceMouseDown=!1,this.$emit("dragbegin"),this.dragStartX=t.clientX,this.dragStartY=t.clientY,document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp))},onDocumentMouseMove:function(t){this.hasMovedSinceMouseDown=!0,this.$emit("dragging",{offsetLeft:t.clientX-this.dragStartX,offsetTop:t.clientY-this.dragStartY})},onDocumentMouseUp:function(t){document.removeEventListener("mouseup",this.onDocumentMouseUp),document.removeEventListener("mousemove",this.onDocumentMouseMove),this.$emit("dragend")},onClick:function(){this.hasMovedSinceMouseDown||this.$emit("toggleplay")}}}},function(t,e,r){"use strict";var i=r(8);e.a={components:{Icon:i.a},props:["icon"]}},function(t,e,r){"use strict";var i=r(9),n=r(43),a=r(0),o=Object(a.a)(i.a,n.a,n.b,!1,null,null,null);e.a=o.exports},function(t,e,r){"use strict";var i=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(t){n=!0,a=t}finally{try{!i&&s.return&&s.return()}finally{if(n)throw a}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=r(27),a=n.keys().reduce(function(t,e){var r=n(e).match(/^<svg.+?viewBox="(.+?)".*><path.+?d="(.+?)".*><\/path><\/svg>$/),a=i(r,3),o=(a[0],a[1]),s=a[2];return t[e.match(/^.*\/(.+?)\.svg$/)[1]]={viewBox:o,d:s},t},{});e.a={props:["type"],computed:{svg:function(){return this.type,"prev"!==this.type&&this.type,a[this.type]||{}},style:function(){if("next"===this.type)return{transform:"rotate(180deg)"}}}}},function(t,e,r){"use strict";e.a={props:{show:{type:Boolean,default:!0},currentMusic:Object,musicList:{type:Array,default:function(){return[]}},playIndex:{type:Number,default:0},theme:String,listmaxheight:String},computed:{listHeightStyle:function(){return{height:33*this.musicList.length-1+"px",maxHeight:this.listmaxheight||""}}}}},function(t,e,r){"use strict";var i=r(4),n=r(53),a=r(57);e.a={components:{IconButton:i.a,VProgress:n.a,Volume:a.a},props:["shuffle","repeat","stat","theme","volume","muted"],computed:{loadProgress:function(){return 0===this.stat.duration?0:this.stat.loadedTime/this.stat.duration},playProgress:function(){return 0===this.stat.duration?0:this.stat.playedTime/this.stat.duration}},methods:{secondToTime:function(t){if(isNaN(t))return"00:00";var e=function(t){return t<10?"0"+t:""+t},r=Math.trunc(t/60),i=Math.trunc(t-60*r),n=Math.trunc(r/60),a=Math.trunc(t/60-60*Math.trunc(t/60/60));return t>=3600?e(n)+":"+e(a)+":"+e(i):e(r)+":"+e(i)}}}},function(t,e,r){"use strict";var i=r(3),n=r(8);e.a={components:{Icon:n.a},props:["loadProgress","playProgress","theme"],data:function(){return{thumbHovered:!1}},methods:{onThumbMouseDown:function(t){var e=this.$refs.barWrap.clientWidth,r=(t.clientX-Object(i.b)(this.$refs.barWrap))/e;r=(r=r>0?r:0)<1?r:1,this.$emit("dragbegin",r),document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp)},onDocumentMouseMove:function(t){var e=this.$refs.barWrap.clientWidth,r=(t.clientX-Object(i.b)(this.$refs.barWrap))/e;r=(r=r>0?r:0)<1?r:1,this.$emit("dragging",r)},onDocumentMouseUp:function(t){document.removeEventListener("mouseup",this.onDocumentMouseUp),document.removeEventListener("mousemove",this.onDocumentMouseMove);var e=this.$refs.barWrap.clientWidth,r=(t.clientX-Object(i.b)(this.$refs.barWrap))/e;r=(r=r>0?r:0)<1?r:1,this.$emit("dragend",r)},onThumbTouchStart:function(t){var e=this.$refs.barWrap.clientWidth,r=(t.clientX-Object(i.b)(this.$refs.barWrap))/e;r=(r=r>0?r:0)<1?r:1,this.$emit("dragbegin",r),document.addEventListener("touchmove",this.onDocumentTouchMove),document.addEventListener("touchend",this.onDocumentTouchEnd)},onDocumentTouchMove:function(t){var e=t.changedTouches[0],r=this.$refs.barWrap.clientWidth,n=(e.clientX-Object(i.b)(this.$refs.barWrap))/r;n=(n=n>0?n:0)<1?n:1,this.$emit("dragging",n)},onDocumentTouchEnd:function(t){document.removeEventListener("touchend",this.onDocumentTouchEnd),document.removeEventListener("touchmove",this.onDocumentTouchMove);var e=t.changedTouches[0],r=this.$refs.barWrap.clientWidth,n=(e.clientX-Object(i.b)(this.$refs.barWrap))/r;n=(n=n>0?n:0)<1?n:1,this.$emit("dragend",n)}}}},function(t,e,r){"use strict";var i=r(4),n=r(3);e.a={components:{IconButton:i.a},props:["volume","muted","theme"],computed:{volumeIcon:function(){return this.muted||this.volume<=0?"volume-off":this.volume>=1?"volume-up":"volume-down"}},methods:{adjustVolume:function(t){var e=(40-t.clientY+Object(n.c)(this.$refs.bar))/40;e=(e=e>0?e:0)<1?e:1,this.$emit("setvolume",e)},onBarMouseDown:function(){document.addEventListener("mousemove",this.onDocumentMouseMove),document.addEventListener("mouseup",this.onDocumentMouseUp)},onDocumentMouseMove:function(t){var e=(40-t.clientY+Object(n.c)(this.$refs.bar))/40;e=(e=e>0?e:0)<1?e:1,this.$emit("setvolume",e)},onDocumentMouseUp:function(t){document.removeEventListener("mouseup",this.onDocumentMouseUp),document.removeEventListener("mousemove",this.onDocumentMouseMove);var e=(40-t.clientY+Object(n.c)(this.$refs.bar))/40;e=(e=e>0?e:0)<1?e:1,this.$emit("setvolume",e)}}}},function(t,e,r){"use strict";var i=r(3);e.a={props:{currentMusic:{type:Object,required:!0},playStat:{type:Object,required:!0}},data:function(){return{displayLrc:"",currentLineIndex:0}},computed:{lrcLines:function(){return Object(i.d)(this.displayLrc)},currentLine:function(){return this.currentLineIndex>this.lrcLines.length-1?null:this.lrcLines[this.currentLineIndex]},transformStyle:function(){return{transform:"translateY("+16*-this.currentLineIndex+"px)",webkitTransform:"translateY("+16*-this.currentLineIndex+"px)"}}},methods:{applyLrc:function(t){/^https?:\/\//.test(t)?this.fetchLrc(t):this.displayLrc=t},fetchLrc:function(t){var e=this;fetch(t).then(function(t){return t.text()}).then(function(t){e.displayLrc=t})},hideLrc:function(){this.displayLrc=""}},watch:{currentMusic:{immediate:!0,handler:function(t){this.currentLineIndex=0,t.lrc?this.applyLrc(t.lrc):this.hideLrc()}},"playStat.playedTime":function(t){for(var e=0;e<this.lrcLines.length;e++){var r=this.lrcLines[e],i=this.lrcLines[e+1];t>=r[0]&&(!i||t<i[0])&&(this.currentLineIndex=e)}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(5),n=r(67),a=r(0),o=function(t){r(16)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.default=s.exports},function(t,e,r){var i=r(17);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("48028a76",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,".aplayer{font-family:Arial,Helvetica,sans-serif;color:#000;background-color:#fff;margin:5px;-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,.07),0 1px 5px 0 rgba(0,0,0,.1);box-shadow:0 2px 2px 0 rgba(0,0,0,.07),0 1px 5px 0 rgba(0,0,0,.1);border-radius:2px;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;line-height:normal;position:relative}.aplayer *{-webkit-box-sizing:content-box;box-sizing:content-box}.aplayer .aplayer-lrc-content{display:none}.aplayer .aplayer-body{display:-webkit-box;display:-ms-flexbox;display:flex;position:relative}.aplayer .aplayer-body .aplayer-info{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-align:start;padding:14px 7px 0 10px;height:66px;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden}.aplayer .aplayer-body .aplayer-info .aplayer-music{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;margin-left:5px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;cursor:default;padding-bottom:2px}.aplayer .aplayer-body .aplayer-info .aplayer-music .aplayer-title{font-size:14px}.aplayer .aplayer-body .aplayer-info .aplayer-music .aplayer-author{font-size:12px;color:#666}.aplayer .aplayer-body .aplayer-info .aplayer-lrc{z-index:0}.aplayer audio[controls]{display:block;width:100%}.aplayer.aplayer-narrow{width:66px}.aplayer.aplayer-withlrc .aplayer-body .aplayer-pic{height:90px;width:90px}.aplayer.aplayer-withlrc .aplayer-body .aplayer-info{height:90px;padding:10px 7px 0}.aplayer.aplayer-withlist .aplayer-body .aplayer-info{border-bottom:1px solid #e9e9e9}.aplayer.aplayer-withlist .aplayer-body .aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-menu{display:block}.aplayer.aplayer-float{z-index:1}@-webkit-keyframes aplayer-roll{0%{left:0}to{left:-100%}}@keyframes aplayer-roll{0%{left:0}to{left:-100%}}",""])},function(t,e,r){"use strict";e.a=function(t,e){for(var r=[],i={},n=0;n<e.length;n++){var a=e[n],o=a[0],s={id:t+":"+n,css:a[1],media:a[2],sourceMap:a[3]};i[o]?i[o].parts.push(s):r.push(i[o]={id:o,parts:[s]})}return r}},function(e,r){e.exports=t},function(t,e,r){"use strict";var i=r(6),n=r(45),a=r(0),o=function(t){r(21)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(22);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("082b31c5",i,!0,{})},function(t,e,r){var i=r(23);(t.exports=r(1)(!1)).push([t.i,".aplayer-float .aplayer-pic:active{cursor:move}.aplayer-pic{-ms-flex-negative:0;flex-shrink:0;position:relative;height:66px;width:66px;background-image:url("+i(r(24))+");background-size:cover;-webkit-transition:all .3s ease;transition:all .3s ease;cursor:pointer}.aplayer-pic:hover .aplayer-button{opacity:1}.aplayer-pic .aplayer-button{position:absolute;border-radius:50%;opacity:.8;text-shadow:0 1px 1px rgba(0,0,0,.2);-webkit-box-shadow:0 1px 1px rgba(0,0,0,.2);box-shadow:0 1px 1px rgba(0,0,0,.2);background:rgba(0,0,0,.2);-webkit-transition:all .1s ease;transition:all .1s ease}.aplayer-pic .aplayer-button .aplayer-fill{fill:#fff}.aplayer-pic .aplayer-play{width:26px;height:26px;border:2px solid #fff;bottom:50%;right:50%;margin:0 -15px -15px 0}.aplayer-pic .aplayer-play .aplayer-icon-play{position:absolute;top:3px;left:4px;height:20px;width:20px}.aplayer-pic .aplayer-pause{width:16px;height:16px;border:2px solid #fff;bottom:4px;right:4px}.aplayer-pic .aplayer-pause .aplayer-icon-pause{position:absolute;top:2px;left:2px;height:12px;width:12px}",""])},function(t,e){t.exports=function(t){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e){t.exports="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAAAeAAD/4QMfaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzA2NyA3OS4xNTc3NDcsIDIwMTUvMDMvMzAtMjM6NDA6NDIgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjE2NjQ3NUZBM0Y4RDExRTY4NzJCRDdCNkZCQTQ0MjNBIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjE2NjQ3NUY5M0Y4RDExRTY4NzJCRDdCNkZCQTQ0MjNBIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSI5OENEMEFFRjM0NTI1NjE0NEREQkU4RjkxRjAwNjM3NiIgc3RSZWY6ZG9jdW1lbnRJRD0iOThDRDBBRUYzNDUyNTYxNDREREJFOEY5MUYwMDYzNzYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7/7gAOQWRvYmUAZMAAAAAB/9sAhAAQCwsLDAsQDAwQFw8NDxcbFBAQFBsfFxcXFxcfHhcaGhoaFx4eIyUnJSMeLy8zMy8vQEBAQEBAQEBAQEBAQEBAAREPDxETERUSEhUUERQRFBoUFhYUGiYaGhwaGiYwIx4eHh4jMCsuJycnLis1NTAwNTVAQD9AQEBAQEBAQEBAQED/wAARCABkAGQDASIAAhEBAxEB/8QAgwAAAgIDAQAAAAAAAAAAAAAAAAYBBQIDBAcBAQEBAAAAAAAAAAAAAAAAAAABAhAAAQIEBAEJBgMHBQAAAAAAAQIDABEEBSExEgZBUWFxgaGxIhMUkTJCUmIVI0MWwdHh8XKSsvCCojNzEQEBAQEBAQEBAAAAAAAAAAAAAREhMVFBYf/aAAwDAQACEQMRAD8AaJ8vCJEYTjIZxtlIicc40VFZS0idVS6lpP1HE9Aind3dSrWWbdTPVruXgSQn98Awd0SBC+mp3fVYtUjFGk5F5U1S6Me6Mvtu6ncXbo01zNtzl2CJovwZxML/ANl3DwvZn/5fxiPt+72sWbkw/Lg4jTP/AImGhhiYWlXXdlD4q23IqWh7zlOZ/wCGrujpt+7bTWKDTijSvEy0O4CfJqy9sNMXmWMTECRExjzxMUEEEEBxLcbbQXHVBCEialKMgBFBU7jqax/0dmbU64fzJYy+aZwSOcxT7kvdPXVJpU6jTU5IC0HBauKucDhF7tS3ejolVJK51UlJQrCSRkeuJqppdspcV593dNU8cS0kkNjpPvKi8ZaZp2w3TtpabGSUAJHZEgzjXUVdPStebUOBpE5AnieQDieiKjeYyELVVva3ML0IZddI44IHaZxtod52upcDbqV0ylGSVLkUTP1JyibDDBOJxzjTUF8UzqqdIVUBtRZByK9J09seb1lzuKawuIqngRLSorUDMZ6k8DPMSwhaSPTwSDFbd7Bb7s2rzkBupl4KlIksH6vmHTE2GucuNqp6p3/tIKXCOKknST1xYgZDlihPsNxrLTXItFevXTuLU02omZadQZFP9Jw9ohxjz2tfF03GhFKdQXV6kqHINCJ/2tTj0KYJiQow6oIJY5QRR5hYLM5cK9KHkFNO1JbxIImOCeuPREyAAAkAJARyW63s26n8hlSnATqUtZmonnlKOucokhQtxDTa3XTpbbSVrVyJSNRhFq6usvNyap0K0v1JA5mG1YhtPJJOKzxOENG5HS3Yq1ScyhKSOZS0pPZCts8+ZfQtWK/LcUOk/wA4X3FhwoLJbKBgMtMIWZeN1xKVqWecqB9kJm7aKlo7wpulQGm3G0OKbT7qVKmDIcAZTh/LiW0KW4oJQgFS1HAAJEyTHnb6ndxX5XlAgVCwlH0MoEpnoSJwpD5ZFrXZ6JThOtTKJk9GHZCxvZmn9YHkJSh1KGw6QAC4p0uEauUhKIcmW0NNIaQJIbSEp5kpEhHntyqV3q7hlkzFQ/4T9ODSPYhM+uFI7rbZ9zU1EzXWuoGl5Ic9Pq0nH6XPAZ9MY1+6r2hh+3VjKGKojQtwApWlKhjhMjEcYZrzcW7JavMaA1pAZpUn5pSB6EgThT2xaTeLi5U1ZLjLJ8x4qzccUZhJ7zE/g6dlrtNO+t+pfSisUNDKF+EJScyFHCZh5BEpgzB4xR3TaVqr0lTKBR1BEw42JIJ+tvL2ShaZuN62xWejqZuMiRLKjqQtB+JpXD/U4vh69BxnKCK/73Qfa/uus+m0z+rVl5cvmnhBFRsHLyxIkrolGIMhKJSchAcl4pzVWmsYAmtbSijnUjxp7UwibdrEUd4pnlnS2olCycgFjTjHo4VHm9/paeku1QxTKCmtWrSPyyrFTf8AtiX6sW+5dwmtV9st5K2SoJdWnEuqnghP0z9sXe2rCLXTl18A1rwGvj5afkH7YoNov2aneW7WLCK2cmVOYISn6Tlq6Yaau+2mkaLjlU2ogYNtkLWo8JBMJ9GndFzFBanEpMqipmy1ygKHjV1J74odkW4u1blwWPw6ceW0eVxYx9ie+K+oeuG57sA0iXwtozSy1P3lHvh+t1AzbqNqkY9xsYq4qUcVKPSYe0/C9vxp9VPRvAEstqWlZGSVLCdM+mRjn2Xd6KkS9R1K0sqcUFtuKwSrCRSTDg42262pp1CXGljStChqSoHlBigqdk2h5RUyt2mn8CSFo6tePbDO6Ll67W1hOtyrZSn+sHsGMJW6r3S3Z9hukQS3T6gHSJFZXLBIzlhFs3sO3pV+JVPLHIEoR2+KLm32C024hdMwPNGTrh1r6irLqh2pwvfp+4fpPydJ9T5vqfT/ABaJadMvmljKCHLjxnBDDXDPGXGJmTkcogETMshjyxlPhFGqqfVT0b9QMSy2twDnSkkdsJtoomK7cC2KoB1plKtSVfmKT4ST0qUVQ7KbQ62th3xNuJUhY46VDSewwhvqrdvXsPrTqUMZ/C82fCVJP1dhiVYvKjY9vcVqpqhxgH8tQDgHQZpMRT7EokkF+qccHyISlufX4oubddKG5shymWCvNbRwWk84jtBMgeSGRNaKOgo7eyWaNoNIPvEYqUfqUcTHVOMRIxOKscooyBxg5eSIM5T48IkY/vgJOPVBOXOIBM80aKqspaNvzap1LaRlM4noGZgOjVBC5+sqX1ejyj6aUp6vxf6tGUuac4ImwxbAkKlEzBywjHGUgermiRPLhFGYJ48Y01tDSXBg09Y2HG5+E5KSZZoUMo2AgZRkDiBLDiIBQq9n3ClcL9pf80JxSkny3k9fuqjBvcu4bYfLuDBWBh+MgoV/eMDDoMyZ4RIM0kETT8pxETPi6WmN9UKhJ+ncQTnpIUP2R1p3jZCMVOJ5igxYu2q1vmbtGwvn0JB7JRznbthOJoW8eQqHcqHU40K3nZAMFOKllJB/bHI9vuiTMU9M44o/MQkdk4tUbdsaDMUTXXNXeY6maChp5eTTNI5ClCQe6HThWN+3Rc/Bb6UtIV8SUH/NeEZ02zrhWOefdqognNKT5izzajgIbpz7gIkfzhhqs/TFk9J6b0w05+ZM+ZPl1wRay9kEUV4y+qXZGachyc8EEBKeMAnLCf8ACCCAzE5d8ZHMS64IIA7oy+HDqgggIEpYdUZJnpE84IICeScSJYwQQE8IIIID/9k="},function(t,e,r){var i=r(26);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("a4518b4e",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,".aplayer-icon{width:15px;height:15px;border:none;background-color:transparent;outline:none;cursor:pointer;opacity:.8;vertical-align:middle;padding:0;font-size:12px;margin:0;display:inline}.aplayer-icon:hover{opacity:1}.aplayer-icon .aplayer-fill{-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}",""])},function(t,e,r){function i(t){return r(n(t))}function n(t){var e=a[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}var a={"./loading.svg":28,"./lrc.svg":29,"./menu.svg":30,"./no-repeat.svg":31,"./pause.svg":32,"./play.svg":33,"./repeat-all-legacy.svg":34,"./repeat-all.svg":35,"./repeat-one-legacy.svg":36,"./repeat-one.svg":37,"./shuffle.svg":38,"./skip.svg":39,"./volume-down.svg":40,"./volume-off.svg":41,"./volume-up.svg":42};i.keys=function(){return Object.keys(a)},i.resolve=n,t.exports=i,i.id=27},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M4 16c0-6.6 5.4-12 12-12s12 5.4 12 12c0 1.2-0.8 2-2 2s-2-0.8-2-2c0-4.4-3.6-8-8-8s-8 3.6-8 8 3.6 8 8 8c1.2 0 2 0.8 2 2s-0.8 2-2 2c-6.6 0-12-5.4-12-12z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M26.667 5.333h-21.333c-0 0-0.001 0-0.001 0-1.472 0-2.666 1.194-2.666 2.666 0 0 0 0.001 0 0.001v-0 16c0 0 0 0.001 0 0.001 0 1.472 1.194 2.666 2.666 2.666 0 0 0.001 0 0.001 0h21.333c0 0 0.001 0 0.001 0 1.472 0 2.666-1.194 2.666-2.666 0-0 0-0.001 0-0.001v0-16c0-0 0-0.001 0-0.001 0-1.472-1.194-2.666-2.666-2.666-0 0-0.001 0-0.001 0h0zM5.333 16h5.333v2.667h-5.333v-2.667zM18.667 24h-13.333v-2.667h13.333v2.667zM26.667 24h-5.333v-2.667h5.333v2.667zM26.667 18.667h-13.333v-2.667h13.333v2.667z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-5 0 32 32"><path d="M20.8 14.4q0.704 0 1.152 0.48t0.448 1.12-0.48 1.12-1.12 0.48h-19.2q-0.64 0-1.12-0.48t-0.48-1.12 0.448-1.12 1.152-0.48h19.2zM1.6 11.2q-0.64 0-1.12-0.48t-0.48-1.12 0.448-1.12 1.152-0.48h19.2q0.704 0 1.152 0.48t0.448 1.12-0.48 1.12-1.12 0.48h-19.2zM20.8 20.8q0.704 0 1.152 0.48t0.448 1.12-0.48 1.12-1.12 0.48h-19.2q-0.64 0-1.12-0.48t-0.48-1.12 0.448-1.12 1.152-0.48h19.2z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M2.667 7.027l1.707-1.693 22.293 22.293-1.693 1.707-4-4h-11.64v4l-5.333-5.333 5.333-5.333v4h8.973l-8.973-8.973v0.973h-2.667v-3.64l-4-4zM22.667 17.333h2.667v5.573l-2.667-2.667v-2.907zM22.667 6.667v-4l5.333 5.333-5.333 5.333v-4h-10.907l-2.667-2.667h13.573z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-8 0 32 32"><path d="M14.080 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048zM2.88 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112v-18.24q0-2.048 2.88-2.048z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-8 0 32 32"><path d="M15.552 15.168q0.448 0.32 0.448 0.832 0 0.448-0.448 0.768l-13.696 8.512q-0.768 0.512-1.312 0.192t-0.544-1.28v-16.448q0-0.96 0.544-1.28t1.312 0.192z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="-1 0 32 32"><path d="M25.6 9.92q1.344 0 2.272 0.928t0.928 2.272v9.28q0 1.28-0.928 2.24t-2.272 0.96h-22.4q-1.28 0-2.24-0.96t-0.96-2.24v-9.28q0-1.344 0.96-2.272t2.24-0.928h8v-3.52l6.4 5.76-6.4 5.76v-3.52h-6.72v6.72h19.84v-6.72h-4.8v-4.48h6.080z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M9.333 9.333h13.333v4l5.333-5.333-5.333-5.333v4h-16v8h2.667v-5.333zM22.667 22.667h-13.333v-4l-5.333 5.333 5.333 5.333v-4h16v-8h-2.667v5.333z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 38 32"><path d="M2.072 21.577c0.71-0.197 1.125-0.932 0.928-1.641-0.221-0.796-0.333-1.622-0.333-2.457 0-5.049 4.108-9.158 9.158-9.158h5.428c0.056-0.922 0.221-1.816 0.482-2.667h-5.911c-3.158 0-6.128 1.23-8.361 3.463s-3.463 5.203-3.463 8.361c0 1.076 0.145 2.143 0.431 3.171 0.164 0.59 0.7 0.976 1.284 0.976 0.117 0 0.238-0.016 0.357-0.049zM21.394 25.613h-12.409v-2.362c0-0.758-0.528-1.052-1.172-0.652l-5.685 3.522c-0.644 0.4-0.651 1.063-0.014 1.474l5.712 3.69c0.637 0.411 1.158 0.127 1.158-0.63v-2.374h12.409c3.158 0 6.128-1.23 8.361-3.463 1.424-1.424 2.44-3.148 2.99-5.029-0.985 0.368-2.033 0.606-3.125 0.691-1.492 3.038-4.619 5.135-8.226 5.135zM28.718 0c-4.985 0-9.026 4.041-9.026 9.026s4.041 9.026 9.026 9.026 9.026-4.041 9.026-9.026-4.041-9.026-9.026-9.026zM30.392 13.827h-1.728v-6.822c-0.635 0.576-1.433 1.004-2.407 1.285v-1.713c0.473-0.118 0.975-0.325 1.506-0.62 0.532-0.325 0.975-0.665 1.329-1.034h1.3v8.904z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M9.333 9.333h13.333v4l5.333-5.333-5.333-5.333v4h-16v8h2.667v-5.333zM22.667 22.667h-13.333v-4l-5.333 5.333 5.333 5.333v-4h16v-8h-2.667v5.333zM17.333 20v-8h-1.333l-2.667 1.333v1.333h2v5.333h2z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M22.667 4l7 6-7 6 7 6-7 6v-4h-3.653l-3.76-3.76 2.827-2.827 2.587 2.587h2v-8h-2l-12 12h-6v-4h4.347l12-12h3.653v-4zM2.667 8h6l3.76 3.76-2.827 2.827-2.587-2.587h-4.347v-4z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M25.468 6.947c-0.326-0.172-0.724-0.151-1.030 0.057l-6.438 4.38v-3.553c0-0.371-0.205-0.71-0.532-0.884-0.326-0.172-0.724-0.151-1.030 0.057l-12 8.164c-0.274 0.186-0.438 0.496-0.438 0.827s0.164 0.641 0.438 0.827l12 8.168c0.169 0.115 0.365 0.174 0.562 0.174 0.16 0 0.321-0.038 0.468-0.116 0.327-0.173 0.532-0.514 0.532-0.884v-3.556l6.438 4.382c0.169 0.115 0.365 0.174 0.562 0.174 0.16 0 0.321-0.038 0.468-0.116 0.327-0.173 0.532-0.514 0.532-0.884v-16.333c0-0.371-0.205-0.71-0.532-0.884z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8z"></path></svg>'},function(t,e){t.exports='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" viewBox="0 0 32 32"><path d="M13.728 6.272v19.456q0 0.448-0.352 0.8t-0.8 0.32-0.8-0.32l-5.952-5.952h-4.672q-0.48 0-0.8-0.352t-0.352-0.8v-6.848q0-0.48 0.352-0.8t0.8-0.352h4.672l5.952-5.952q0.32-0.32 0.8-0.32t0.8 0.32 0.352 0.8zM20.576 16q0 1.344-0.768 2.528t-2.016 1.664q-0.16 0.096-0.448 0.096-0.448 0-0.8-0.32t-0.32-0.832q0-0.384 0.192-0.64t0.544-0.448 0.608-0.384 0.512-0.64 0.192-1.024-0.192-1.024-0.512-0.64-0.608-0.384-0.544-0.448-0.192-0.64q0-0.48 0.32-0.832t0.8-0.32q0.288 0 0.448 0.096 1.248 0.48 2.016 1.664t0.768 2.528zM25.152 16q0 2.72-1.536 5.056t-4 3.36q-0.256 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.704 0.672-1.056 1.024-0.512 1.376-0.8 1.312-0.96 2.048-2.4t0.736-3.104-0.736-3.104-2.048-2.4q-0.352-0.288-1.376-0.8-0.672-0.352-0.672-1.056 0-0.448 0.32-0.8t0.8-0.352q0.224 0 0.48 0.096 2.496 1.056 4 3.36t1.536 5.056zM29.728 16q0 4.096-2.272 7.552t-6.048 5.056q-0.224 0.096-0.448 0.096-0.48 0-0.832-0.352t-0.32-0.8q0-0.64 0.704-1.056 0.128-0.064 0.384-0.192t0.416-0.192q0.8-0.448 1.44-0.896 2.208-1.632 3.456-4.064t1.216-5.152-1.216-5.152-3.456-4.064q-0.64-0.448-1.44-0.896-0.128-0.096-0.416-0.192t-0.384-0.192q-0.704-0.416-0.704-1.056 0-0.448 0.32-0.8t0.832-0.352q0.224 0 0.448 0.096 3.776 1.632 6.048 5.056t2.272 7.552z"></path></svg>'},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("svg",{style:t.style,attrs:{"xmlns:xlink":"http://www.w3.org/1999/xlink",height:"100%",version:"1.1",viewBox:t.svg.viewBox,width:"100%"}},[r("use",{attrs:{"xlink:href":"#aplayer-${type}"}}),t._v(" "),r("path",{staticClass:"aplayer-fill",attrs:{d:t.svg.d}})])},n=[]},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("button",{staticClass:"aplayer-icon",attrs:{type:"button"}},[r("icon",{attrs:{type:t.icon}})],1)},n=[]},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aplayer-pic",style:t.currentPicStyleObj,on:{mousedown:t.onDragBegin,click:t.onClick}},[r("div",{staticClass:"aplayer-button",class:t.playing?"aplayer-pause":"aplayer-play"},[r("icon-button",{class:t.playing?"aplayer-icon-pause":"aplayer-icon-play",attrs:{icon:t.playing?"pause":"play"}})],1)])},n=[]},function(t,e,r){"use strict";var i=r(10),n=r(49),a=r(0),o=function(t){r(47)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(48);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("7b9d1402",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,".aplayer-list{overflow:hidden}.aplayer-list.slide-v-enter-active,.aplayer-list.slide-v-leave-active{-webkit-transition:height .5s ease;transition:height .5s ease;will-change:height}.aplayer-list.slide-v-enter,.aplayer-list.slide-v-leave-to{height:0!important}.aplayer-list ol{list-style-type:none;margin:0;padding:0;overflow-y:auto}.aplayer-list ol::-webkit-scrollbar{width:5px}.aplayer-list ol::-webkit-scrollbar-track{background-color:#f9f9f9}.aplayer-list ol::-webkit-scrollbar-thumb{border-radius:3px;background-color:#eee}.aplayer-list ol::-webkit-scrollbar-thumb:hover{background-color:#ccc}.aplayer-list ol:hover li.aplayer-list-light:not(:hover){background-color:inherit;-webkit-transition:inherit;transition:inherit}.aplayer-list ol:not(:hover) li.aplayer-list-light{-webkit-transition:background-color .6s ease;transition:background-color .6s ease}.aplayer-list ol li{position:relative;height:32px;line-height:32px;padding:0 15px;font-size:12px;border-top:1px solid #e9e9e9;cursor:pointer;-webkit-transition:all .2s ease;transition:all .2s ease;overflow:hidden;margin:0;text-align:start;display:-webkit-box;display:-ms-flexbox;display:flex}.aplayer-list ol li:first-child{border-top:none}.aplayer-list ol li.aplayer-list-light,.aplayer-list ol li:hover{background:#efefef}.aplayer-list ol li.aplayer-list-light .aplayer-list-cur{display:inline-block}.aplayer-list ol li .aplayer-list-cur{display:none;width:3px;height:22px;position:absolute;left:0;top:5px;-webkit-transition:background-color .3s;transition:background-color .3s}.aplayer-list ol li .aplayer-list-index{color:#666;margin-right:12px}.aplayer-list ol li .aplayer-list-title{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.aplayer-list ol li .aplayer-list-author{-ms-flex-negative:0;flex-shrink:0;color:#666;float:right}",""])},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("transition",{attrs:{name:"slide-v"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"list",staticClass:"aplayer-list",style:t.listHeightStyle},[r("ol",{ref:"ol",style:t.listHeightStyle},t._l(t.musicList,function(e,i){return r("li",{key:i,class:{"aplayer-list-light":e===t.currentMusic},on:{click:function(r){t.$emit("selectsong",e)}}},[r("span",{staticClass:"aplayer-list-cur",style:{background:t.theme}}),t._v(" "),r("span",{staticClass:"aplayer-list-index"},[t._v(t._s(i+1))]),t._v(" "),r("span",{staticClass:"aplayer-list-title"},[t._v(t._s(e.title||"Untitled"))]),t._v(" "),r("span",{staticClass:"aplayer-list-author"},[t._v(t._s(e.artist||e.author||"Unknown"))])])}))])])},n=[]},function(t,e,r){"use strict";var i=r(11),n=r(61),a=r(0),o=function(t){r(51)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(52);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("c97c1d8a",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,".aplayer-controller,.aplayer-controller .aplayer-time{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative}.aplayer-controller .aplayer-time{height:17px;color:#999;font-size:11px;padding-left:7px}.aplayer-controller .aplayer-time .aplayer-volume-wrap{margin-left:4px;margin-right:4px}.aplayer-controller .aplayer-time .aplayer-icon{cursor:pointer;-webkit-transition:all .2s ease;transition:all .2s ease;margin-left:4px}.aplayer-controller .aplayer-time .aplayer-icon.inactive{opacity:.3}.aplayer-controller .aplayer-time .aplayer-icon .aplayer-fill{fill:#666}.aplayer-controller .aplayer-time .aplayer-icon:hover .aplayer-fill{fill:#000}.aplayer-controller .aplayer-time .aplayer-icon.aplayer-icon-menu{display:none}.aplayer-controller .aplayer-time .aplayer-volume-wrap+.aplayer-icon{margin-left:0}.aplayer-controller .aplayer-time.aplayer-time-narrow .aplayer-icon-menu,.aplayer-controller .aplayer-time.aplayer-time-narrow .aplayer-icon-mode{display:none}",""])},function(t,e,r){"use strict";var i=r(12),n=r(56),a=r(0),o=function(t){r(54)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(55);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("6f66d8c5",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,".aplayer-bar-wrap{margin:0 0 0 5px;padding:4px 0;cursor:pointer;-webkit-box-flex:1;-ms-flex:1;flex:1}.aplayer-bar-wrap .aplayer-bar{position:relative;height:2px;width:100%;background:#cdcdcd}.aplayer-bar-wrap .aplayer-bar .aplayer-loaded{position:absolute;left:0;top:0;bottom:0;background:#aaa;height:2px;-webkit-transition:all .5s ease;transition:all .5s ease;will-change:width}.aplayer-bar-wrap .aplayer-bar .aplayer-played{position:absolute;left:0;top:0;bottom:0;height:2px;-webkit-transition:background-color .3s;transition:background-color .3s;will-change:width}.aplayer-bar-wrap .aplayer-bar .aplayer-played .aplayer-thumb{position:absolute;top:0;right:5px;margin-top:-5px;margin-right:-10px;width:10px;height:10px;border:1px solid;-webkit-transform:scale(.8);transform:scale(.8);will-change:transform;-webkit-transition:background-color .3s,border-color .3s,-webkit-transform .3s;transition:background-color .3s,border-color .3s,-webkit-transform .3s;transition:transform .3s,background-color .3s,border-color .3s;transition:transform .3s,background-color .3s,border-color .3s,-webkit-transform .3s;border-radius:50%;background:#fff;cursor:pointer;overflow:hidden}.aplayer-bar-wrap .aplayer-bar .aplayer-played .aplayer-thumb:hover{-webkit-transform:scale(1);transform:scale(1)}.aplayer-bar-wrap .aplayer-bar .aplayer-played .aplayer-thumb .aplayer-loading-icon{display:none;width:100%;height:100%}.aplayer-bar-wrap .aplayer-bar .aplayer-played .aplayer-thumb .aplayer-loading-icon svg{position:absolute;-webkit-animation:spin 1s linear infinite;animation:spin 1s linear infinite;fill:#fff}.aplayer-loading .aplayer-bar-wrap .aplayer-bar .aplayer-thumb .aplayer-loading-icon{display:block}.aplayer-loading .aplayer-info .aplayer-controller .aplayer-bar-wrap .aplayer-bar .aplayer-played .aplayer-thumb{-webkit-transform:scale(1);transform:scale(1)}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}",""])},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"barWrap",staticClass:"aplayer-bar-wrap",on:{mousedown:t.onThumbMouseDown,touchstart:t.onThumbTouchStart}},[r("div",{staticClass:"aplayer-bar"},[r("div",{staticClass:"aplayer-loaded",style:{width:100*t.loadProgress+"%"}}),t._v(" "),r("div",{staticClass:"aplayer-played",style:{width:100*t.playProgress+"%",background:t.theme}},[r("span",{ref:"thumb",staticClass:"aplayer-thumb",style:{borderColor:t.theme,backgroundColor:t.thumbHovered?t.theme:"#fff"},on:{mouseover:function(e){t.thumbHovered=!0},mouseout:function(e){t.thumbHovered=!1}}},[r("span",{staticClass:"aplayer-loading-icon",style:{backgroundColor:t.theme}},[r("icon",{attrs:{type:"loading"}})],1)])])])])},n=[]},function(t,e,r){"use strict";var i=r(13),n=r(60),a=r(0),o=function(t){r(58)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(59);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("28c86b36",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,'.aplayer-volume-wrap{position:relative;cursor:pointer;z-index:0}.aplayer-volume-wrap:hover .aplayer-volume-bar-wrap{display:block}.aplayer-volume-wrap .aplayer-volume-bar-wrap{display:none;position:absolute;bottom:15px;left:-4px;right:-4px;height:40px;z-index:-1;-webkit-transition:all .2s ease;transition:all .2s ease}.aplayer-volume-wrap .aplayer-volume-bar-wrap:after{content:"";position:absolute;bottom:-16px;left:0;right:0;height:62px;background-color:#fff;-webkit-box-shadow:0 0 2px 0 rgba(0,0,0,.07),0 0 5px 0 rgba(0,0,0,.1);box-shadow:0 0 2px 0 rgba(0,0,0,.07),0 0 5px 0 rgba(0,0,0,.1)}.aplayer-volume-wrap .aplayer-volume-bar-wrap .aplayer-volume-bar{position:absolute;bottom:0;left:11px;width:5px;height:40px;background:#aaa;border-radius:2.5px;overflow:hidden;z-index:1}.aplayer-volume-wrap .aplayer-volume-bar-wrap .aplayer-volume-bar .aplayer-volume{position:absolute;bottom:0;left:0;right:0;-webkit-transition:height .1s ease,background-color .3s;transition:height .1s ease,background-color .3s;will-change:height}',""])},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aplayer-volume-wrap"},[r("icon-button",{class:"aplayer-icon-"+t.volumeIcon,attrs:{icon:t.volumeIcon},nativeOn:{click:function(e){t.$emit("togglemute")}}}),t._v(" "),r("div",{staticClass:"aplayer-volume-bar-wrap",on:{mousedown:t.onBarMouseDown}},[r("div",{ref:"bar",staticClass:"aplayer-volume-bar"},[r("div",{staticClass:"aplayer-volume",style:{height:t.muted?0:Math.trunc(100*t.volume)+"%",background:t.theme}})])])],1)},n=[]},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aplayer-controller"},[r("v-progress",{attrs:{loadProgress:t.loadProgress,playProgress:t.playProgress,theme:t.theme},on:{dragbegin:function(e){return t.$emit("dragbegin",e)},dragend:function(e){return t.$emit("dragend",e)},dragging:function(e){return t.$emit("dragging",e)}}}),t._v(" "),r("div",{staticClass:"aplayer-time"},[r("div",{staticClass:"aplayer-time-inner"},[t._v("\n      - "),r("span",{staticClass:"aplayer-ptime"},[t._v(t._s(t.secondToTime(t.stat.playedTime)))]),t._v(" / "),r("span",{staticClass:"aplayer-dtime"},[t._v(t._s(t.secondToTime(t.stat.duration)))])]),t._v(" "),t.$parent.isMobile?t._e():r("volume",{attrs:{volume:t.volume,theme:t.theme,muted:t.muted},on:{togglemute:function(e){t.$emit("togglemute")},setvolume:function(e){return t.$emit("setvolume",e)}}}),t._v(" "),r("icon-button",{staticClass:"aplayer-icon-mode",class:{inactive:!t.shuffle},attrs:{icon:"shuffle"},nativeOn:{click:function(e){t.$emit("toggleshuffle")}}}),t._v(" "),r("icon-button",{staticClass:"aplayer-icon-mode",class:{inactive:"no-repeat"===t.repeat},attrs:{icon:"repeat-one"===t.repeat?"repeat-one":"repeat-all"},nativeOn:{click:function(e){t.$emit("nextmode")}}}),t._v(" "),r("icon-button",{staticClass:"aplayer-icon-menu",class:{inactive:!t.$parent.showList},attrs:{icon:"menu"},nativeOn:{click:function(e){t.$emit("togglelist")}}})],1)],1)},n=[]},function(t,e,r){"use strict";var i=r(14),n=r(65),a=r(0),o=function(t){r(63)},s=Object(a.a)(i.a,n.a,n.b,!1,o,null,null);e.a=s.exports},function(t,e,r){var i=r(64);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals),(0,r(2).default)("229083b6",i,!0,{})},function(t,e,r){(t.exports=r(1)(!1)).push([t.i,'.aplayer-lrc{position:relative;height:30px;text-align:center;overflow:hidden;margin-bottom:7px}.aplayer-lrc:before{top:0;height:10%;background:-webkit-gradient(linear,left top,left bottom,from(#fff),to(hsla(0,0%,100%,0)));background:linear-gradient(180deg,#fff 0,hsla(0,0%,100%,0));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#ffffff",endColorstr="#00ffffff",GradientType=0)}.aplayer-lrc:after,.aplayer-lrc:before{position:absolute;z-index:1;display:block;overflow:hidden;width:100%;content:" "}.aplayer-lrc:after{bottom:0;height:33%;background:-webkit-gradient(linear,left top,left bottom,from(hsla(0,0%,100%,0)),to(hsla(0,0%,100%,.8)));background:linear-gradient(180deg,hsla(0,0%,100%,0) 0,hsla(0,0%,100%,.8));filter:progid:DXImageTransform.Microsoft.gradient(startColorstr="#00ffffff",endColorstr="#ccffffff",GradientType=0)}.aplayer-lrc p{font-size:12px;color:#666;line-height:16px;height:16px;padding:0;margin:0;-webkit-transition:all .5s ease-out;transition:all .5s ease-out;opacity:.4;overflow:hidden}.aplayer-lrc p.aplayer-lrc-current{opacity:1;overflow:visible;height:auto}.aplayer-lrc .aplayer-lrc-contents{width:100%;-webkit-transition:all .5s ease-out;transition:all .5s ease-out;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text;cursor:default}',""])},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aplayer-lrc"},[r("div",{staticClass:"aplayer-lrc-contents",style:t.transformStyle},t._l(t.lrcLines,function(e,i){return r("p",{key:i,class:{"aplayer-lrc-current":i===t.currentLineIndex}},[t._v("\n      "+t._s(e[1])+"\n    ")])}))])},n=[]},function(t,r){if(void 0===e){var i=new Error('Cannot find module "undefined"');throw i.code="MODULE_NOT_FOUND",i}t.exports=e},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return n});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"aplayer",class:{"aplayer-narrow":t.isMiniMode,"aplayer-withlist":!t.isMiniMode&&t.musicList.length>0,"aplayer-withlrc":!t.isMiniMode&&(!!t.$slots.display||t.shouldShowLrc),"aplayer-float":t.isFloatMode,"aplayer-loading":t.isPlaying&&t.isLoading},style:t.floatStyleObj},[r("div",{staticClass:"aplayer-body"},[r("thumbnail",{attrs:{pic:t.currentMusic.pic,playing:t.isPlaying,"enable-drag":t.isFloatMode,theme:t.currentTheme},on:{toggleplay:t.toggle,dragbegin:t.onDragBegin,dragging:t.onDragAround}}),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMiniMode,expression:"!isMiniMode"}],staticClass:"aplayer-info"},[r("div",{staticClass:"aplayer-music"},[r("span",{staticClass:"aplayer-title"},[t._v(t._s(t.currentMusic.title||"Untitled"))]),t._v(" "),r("span",{staticClass:"aplayer-author"},[t._v(t._s(t.currentMusic.artist||t.currentMusic.author||"Unknown"))])]),t._v(" "),t._t("display",[t.shouldShowLrc?r("lyrics",{attrs:{"current-music":t.currentMusic,"play-stat":t.playStat}}):t._e()],{currentMusic:t.currentMusic,playStat:t.playStat}),t._v(" "),r("controls",{attrs:{shuffle:t.shouldShuffle,repeat:t.repeatMode,stat:t.playStat,volume:t.audioVolume,muted:t.isAudioMuted,theme:t.currentTheme},on:{toggleshuffle:function(e){t.shouldShuffle=!t.shouldShuffle},togglelist:function(e){t.showList=!t.showList},togglemute:t.toggleMute,setvolume:t.setAudioVolume,dragbegin:t.onProgressDragBegin,dragend:t.onProgressDragEnd,dragging:t.onProgressDragging,nextmode:t.setNextMode}})],2)],1),t._v(" "),r("audio",{ref:"audio"}),t._v(" "),r("music-list",{attrs:{show:t.showList&&!t.isMiniMode,"current-music":t.currentMusic,"music-list":t.musicList,"play-index":t.playIndex,listmaxheight:t.listmaxheight||t.listMaxHeight,theme:t.currentTheme},on:{selectsong:t.onSelectSong}})],1)},n=[]}]).default},t.exports=i(r("lRwf"),function(){try{return r("YT+p")}catch(t){}}())},Rl2i:function(t,e){t.exports=function(t){if(!t)return!1;var e=r.call(t);return"[object Function]"===e||"function"==typeof t&&"[object RegExp]"!==e||"undefined"!=typeof window&&(t===window.setTimeout||t===window.alert||t===window.confirm||t===window.prompt)};var r=Object.prototype.toString},VSTS:function(t,e){var r="auto",i={"":!0,lr:!0,rl:!0},n={start:!0,middle:!0,end:!0,left:!0,right:!0};function a(t){return"string"==typeof t&&(!!n[t.toLowerCase()]&&t.toLowerCase())}function o(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t}function s(t,e,n){var s=this,l=/MSIE\s8\.0/.test(navigator.userAgent),u={};l?s=document.createElement("custom"):u.enumerable=!0,s.hasBeenReset=!1;var c="",h=!1,d=t,f=e,p=n,g=null,v="",m=!0,y="auto",b="start",_=50,T="middle",E=50,S="middle";if(Object.defineProperty(s,"id",o({},u,{get:function(){return c},set:function(t){c=""+t}})),Object.defineProperty(s,"pauseOnExit",o({},u,{get:function(){return h},set:function(t){h=!!t}})),Object.defineProperty(s,"startTime",o({},u,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",o({},u,{get:function(){return f},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");f=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",o({},u,{get:function(){return p},set:function(t){p=""+t,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",o({},u,{get:function(){return g},set:function(t){g=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",o({},u,{get:function(){return v},set:function(t){var e=function(t){return"string"==typeof t&&!!i[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===e)throw new SyntaxError("An invalid or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",o({},u,{get:function(){return m},set:function(t){m=!!t,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",o({},u,{get:function(){return y},set:function(t){if("number"!=typeof t&&t!==r)throw new SyntaxError("An invalid number or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",o({},u,{get:function(){return b},set:function(t){var e=a(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",o({},u,{get:function(){return _},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");_=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",o({},u,{get:function(){return T},set:function(t){var e=a(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");T=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",o({},u,{get:function(){return E},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");E=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",o({},u,{get:function(){return S},set:function(t){var e=a(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");S=e,this.hasBeenReset=!0}})),s.displayState=void 0,l)return s}s.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},t.exports=s},"VU/8":function(t,e){t.exports=function(t,e,r,i,n,a){var o,s=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,s=t.default);var u,c="function"==typeof s?s.options:s;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),r&&(c.functional=!0),n&&(c._scopeId=n),a?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):i&&(u=i),u){var h=c.functional,d=h?c.render:c.beforeCreate;h?(c._injectStyles=u,c.render=function(t,e){return u.call(e),d(t,e)}):c.beforeCreate=d?[].concat(d,u):[u]}return{esModule:o,exports:s,options:c}}},"YT+p":function(t,e,r){var i;"undefined"!=typeof window&&(i=function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":
/*!*********************************************!*\
  !*** ./node_modules/eventemitter3/index.js ***!
  \*********************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,r){"use strict";var i=Object.prototype.hasOwnProperty,n="~";function a(){}function o(t,e,r,i,a){if("function"!=typeof r)throw new TypeError("The listener must be a function");var o=new function(t,e,r){this.fn=t,this.context=e,this.once=r||!1}(r,i||t,a),s=n?n+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new a:delete t._events[e]}function l(){this._events=new a,this._eventsCount=0}Object.create&&(a.prototype=Object.create(null),(new a).__proto__||(n=!1)),l.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)i.call(t,e)&&r.push(n?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},l.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,a=r.length,o=new Array(a);i<a;i++)o[i]=r[i].fn;return o},l.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},l.prototype.emit=function(t,e,r,i,a,o){var s=n?n+t:t;if(!this._events[s])return!1;var l,u,c=this._events[s],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,r),!0;case 4:return c.fn.call(c.context,e,r,i),!0;case 5:return c.fn.call(c.context,e,r,i,a),!0;case 6:return c.fn.call(c.context,e,r,i,a,o),!0}for(u=1,l=new Array(h-1);u<h;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),h){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,r);break;case 4:c[u].fn.call(c[u].context,e,r,i);break;default:if(!l)for(d=1,l=new Array(h-1);d<h;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},l.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},l.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},l.prototype.removeListener=function(t,e,r,i){var a=n?n+t:t;if(!this._events[a])return this;if(!e)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==e||i&&!o.once||r&&o.context!==r||s(this,a);else{for(var l=0,u=[],c=o.length;l<c;l++)(o[l].fn!==e||i&&!o[l].once||r&&o[l].context!==r)&&u.push(o[l]);u.length?this._events[a]=1===u.length?u[0]:u:s(this,a)}return this},l.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l},"./node_modules/url-toolkit/src/url-toolkit.js":
/*!*****************************************************!*\
  !*** ./node_modules/url-toolkit/src/url-toolkit.js ***!
  \*****************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,r){var i,n,a,o,s;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,n=/^([^\/?#]*)(.*)$/,a=/(?:\/|^)\.(?=\/)/g,o=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,s={buildAbsoluteURL:function(t,e,r){if(r=r||{},t=t.trim(),!(e=e.trim())){if(!r.alwaysNormalize)return t;var i=s.parseURL(t);if(!i)throw new Error("Error trying to parse base URL.");return i.path=s.normalizePath(i.path),s.buildURLFromParts(i)}var a=s.parseURL(e);if(!a)throw new Error("Error trying to parse relative URL.");if(a.scheme)return r.alwaysNormalize?(a.path=s.normalizePath(a.path),s.buildURLFromParts(a)):e;var o=s.parseURL(t);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var l=n.exec(o.path);o.netLoc=l[1],o.path=l[2]}o.netLoc&&!o.path&&(o.path="/");var u={scheme:o.scheme,netLoc:a.netLoc,path:null,params:a.params,query:a.query,fragment:a.fragment};if(!a.netLoc&&(u.netLoc=o.netLoc,"/"!==a.path[0]))if(a.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+a.path;u.path=s.normalizePath(h)}else u.path=o.path,a.params||(u.params=o.params,a.query||(u.query=o.query));return null===u.path&&(u.path=r.alwaysNormalize?s.normalizePath(a.path):a.path),s.buildURLFromParts(u)},parseURL:function(t){var e=i.exec(t);return e?{scheme:e[1]||"",netLoc:e[2]||"",path:e[3]||"",params:e[4]||"",query:e[5]||"",fragment:e[6]||""}:null},normalizePath:function(t){for(t=t.split("").reverse().join("").replace(a,"");t.length!==(t=t.replace(o,"")).length;);return t.split("").reverse().join("")},buildURLFromParts:function(t){return t.scheme+t.netLoc+t.path+t.params+t.query+t.fragment}},t.exports=s},"./node_modules/webworkify-webpack/index.js":
/*!**************************************************!*\
  !*** ./node_modules/webworkify-webpack/index.js ***!
  \**************************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(t,e,r){function i(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r.oe=function(t){throw console.error(t),t};var i=r(r.s=ENTRY_MODULE);return i.default||i}var n="[\\.|\\-|\\+|\\w|/|@]+",a="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+n+").*?\\)";function o(t){return(t+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function s(t,e,i){var s={};s[i]=[];var l=e.toString(),u=l.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!u)return s;for(var c,h=u[1],d=new RegExp("(\\\\n|\\W)"+o(h)+a,"g");c=d.exec(l);)"dll-reference"!==c[3]&&s[i].push(c[3]);for(d=new RegExp("\\("+o(h)+'\\("(dll-reference\\s('+n+'))"\\)\\)'+a,"g");c=d.exec(l);)t[c[2]]||(s[i].push(c[1]),t[c[2]]=r(c[1]).m),s[c[2]]=s[c[2]]||[],s[c[2]].push(c[4]);for(var f,p=Object.keys(s),g=0;g<p.length;g++)for(var v=0;v<s[p[g]].length;v++)f=s[p[g]][v],isNaN(1*f)||(s[p[g]][v]=1*s[p[g]][v]);return s}function l(t){return Object.keys(t).reduce(function(e,r){return e||t[r].length>0},!1)}t.exports=function(t,e){e=e||{};var n={main:r.m},a=e.all?{main:Object.keys(n.main)}:function(t,e){for(var r={main:[e]},i={main:[]},n={main:{}};l(r);)for(var a=Object.keys(r),o=0;o<a.length;o++){var u=a[o],c=r[u].pop();if(n[u]=n[u]||{},!n[u][c]&&t[u][c]){n[u][c]=!0,i[u]=i[u]||[],i[u].push(c);for(var h=s(t,t[u][c],u),d=Object.keys(h),f=0;f<d.length;f++)r[d[f]]=r[d[f]]||[],r[d[f]]=r[d[f]].concat(h[d[f]])}}return i}(n,t),o="";Object.keys(a).filter(function(t){return"main"!==t}).forEach(function(t){for(var e=0;a[t][e];)e++;a[t].push(e),n[t][e]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",o=o+"var "+t+" = ("+i.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+a[t].map(function(e){return JSON.stringify(e)+": "+n[t][e].toString()}).join(",")+"});\n"}),o=o+"new (("+i.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+a.main.map(function(t){return JSON.stringify(t)+": "+n.main[t].toString()}).join(",")+"}))(self);";var u=new window.Blob([o],{type:"text/javascript"});if(e.bare)return u;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(u),h=new window.Worker(c);return h.objectURL=c,h}},"./src/crypt/decrypter.js":
/*!********************************************!*\
  !*** ./src/crypt/decrypter.js + 3 modules ***!
  \********************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(t,e,r){"use strict";r.r(e);var i=function(){function t(t,e){this.subtle=t,this.aesIV=e}return t.prototype.decrypt=function(t,e){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},e,t)},t}(),n=function(){function t(t,e){this.subtle=t,this.key=e}return t.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},t}();var a=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.initTable()}var e=t.prototype;return e.uint8ArrayToUint32Array_=function(t){for(var e=new DataView(t),r=new Uint32Array(4),i=0;i<4;i++)r[i]=e.getUint32(4*i);return r},e.initTable=function(){var t=this.sBox,e=this.invSBox,r=this.subMix,i=r[0],n=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],h=s[3],d=new Uint32Array(256),f=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,t[f]=v,e[v]=f;var m=d[f],y=d[m],b=d[y],_=257*d[v]^16843008*v;i[f]=_<<24|_>>>8,n[f]=_<<16|_>>>16,a[f]=_<<8|_>>>24,o[f]=_,_=16843009*b^65537*y^257*m^16843008*f,l[v]=_<<24|_>>>8,u[v]=_<<16|_>>>16,c[v]=_<<8|_>>>24,h[v]=_,f?(f=m^d[d[d[b^m]]],p^=d[d[p]]):f=p=1}},e.expandKey=function(t){for(var e=this.uint8ArrayToUint32Array_(t),r=!0,i=0;i<e.length&&r;)r=e[i]===this.key[i],i++;if(!r){this.key=e;var n=this.keySize=e.length;if(4!==n&&6!==n&&8!==n)throw new Error("Invalid aes key size="+n);var a,o,s,l,u=this.ksRows=4*(n+6+1),c=this.keySchedule=new Uint32Array(u),h=this.invKeySchedule=new Uint32Array(u),d=this.sBox,f=this.rcon,p=this.invSubMix,g=p[0],v=p[1],m=p[2],y=p[3];for(a=0;a<u;a++)a<n?s=c[a]=e[a]:(l=s,a%n==0?(l=d[(l=l<<8|l>>>24)>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l],l^=f[a/n|0]<<24):n>6&&a%n==4&&(l=d[l>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l]),c[a]=s=(c[a-n]^l)>>>0);for(o=0;o<u;o++)a=u-o,l=3&o?c[a]:c[a-4],h[o]=o<4||a<=4?l:g[d[l>>>24]]^v[d[l>>>16&255]]^m[d[l>>>8&255]]^y[d[255&l]],h[o]=h[o]>>>0}},e.networkToHostOrderSwap=function(t){return t<<24|(65280&t)<<8|(16711680&t)>>8|t>>>24},e.decrypt=function(t,e,r,i){for(var n,a,o,s,l,u,c,h,d,f,p,g,v,m,y,b,_,T=this.keySize+6,E=this.invKeySchedule,S=this.invSBox,w=this.invSubMix,k=w[0],A=w[1],C=w[2],x=w[3],R=this.uint8ArrayToUint32Array_(r),L=R[0],D=R[1],O=R[2],I=R[3],P=new Int32Array(t),M=new Int32Array(P.length),N=this.networkToHostOrderSwap;e<P.length;){for(d=N(P[e]),f=N(P[e+1]),p=N(P[e+2]),g=N(P[e+3]),l=d^E[0],u=g^E[1],c=p^E[2],h=f^E[3],v=4,m=1;m<T;m++)n=k[l>>>24]^A[u>>16&255]^C[c>>8&255]^x[255&h]^E[v],a=k[u>>>24]^A[c>>16&255]^C[h>>8&255]^x[255&l]^E[v+1],o=k[c>>>24]^A[h>>16&255]^C[l>>8&255]^x[255&u]^E[v+2],s=k[h>>>24]^A[l>>16&255]^C[u>>8&255]^x[255&c]^E[v+3],l=n,u=a,c=o,h=s,v+=4;n=S[l>>>24]<<24^S[u>>16&255]<<16^S[c>>8&255]<<8^S[255&h]^E[v],a=S[u>>>24]<<24^S[c>>16&255]<<16^S[h>>8&255]<<8^S[255&l]^E[v+1],o=S[c>>>24]<<24^S[h>>16&255]<<16^S[l>>8&255]<<8^S[255&u]^E[v+2],s=S[h>>>24]<<24^S[l>>16&255]<<16^S[u>>8&255]<<8^S[255&c]^E[v+3],v+=3,M[e]=N(n^L),M[e+1]=N(s^D),M[e+2]=N(o^O),M[e+3]=N(a^I),L=d,D=f,O=p,I=g,e+=4}return i?(y=M.buffer,b=y.byteLength,(_=b&&new DataView(y).getUint8(b-1))?y.slice(0,b-_):y):M.buffer},e.destroy=function(){this.key=void 0,this.keySize=void 0,this.ksRows=void 0,this.sBox=void 0,this.invSBox=void 0,this.subMix=void 0,this.invSubMix=void 0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.rcon=void 0},t}(),o=r("./src/errors.ts"),s=r("./src/utils/logger.js"),l=r("./src/events.js"),u=r("./src/utils/get-self-scope.js"),c=Object(u.getSelfScope)(),h=function(){function t(t,e,r){var i=(void 0===r?{}:r).removePKCS7Padding,n=void 0===i||i;if(this.logEnabled=!0,this.observer=t,this.config=e,this.removePKCS7Padding=n,n)try{var a=c.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(t){}this.disableWebCrypto=!this.subtle}var e=t.prototype;return e.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},e.decrypt=function(t,e,r,o){var l=this;if(this.disableWebCrypto&&this.config.enableSoftwareAES){this.logEnabled&&(s.logger.log("JS AES decrypt"),this.logEnabled=!1);var u=this.decryptor;u||(this.decryptor=u=new a),u.expandKey(e),o(u.decrypt(t,0,r,this.removePKCS7Padding))}else{this.logEnabled&&(s.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1);var c=this.subtle;this.key!==e&&(this.key=e,this.fastAesKey=new n(c,e)),this.fastAesKey.expandKey().then(function(n){new i(c,r).decrypt(t,n).catch(function(i){l.onWebCryptoError(i,t,e,r,o)}).then(function(t){o(t)})}).catch(function(i){l.onWebCryptoError(i,t,e,r,o)})}},e.onWebCryptoError=function(t,e,r,i,n){this.config.enableSoftwareAES?(s.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(e,r,i,n)):(s.logger.error("decrypting error : "+t.message),this.observer.trigger(l.default.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:t.message}))},e.destroy=function(){var t=this.decryptor;t&&(t.destroy(),this.decryptor=void 0)},t}();e.default=h},"./src/demux/demuxer-inline.js":
/*!**************************************************!*\
  !*** ./src/demux/demuxer-inline.js + 12 modules ***!
  \**************************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/hls.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/hls.ts */function(t,e,r){"use strict";r.r(e);var i=r("./src/events.js"),n=r("./src/errors.ts"),a=r("./src/crypt/decrypter.js"),o=r("./src/polyfills/number.js"),s=r("./src/utils/logger.js"),l=r("./src/utils/get-self-scope.js");function u(t,e){return 255===t[e]&&240==(246&t[e+1])}function c(t,e){return 1&t[e+1]?7:9}function h(t,e){return(3&t[e+3])<<11|t[e+4]<<3|(224&t[e+5])>>>5}function d(t,e){return!!(e+1<t.length&&u(t,e))}function f(t,e){if(d(t,e)){var r=c(t,e);if(e+r>=t.length)return!1;var i=h(t,e);if(i<=r)return!1;var n=e+i;if(n===t.length||n+1<t.length&&u(t,n))return!0}return!1}function p(t,e,r,a,o){if(!t.samplerate){var l=function(t,e,r,a){var o,l,u,c,h,d=navigator.userAgent.toLowerCase(),f=a,p=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];if(o=1+((192&e[r+2])>>>6),!((l=(60&e[r+2])>>>2)>p.length-1))return c=(1&e[r+2])<<2,c|=(192&e[r+3])>>>6,s.logger.log("manifest codec:"+a+",ADTS data:type:"+o+",sampleingIndex:"+l+"["+p[l]+"Hz],channelConfig:"+c),/firefox/i.test(d)?l>=6?(o=5,h=new Array(4),u=l-3):(o=2,h=new Array(2),u=l):-1!==d.indexOf("android")?(o=2,h=new Array(2),u=l):(o=5,h=new Array(4),a&&(-1!==a.indexOf("mp4a.40.29")||-1!==a.indexOf("mp4a.40.5"))||!a&&l>=6?u=l-3:((a&&-1!==a.indexOf("mp4a.40.2")&&(l>=6&&1===c||/vivaldi/i.test(d))||!a&&1===c)&&(o=2,h=new Array(2)),u=l)),h[0]=o<<3,h[0]|=(14&l)>>1,h[1]|=(1&l)<<7,h[1]|=c<<3,5===o&&(h[1]|=(14&u)>>1,h[2]=(1&u)<<7,h[2]|=8,h[3]=0),{config:h,samplerate:p[l],channelCount:c,codec:"mp4a.40."+o,manifestCodec:f};t.trigger(i.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+l})}(e,r,a,o);t.config=l.config,t.samplerate=l.samplerate,t.channelCount=l.channelCount,t.codec=l.codec,t.manifestCodec=l.manifestCodec,s.logger.log("parsed codec:"+t.codec+",rate:"+l.samplerate+",nb channel:"+l.channelCount)}}function g(t){return 9216e4/t}function v(t,e,r,i,n){var a=function(t,e,r,i,n){var a,o,s=t.length;if(a=c(t,e),o=h(t,e),(o-=a)>0&&e+a+o<=s)return{headerLength:a,frameLength:o,stamp:r+i*n}}(e,r,i,n,g(t.samplerate));if(a){var o=a.stamp,s=a.headerLength,l=a.frameLength,u={unit:e.subarray(r+s,r+s+l),pts:o,dts:o};return t.samples.push(u),{sample:u,length:l+s}}}var m=r("./src/demux/id3.js"),y=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,i){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){if(!t)return!1;for(var e=(m.default.getID3Data(t,0)||[]).length,r=t.length;e<r;e++)if(f(t,e))return s.logger.log("ADTS sync word found !"),!0;return!1},e.append=function(t,e,r,i){for(var n=this._audioTrack,a=m.default.getID3Data(t,0)||[],l=m.default.getTimeStamp(a),u=Object(o.isFiniteNumber)(l)?90*l:9e4*e,c=0,h=u,f=t.length,g=a.length,y=[{pts:h,dts:h,data:a}];g<f-1;)if(d(t,g)&&g+5<f){p(n,this.observer,t,g,n.manifestCodec);var b=v(n,t,g,u,c);if(!b){s.logger.log("Unable to parse AAC frame");break}g+=b.length,h=b.sample.pts,c++}else m.default.isHeader(t,g)?(a=m.default.getID3Data(t,g),y.push({pts:h,dts:h,data:a}),g+=a.length):g++;this.remuxer.remux(n,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},e,r,i)},e.destroy=function(){},t}(),b=r("./src/demux/mp4demuxer.js"),_={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(t,e,r,i,n){if(!(r+24>e.length)){var a=this.parseHeader(e,r);if(a&&r+a.frameLength<=e.length){var o=i+n*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:e.subarray(r,r+a.frameLength),pts:o,dts:o};return t.config=[],t.channelCount=a.channelCount,t.samplerate=a.sampleRate,t.samples.push(s),{sample:s,length:a.frameLength}}}},parseHeader:function(t,e){var r=t[e+1]>>3&3,i=t[e+1]>>1&3,n=t[e+2]>>4&15,a=t[e+2]>>2&3,o=t[e+2]>>1&1;if(1!==r&&0!==n&&15!==n&&3!==a){var s=3===r?3-i:3===i?3:4,l=1e3*_.BitratesMap[14*s+n-1],u=3===r?0:2===r?1:2,c=_.SamplingRateMap[3*u+a],h=t[e+3]>>6==3?1:2,d=_.SamplesCoefficients[r][i],f=_.BytesInSlot[i],p=8*d*f;return{sampleRate:c,channelCount:h,frameLength:parseInt(d*l/c+o,10)*f,samplesPerFrame:p}}},isHeaderPattern:function(t,e){return 255===t[e]&&224==(224&t[e+1])&&0!=(6&t[e+1])},isHeader:function(t,e){return!!(e+1<t.length&&this.isHeaderPattern(t,e))},probe:function(t,e){if(e+1<t.length&&this.isHeaderPattern(t,e)){var r=this.parseHeader(t,e),i=4;r&&r.frameLength&&(i=r.frameLength);var n=e+i;if(n===t.length||n+1<t.length&&this.isHeaderPattern(t,n))return!0}return!1}},T=_,E=function(){function t(t){this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}var e=t.prototype;return e.loadWord=function(){var t=this.data,e=this.bytesAvailable,r=t.byteLength-e,i=new Uint8Array(4),n=Math.min(4,e);if(0===n)throw new Error("no bytes available");i.set(t.subarray(r,r+n)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n},e.skipBits=function(t){var e;this.bitsAvailable>t?(this.word<<=t,this.bitsAvailable-=t):(t-=this.bitsAvailable,t-=(e=t>>3)>>3,this.bytesAvailable-=e,this.loadWord(),this.word<<=t,this.bitsAvailable-=t)},e.readBits=function(t){var e=Math.min(this.bitsAvailable,t),r=this.word>>>32-e;return t>32&&s.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=e,this.bitsAvailable>0?this.word<<=e:this.bytesAvailable>0&&this.loadWord(),(e=t-e)>0&&this.bitsAvailable?r<<e|this.readBits(e):r},e.skipLZ=function(){var t;for(t=0;t<this.bitsAvailable;++t)if(0!=(this.word&2147483648>>>t))return this.word<<=t,this.bitsAvailable-=t,t;return this.loadWord(),t+this.skipLZ()},e.skipUEG=function(){this.skipBits(1+this.skipLZ())},e.skipEG=function(){this.skipBits(1+this.skipLZ())},e.readUEG=function(){var t=this.skipLZ();return this.readBits(t+1)-1},e.readEG=function(){var t=this.readUEG();return 1&t?1+t>>>1:-1*(t>>>1)},e.readBoolean=function(){return 1===this.readBits(1)},e.readUByte=function(){return this.readBits(8)},e.readUShort=function(){return this.readBits(16)},e.readUInt=function(){return this.readBits(32)},e.skipScalingList=function(t){var e,r=8,i=8;for(e=0;e<t;e++)0!==i&&(i=(r+this.readEG()+256)%256),r=0===i?r:i},e.readSPS=function(){var t,e,r,i,n,a,o,s=0,l=0,u=0,c=0,h=this.readUByte.bind(this),d=this.readBits.bind(this),f=this.readUEG.bind(this),p=this.readBoolean.bind(this),g=this.skipBits.bind(this),v=this.skipEG.bind(this),m=this.skipUEG.bind(this),y=this.skipScalingList.bind(this);if(h(),t=h(),d(5),g(3),h(),m(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t){var b=f();if(3===b&&g(1),m(),m(),g(1),p())for(a=3!==b?8:12,o=0;o<a;o++)p()&&y(o<6?16:64)}m();var _=f();if(0===_)f();else if(1===_)for(g(1),v(),v(),e=f(),o=0;o<e;o++)v();m(),g(1),r=f(),i=f(),0===(n=d(1))&&g(1),g(1),p()&&(s=f(),l=f(),u=f(),c=f());var T=[1,1];if(p()&&p())switch(h()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[h()<<8|h(),h()<<8|h()]}return{width:Math.ceil(16*(r+1)-2*s-2*l),height:(2-n)*(i+1)*16-(n?2:4)*(u+c),pixelRatio:T}},e.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),S=function(){function t(t,e,r,i){this.decryptdata=r,this.discardEPB=i,this.decrypter=new a.default(t,e,{removePKCS7Padding:!1})}var e=t.prototype;return e.decryptBuffer=function(t,e){this.decrypter.decrypt(t,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,e)},e.decryptAacSample=function(t,e,r,i){var n=t[e].unit,a=n.subarray(16,n.length-n.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length),s=this;this.decryptBuffer(o,function(a){a=new Uint8Array(a),n.set(a,16),i||s.decryptAacSamples(t,e+1,r)})},e.decryptAacSamples=function(t,e,r){for(;;e++){if(e>=t.length)return void r();if(!(t[e].unit.length<32)){var i=this.decrypter.isSync();if(this.decryptAacSample(t,e,r,i),!i)return}}},e.getAvcEncryptedData=function(t){for(var e=16*Math.floor((t.length-48)/160)+16,r=new Int8Array(e),i=0,n=32;n<=t.length-16;n+=160,i+=16)r.set(t.subarray(n,n+16),i);return r},e.getAvcDecryptedUnit=function(t,e){e=new Uint8Array(e);for(var r=0,i=32;i<=t.length-16;i+=160,r+=16)t.set(e.subarray(r,r+16),i);return t},e.decryptAvcSample=function(t,e,r,i,n,a){var o=this.discardEPB(n.data),s=this.getAvcEncryptedData(o),l=this;this.decryptBuffer(s.buffer,function(s){n.data=l.getAvcDecryptedUnit(o,s),a||l.decryptAvcSamples(t,e,r+1,i)})},e.decryptAvcSamples=function(t,e,r,i){for(;;e++,r=0){if(e>=t.length)return void i();for(var n=t[e].units;!(r>=n.length);r++){var a=n[r];if(!(a.length<=48||1!==a.type&&5!==a.type)){var o=this.decrypter.isSync();if(this.decryptAvcSample(t,e,r,i,a,o),!o)return}}}},t}(),w={video:1,audio:2,id3:3,text:4},k=function(){function t(t,e,r,i){this.observer=t,this.config=r,this.typeSupported=i,this.remuxer=e,this.sampleAes=null,this.pmtUnknownTypes={}}var e=t.prototype;return e.setDecryptData=function(t){null!=t&&null!=t.key&&"SAMPLE-AES"===t.method?this.sampleAes=new S(this.observer,this.config,t,this.discardEPB):this.sampleAes=null},t.probe=function(e){var r=t._syncOffset(e);return!(r<0)&&(r&&s.logger.warn("MPEG2-TS detected but first sync word found @ offset "+r+", junk ahead ?"),!0)},t._syncOffset=function(t){for(var e=Math.min(1e3,t.length-564),r=0;r<e;){if(71===t[r]&&71===t[r+188]&&71===t[r+376])return r;r++}return-1},t.createTrack=function(t,e){return{container:"video"===t||"audio"===t?"video/mp2t":void 0,type:t,id:w[t],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===t?0:void 0,isAAC:"audio"===t||void 0,duration:"audio"===t?e:void 0}},e.resetInitSegment=function(e,r,i,n){this.pmtParsed=!1,this._pmtId=-1,this.pmtUnknownTypes={},this._avcTrack=t.createTrack("video",n),this._audioTrack=t.createTrack("audio",n),this._id3Track=t.createTrack("id3",n),this._txtTrack=t.createTrack("text",n),this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=r,this.videoCodec=i,this._duration=n},e.resetTimeStamp=function(){},e.append=function(e,r,a,o){var l,u,c,h,d,f=e.length,p=!1;this.pmtUnknownTypes={},this.contiguous=a;var g=this.pmtParsed,v=this._avcTrack,m=this._audioTrack,y=this._id3Track,b=v.pid,_=m.pid,T=y.pid,E=this._pmtId,S=v.pesData,w=m.pesData,k=y.pesData,A=this._parsePAT,C=this._parsePMT.bind(this),x=this._parsePES,R=this._parseAVCPES.bind(this),L=this._parseAACPES.bind(this),D=this._parseMPEGPES.bind(this),O=this._parseID3PES.bind(this),I=t._syncOffset(e);for(f-=(f+I)%188,l=I;l<f;l+=188)if(71===e[l]){if(u=!!(64&e[l+1]),c=((31&e[l+1])<<8)+e[l+2],(48&e[l+3])>>4>1){if((h=l+5+e[l+4])===l+188)continue}else h=l+4;switch(c){case b:u&&(S&&(d=x(S))&&R(d,!1),S={data:[],size:0}),S&&(S.data.push(e.subarray(h,l+188)),S.size+=l+188-h);break;case _:u&&(w&&(d=x(w))&&(m.isAAC?L(d):D(d)),w={data:[],size:0}),w&&(w.data.push(e.subarray(h,l+188)),w.size+=l+188-h);break;case T:u&&(k&&(d=x(k))&&O(d),k={data:[],size:0}),k&&(k.data.push(e.subarray(h,l+188)),k.size+=l+188-h);break;case 0:u&&(h+=e[h]+1),E=this._pmtId=A(e,h);break;case E:u&&(h+=e[h]+1);var P=C(e,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);(b=P.avc)>0&&(v.pid=b),(_=P.audio)>0&&(m.pid=_,m.isAAC=P.isAAC),(T=P.id3)>0&&(y.pid=T),p&&!g&&(s.logger.log("reparse from beginning"),p=!1,l=I-188),g=this.pmtParsed=!0;break;case 17:case 8191:break;default:p=!0}}else this.observer.trigger(i.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});S&&(d=x(S))?(R(d,!0),v.pesData=null):v.pesData=S,w&&(d=x(w))?(m.isAAC?L(d):D(d),m.pesData=null):(w&&w.size&&s.logger.log("last AAC PES packet truncated,might overlap between fragments"),m.pesData=w),k&&(d=x(k))?(O(d),y.pesData=null):y.pesData=k,null==this.sampleAes?this.remuxer.remux(m,v,y,this._txtTrack,r,a,o):this.decryptAndRemux(m,v,y,this._txtTrack,r,a,o)},e.decryptAndRemux=function(t,e,r,i,n,a,o){if(t.samples&&t.isAAC){var s=this;this.sampleAes.decryptAacSamples(t.samples,0,function(){s.decryptAndRemuxAvc(t,e,r,i,n,a,o)})}else this.decryptAndRemuxAvc(t,e,r,i,n,a,o)},e.decryptAndRemuxAvc=function(t,e,r,i,n,a,o){if(e.samples){var s=this;this.sampleAes.decryptAvcSamples(e.samples,0,0,function(){s.remuxer.remux(t,e,r,i,n,a,o)})}else this.remuxer.remux(t,e,r,i,n,a,o)},e.destroy=function(){this._initPTS=this._initDTS=void 0,this._duration=0},e._parsePAT=function(t,e){return(31&t[e+10])<<8|t[e+11]},e._trackUnknownPmt=function(t,e,r){var i=this.pmtUnknownTypes[t]||0;return 0===i&&(this.pmtUnknownTypes[t]=0,e.call(s.logger,r)),this.pmtUnknownTypes[t]++,i},e._parsePMT=function(t,e,r,i){var n,a,o={audio:-1,avc:-1,id3:-1,isAAC:!0};for(n=e+3+((15&t[e+1])<<8|t[e+2])-4,e+=12+((15&t[e+10])<<8|t[e+11]);e<n;){switch(a=(31&t[e+1])<<8|t[e+2],t[e]){case 207:if(!i){this._trackUnknownPmt(t[e],s.logger.warn,"ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===o.audio&&(o.audio=a);break;case 21:-1===o.id3&&(o.id3=a);break;case 219:if(!i){this._trackUnknownPmt(t[e],s.logger.warn,"H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===o.avc&&(o.avc=a);break;case 3:case 4:r?-1===o.audio&&(o.audio=a,o.isAAC=!1):this._trackUnknownPmt(t[e],s.logger.warn,"MPEG audio found, not supported in this browser");break;case 36:this._trackUnknownPmt(t[e],s.logger.warn,"Unsupported HEVC stream type found");break;default:this._trackUnknownPmt(t[e],s.logger.log,"Unknown stream type:"+t[e])}e+=5+((15&t[e+3])<<8|t[e+4])}return o},e._parsePES=function(t){var e,r,i,n,a,o,l,u,c=0,h=t.data;if(!t||0===t.size)return null;for(;h[0].length<19&&h.length>1;){var d=new Uint8Array(h[0].length+h[1].length);d.set(h[0]),d.set(h[1],h[0].length),h[0]=d,h.splice(1,1)}if(1===((e=h[0])[0]<<16)+(e[1]<<8)+e[2]){if((i=(e[4]<<8)+e[5])&&i>t.size-6)return null;if(192&(r=e[7])&&((o=536870912*(14&e[9])+4194304*(255&e[10])+16384*(254&e[11])+128*(255&e[12])+(254&e[13])/2)>4294967295&&(o-=8589934592),64&r?((l=536870912*(14&e[14])+4194304*(255&e[15])+16384*(254&e[16])+128*(255&e[17])+(254&e[18])/2)>4294967295&&(l-=8589934592),o-l>54e5&&(s.logger.warn(Math.round((o-l)/9e4)+"s delta between PTS and DTS, align them"),o=l)):l=o),u=(n=e[8])+9,t.size<=u)return null;t.size-=u,a=new Uint8Array(t.size);for(var f=0,p=h.length;f<p;f++){var g=(e=h[f]).byteLength;if(u){if(u>g){u-=g;continue}e=e.subarray(u),g-=u,u=0}a.set(e,c),c+=g}return i&&(i-=n+3),{data:a,pts:o,dts:l,len:i}}return null},e.pushAccesUnit=function(t,e){if(t.units.length&&t.frame){var r=e.samples,i=r.length;if(isNaN(t.pts)){if(!i)return void e.dropped++;var n=r[i-1];t.pts=n.pts,t.dts=n.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===t.key||e.sps&&(i||this.contiguous)?(t.id=i,r.push(t)):e.dropped++}t.debug.length&&s.logger.log(t.pts+"/"+t.dts+":"+t.debug)},e._parseAVCPES=function(t,e){var r,i,n,a=this,o=this._avcTrack,s=this._parseAVCNALu(t.data),l=this.avcSample,u=!1,c=this.pushAccesUnit.bind(this),h=function(t,e,r,i){return{key:t,pts:e,dts:r,units:[],debug:i}};t.data=null,l&&s.length&&!o.audFound&&(c(l,o),l=this.avcSample=h(!1,t.pts,t.dts,"")),s.forEach(function(e){switch(e.type){case 1:i=!0,l||(l=a.avcSample=h(!0,t.pts,t.dts,"")),l.frame=!0;var s=e.data;if(u&&s.length>4){var d=new E(s).readSliceType();2!==d&&4!==d&&7!==d&&9!==d||(l.key=!0)}break;case 5:i=!0,l||(l=a.avcSample=h(!0,t.pts,t.dts,"")),l.key=!0,l.frame=!0;break;case 6:i=!0,(r=new E(a.discardEPB(e.data))).readUByte();for(var f=0,p=0,g=!1,v=0;!g&&r.bytesAvailable>1;){f=0;do{f+=v=r.readUByte()}while(255===v);p=0;do{p+=v=r.readUByte()}while(255===v);if(4===f&&0!==r.bytesAvailable){if(g=!0,181===r.readUByte())if(49===r.readUShort())if(1195456820===r.readUInt())if(3===r.readUByte()){var y=r.readUByte(),b=31&y,_=[y,r.readUByte()];for(n=0;n<b;n++)_.push(r.readUByte()),_.push(r.readUByte()),_.push(r.readUByte());a._insertSampleInOrder(a._txtTrack.samples,{type:3,pts:t.pts,bytes:_})}}else if(5===f&&0!==r.bytesAvailable){if(g=!0,p>16){var T=[];for(n=0;n<16;n++)T.push(r.readUByte().toString(16)),3!==n&&5!==n&&7!==n&&9!==n||T.push("-");var S=p-16,w=new Uint8Array(S);for(n=0;n<S;n++)w[n]=r.readUByte();a._insertSampleInOrder(a._txtTrack.samples,{pts:t.pts,payloadType:f,uuid:T.join(""),userDataBytes:w,userData:Object(m.utf8ArrayToStr)(w.buffer)})}}else if(p<r.bytesAvailable)for(n=0;n<p;n++)r.readUByte()}break;case 7:if(i=!0,u=!0,!o.sps){var k=(r=new E(e.data)).readSPS();o.width=k.width,o.height=k.height,o.pixelRatio=k.pixelRatio,o.sps=[e.data],o.duration=a._duration;var A=e.data.subarray(1,4),C="avc1.";for(n=0;n<3;n++){var x=A[n].toString(16);x.length<2&&(x="0"+x),C+=x}o.codec=C}break;case 8:i=!0,o.pps||(o.pps=[e.data]);break;case 9:i=!1,o.audFound=!0,l&&c(l,o),l=a.avcSample=h(!1,t.pts,t.dts,"");break;case 12:i=!1;break;default:i=!1,l&&(l.debug+="unknown NAL "+e.type+" ")}l&&i&&l.units.push(e)}),e&&l&&(c(l,o),this.avcSample=null)},e._insertSampleInOrder=function(t,e){var r=t.length;if(r>0){if(e.pts>=t[r-1].pts)t.push(e);else for(var i=r-1;i>=0;i--)if(e.pts<t[i].pts){t.splice(i,0,e);break}}else t.push(e)},e._getLastNalUnit=function(){var t,e=this.avcSample;if(!e||0===e.units.length){var r=this._avcTrack.samples;e=r[r.length-1]}if(e){var i=e.units;t=i[i.length-1]}return t},e._parseAVCNALu=function(t){var e,r,i,n,a=0,o=t.byteLength,s=this._avcTrack,l=s.naluState||0,u=l,c=[],h=-1;for(-1===l&&(h=0,n=31&t[0],l=0,a=1);a<o;)if(e=t[a++],l)if(1!==l)if(e)if(1===e){if(h>=0)i={data:t.subarray(h,a-l-1),type:n},c.push(i);else{var d=this._getLastNalUnit();if(d&&(u&&a<=4-u&&d.state&&(d.data=d.data.subarray(0,d.data.byteLength-u)),(r=a-l-1)>0)){var f=new Uint8Array(d.data.byteLength+r);f.set(d.data,0),f.set(t.subarray(0,r),d.data.byteLength),d.data=f}}a<o?(h=a,n=31&t[a],l=0):l=-1}else l=0;else l=3;else l=e?0:2;else l=e?0:1;if(h>=0&&l>=0&&(i={data:t.subarray(h,o),type:n,state:l},c.push(i)),0===c.length){var p=this._getLastNalUnit();if(p){var g=new Uint8Array(p.data.byteLength+t.byteLength);g.set(p.data,0),g.set(t,p.data.byteLength),p.data=g}}return s.naluState=l,c},e.discardEPB=function(t){for(var e,r,i=t.byteLength,n=[],a=1;a<i-2;)0===t[a]&&0===t[a+1]&&3===t[a+2]?(n.push(a+2),a+=2):a++;if(0===n.length)return t;e=i-n.length,r=new Uint8Array(e);var o=0;for(a=0;a<e;o++,a++)o===n[0]&&(o++,n.shift()),r[a]=t[o];return r},e._parseAACPES=function(t){var e,r,a,o,l,u,c,h=this._audioTrack,f=t.data,m=t.pts,y=this.aacOverFlow,b=this.aacLastPTS;if(y){var _=new Uint8Array(y.byteLength+f.byteLength);_.set(y,0),_.set(f,y.byteLength),f=_}for(a=0,l=f.length;a<l-1&&!d(f,a);a++);if(a&&(a<l-1?(u="AAC PES did not start with ADTS header,offset:"+a,c=!1):(u="no ADTS header found in AAC PES",c=!0),s.logger.warn("parsing error:"+u),this.observer.trigger(i.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:c,reason:u}),c))return;if(p(h,this.observer,f,a,this.audioCodec),r=0,e=g(h.samplerate),y&&b){var T=b+e;Math.abs(T-m)>1&&(s.logger.log("AAC: align PTS for overlapping frames by "+Math.round((T-m)/90)),m=T)}for(;a<l;){if(d(f,a)){if(a+5<l){var E=v(h,f,a,m,r);if(E){a+=E.length,o=E.sample.pts,r++;continue}}break}a++}y=a<l?f.subarray(a,l):null,this.aacOverFlow=y,this.aacLastPTS=o},e._parseMPEGPES=function(t){for(var e=t.data,r=e.length,i=0,n=0,a=t.pts;n<r;)if(T.isHeader(e,n)){var o=T.appendFrame(this._audioTrack,e,n,a,i);if(!o)break;n+=o.length,i++}else n++},e._parseID3PES=function(t){this._id3Track.samples.push(t)},t}(),A=function(){function t(t,e,r){this.observer=t,this.config=r,this.remuxer=e}var e=t.prototype;return e.resetInitSegment=function(t,e,r,i){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:e,duration:i,inputTimeScale:9e4}},e.resetTimeStamp=function(){},t.probe=function(t){var e,r,i=m.default.getID3Data(t,0);if(i&&void 0!==m.default.getTimeStamp(i))for(e=i.length,r=Math.min(t.length-1,e+100);e<r;e++)if(T.probe(t,e))return s.logger.log("MPEG Audio sync word found !"),!0;return!1},e.append=function(t,e,r,i){for(var n=m.default.getID3Data(t,0),a=m.default.getTimeStamp(n),o=void 0!==a?90*a:9e4*e,s=n.length,l=t.length,u=0,c=0,h=this._audioTrack,d=[{pts:o,dts:o,data:n}];s<l;)if(T.isHeader(t,s)){var f=T.appendFrame(h,t,s,o,u);if(!f)break;s+=f.length,c=f.sample.pts,u++}else m.default.isHeader(t,s)?(n=m.default.getID3Data(t,s),d.push({pts:c,dts:c,data:n}),s+=n.length):s++;this.remuxer.remux(h,{samples:[]},{samples:d,inputTimeScale:9e4},{samples:[]},e,r,i)},e.destroy=function(){},t}(),C=function(){function t(){}return t.getSilentFrame=function(t,e){switch(t){case"mp4a.40.2":if(1===e)return new Uint8Array([0,200,0,128,35,128]);if(2===e)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===e)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===e)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===e)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},t}(),x=Math.pow(2,32)-1,R=function(){function t(){}return t.init=function(){var e;for(e in t.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},t.types)t.types.hasOwnProperty(e)&&(t.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);t.HDLR_TYPES={video:r,audio:i};var n=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);t.STTS=t.STSC=t.STCO=a,t.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),t.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),t.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),t.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);t.FTYP=t.box(t.types.ftyp,o,l,o,s),t.DINF=t.box(t.types.dinf,t.box(t.types.dref,n))},t.box=function(t){for(var e,r=Array.prototype.slice.call(arguments,1),i=8,n=r.length,a=n;n--;)i+=r[n].byteLength;for((e=new Uint8Array(i))[0]=i>>24&255,e[1]=i>>16&255,e[2]=i>>8&255,e[3]=255&i,e.set(t,4),n=0,i=8;n<a;n++)e.set(r[n],i),i+=r[n].byteLength;return e},t.hdlr=function(e){return t.box(t.types.hdlr,t.HDLR_TYPES[e])},t.mdat=function(e){return t.box(t.types.mdat,e)},t.mdhd=function(e,r){r*=e;var i=Math.floor(r/(x+1)),n=Math.floor(r%(x+1));return t.box(t.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,85,196,0,0]))},t.mdia=function(e){return t.box(t.types.mdia,t.mdhd(e.timescale,e.duration),t.hdlr(e.type),t.minf(e))},t.mfhd=function(e){return t.box(t.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))},t.minf=function(e){return"audio"===e.type?t.box(t.types.minf,t.box(t.types.smhd,t.SMHD),t.DINF,t.stbl(e)):t.box(t.types.minf,t.box(t.types.vmhd,t.VMHD),t.DINF,t.stbl(e))},t.moof=function(e,r,i){return t.box(t.types.moof,t.mfhd(e),t.traf(i,r))},t.moov=function(e){for(var r=e.length,i=[];r--;)i[r]=t.trak(e[r]);return t.box.apply(null,[t.types.moov,t.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(t.mvex(e)))},t.mvex=function(e){for(var r=e.length,i=[];r--;)i[r]=t.trex(e[r]);return t.box.apply(null,[t.types.mvex].concat(i))},t.mvhd=function(e,r){r*=e;var i=Math.floor(r/(x+1)),n=Math.floor(r%(x+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,n>>24,n>>16&255,n>>8&255,255&n,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return t.box(t.types.mvhd,a)},t.sdtp=function(e){var r,i,n=e.samples||[],a=new Uint8Array(4+n.length);for(i=0;i<n.length;i++)r=n[i].flags,a[i+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return t.box(t.types.sdtp,a)},t.stbl=function(e){return t.box(t.types.stbl,t.stsd(e),t.box(t.types.stts,t.STTS),t.box(t.types.stsc,t.STSC),t.box(t.types.stsz,t.STSZ),t.box(t.types.stco,t.STCO))},t.avc1=function(e){var r,i,n,a=[],o=[];for(r=0;r<e.sps.length;r++)n=(i=e.sps[r]).byteLength,a.push(n>>>8&255),a.push(255&n),a=a.concat(Array.prototype.slice.call(i));for(r=0;r<e.pps.length;r++)n=(i=e.pps[r]).byteLength,o.push(n>>>8&255),o.push(255&n),o=o.concat(Array.prototype.slice.call(i));var s=t.box(t.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(o))),l=e.width,u=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return t.box(t.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,t.box(t.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),t.box(t.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,h>>24,h>>16&255,h>>8&255,255&h])))},t.esds=function(t){var e=t.config.length;return new Uint8Array([0,0,0,0,3,23+e,0,1,0,4,15+e,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([e]).concat(t.config).concat([6,1,2]))},t.mp4a=function(e){var r=e.samplerate;return t.box(t.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]),t.box(t.types.esds,t.esds(e)))},t.mp3=function(e){var r=e.samplerate;return t.box(t.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,r>>8&255,255&r,0,0]))},t.stsd=function(e){return"audio"===e.type?e.isAAC||"mp3"!==e.codec?t.box(t.types.stsd,t.STSD,t.mp4a(e)):t.box(t.types.stsd,t.STSD,t.mp3(e)):t.box(t.types.stsd,t.STSD,t.avc1(e))},t.tkhd=function(e){var r=e.id,i=e.duration*e.timescale,n=e.width,a=e.height,o=Math.floor(i/(x+1)),s=Math.floor(i%(x+1));return t.box(t.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,n>>8&255,255&n,0,0,a>>8&255,255&a,0,0]))},t.traf=function(e,r){var i=t.sdtp(e),n=e.id,a=Math.floor(r/(x+1)),o=Math.floor(r%(x+1));return t.box(t.types.traf,t.box(t.types.tfhd,new Uint8Array([0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n])),t.box(t.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),t.trun(e,i.length+16+20+8+16+8+8),i)},t.trak=function(e){return e.duration=e.duration||4294967295,t.box(t.types.trak,t.tkhd(e),t.mdia(e))},t.trex=function(e){var r=e.id;return t.box(t.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},t.trun=function(e,r){var i,n,a,o,s,l,u=e.samples||[],c=u.length,h=12+16*c,d=new Uint8Array(h);for(r+=8+h,d.set([0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),i=0;i<c;i++)a=(n=u[i]).duration,o=n.size,s=n.flags,l=n.cts,d.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*i);return t.box(t.types.trun,d)},t.initSegment=function(e){t.types||t.init();var r,i=t.moov(e);return(r=new Uint8Array(t.FTYP.byteLength+i.byteLength)).set(t.FTYP),r.set(i,t.FTYP.byteLength),r},t}(),L=9e4;function D(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=!1);var n=t*e*r;return i?Math.round(n):n}function O(t,e){return void 0===e&&(e=!1),D(t,1e3,1/L,e)}function I(t,e){return void 0===e&&(e=1),D(t,L,1/e)}var P=I(10),M=I(.2);function N(t,e){var r;if(void 0===e)return t;for(r=e<t?-8589934592:8589934592;Math.abs(t-e)>4294967296;)t+=r;return t}var F,B=function(){function t(t,e,r,i){this.observer=t,this.config=e,this.typeSupported=r,this.ISGenerated=!1}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(t){this._initPTS=this._initDTS=t},e.resetInitSegment=function(){this.ISGenerated=!1},e.remux=function(t,e,r,n,a,o,l){if(this.ISGenerated||this.generateIS(t,e,a),this.ISGenerated){var u=t.samples.length,c=e.samples.length,h=a,d=a;if(u&&c){var f=e.samples.reduce(function(t,e){return Math.min(t,e.pts)},e.samples[0].pts),p=(t.samples[0].pts-f)/e.inputTimeScale;h+=Math.max(0,p),d+=Math.max(0,-p)}if(u){t.timescale||(s.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(t,e,a));var g,v=this.remuxAudio(t,h,o,l);if(c)v&&(g=v.endPTS-v.startPTS),e.timescale||(s.logger.warn("regenerate InitSegment as video detected"),this.generateIS(t,e,a)),this.remuxVideo(e,d,o,g)}else if(c){var m=this.remuxVideo(e,d,o,0,l);m&&t.codec&&this.remuxEmptyAudio(t,h,o,m)}}r.samples.length&&this.remuxID3(r,a),n.samples.length&&this.remuxText(n,a),this.observer.trigger(i.default.FRAG_PARSED)},e.generateIS=function(t,e,r){var a,o,l=this.observer,u=t.samples,c=e.samples,h=this.typeSupported,d="audio/mp4",f={},p={tracks:f},g=void 0===this._initPTS;if(g&&(a=o=1/0),t.config&&u.length&&(t.timescale=t.samplerate,s.logger.log("audio sampling rate : "+t.samplerate),t.isAAC||(h.mpeg?(d="audio/mpeg",t.codec=""):h.mp3&&(t.codec="mp3")),f.audio={container:d,codec:t.codec,initSegment:!t.isAAC&&h.mpeg?new Uint8Array:R.initSegment([t]),metadata:{channelCount:t.channelCount}},g&&(a=o=u[0].pts-Math.round(t.inputTimeScale*r))),e.sps&&e.pps&&c.length){var v=e.inputTimeScale;if(e.timescale=v,f.video={container:"video/mp4",codec:e.codec,initSegment:R.initSegment([e]),metadata:{width:e.width,height:e.height}},g){var m=c.reduce(function(t,e){return Math.min(t,e.pts)},c[0].pts),y=Math.round(v*r);o=Math.min(o,c[0].dts-y),a=Math.min(a,m-y),this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:a})}}else g&&f.audio&&this.observer.trigger(i.default.INIT_PTS_FOUND,{initPTS:a});Object.keys(f).length?(l.trigger(i.default.FRAG_PARSING_INIT_SEGMENT,p),this.ISGenerated=!0,g&&(this._initPTS=a,this._initDTS=o)):l.trigger(i.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},e.remuxVideo=function(t,e,r,a){var o,l,u,c,h,d=t.timescale,f=t.samples,p=[],g=f.length,v=this._initPTS,m=8,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,_=0,T=!1,E=this.nextAvcDts;if(0!==g){if(!r)E=e*d-(f[0].pts-f[0].dts);for(var S=0;S<g;S++){var w=f[S];w.dts>w.pts&&(_=Math.max(Math.min(_,w.pts-w.dts),-1*M)),w.dts<f[S>0?S-1:S].dts&&(T=!0),w.pts=N(w.pts-v,E),w.dts=N(w.dts-v,E)}T&&f.sort(function(t,e){var r=t.dts-e.dts,i=t.pts-e.pts;return r||i||t.id-e.id}),c=f[0].dts,h=f[g-1].dts;var k=Math.round((h-c)/(g-1));if(_<0){if(_<-2*k){s.logger.warn("PTS < DTS detected in video samples, offsetting DTS to PTS "+O(-k,!0)+" ms");for(var A=0;A<g;A++)f[A].dts=f[A].pts-k}else{s.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+O(_,!0)+" ms to overcome this issue");for(var C=0;C<g;C++)f[C].dts=f[C].dts+_}c=f[0].dts,h=f[g-1].dts}if(r){var x=c-E,L=x>k;if(L||x<-1){L?s.logger.warn("AVC: "+O(x,!0)+" ms ("+x+"dts) hole between fragments detected, filling it"):s.logger.warn("AVC: "+O(-x,!0)+" ms ("+x+"dts) overlapping between fragments detected"),c=E;var D=f[0].pts-x;f[0].dts=c,f[0].pts=D,s.logger.log("Video: First PTS/DTS adjusted: "+O(D,!0)+"/"+O(c,!0)+", delta: "+O(x,!0)+" ms")}}for(var I=0,P=0,F=0;F<g;F++){for(var B=f[F],j=B.units,U=j.length,G=0,H=0;H<U;H++)G+=j[H].data.length;P+=G,I+=U,B.length=G,B.dts=Math.max(B.dts,c),B.pts=Math.max(B.pts,B.dts,0),y=Math.min(B.pts,y),b=Math.max(B.pts,b)}var V=P+4*I+8;try{l=new Uint8Array(V)}catch(t){return void this.observer.trigger(i.default.ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:V,reason:"fail allocating video mdat "+V})}var K=new DataView(l.buffer);K.setUint32(0,V),l.set(R.types.mdat,4);for(var W=0;W<g;W++){for(var z,q=f[W],Y=q.units,X=0,$=0,J=Y.length;$<J;$++){var Q=Y[$],Z=Q.data,tt=Q.data.byteLength;K.setUint32(m,tt),m+=4,l.set(Z,m),m+=tt,X+=4+tt}if(W<g-1)o=f[W+1].dts-q.dts;else{var et=this.config,rt=q.dts-f[W>0?W-1:W].dts;if(et.stretchShortVideoTrack){var it=et.maxBufferHole,nt=Math.floor(it*d),at=(a?y+a*d:this.nextAudioPts)-q.pts;at>nt?((o=at-rt)<0&&(o=rt),s.logger.log("It is approximately "+O(at,!1)+" ms to the next segment; using duration "+O(o,!1)+" ms for the last video frame.")):o=rt}else o=rt}z=Math.round(q.pts-q.dts),p.push({size:X,duration:o,cts:z,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:q.key?2:1,isNonSync:q.key?0:1}})}this.nextAvcDts=h+o;var ot=t.dropped;if(t.nbNalu=0,t.dropped=0,p.length&&navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var st=p[0].flags;st.dependsOn=2,st.isNonSync=0}t.samples=p,u=R.moof(t.sequenceNumber++,c,t),t.samples=[];var lt={data1:u,data2:l,startPTS:y/d,endPTS:(b+o)/d,startDTS:c/d,endDTS:this.nextAvcDts/d,type:"video",hasAudio:!1,hasVideo:!0,nb:p.length,dropped:ot};return this.observer.trigger(i.default.FRAG_PARSING_DATA,lt),lt}},e.remuxAudio=function(t,e,r,a){var o,l,u,c,h,d,f=t.inputTimeScale,p=t.timescale,g=f/p,v=(t.isAAC?1024:1152)*g,m=this._initPTS,y=!t.isAAC&&this.typeSupported.mpeg,b=y?0:8,_=t.samples,T=[],E=this.nextAudioPts;if(r|=_.length&&E&&(a&&Math.abs(e-E/f)<.1||Math.abs(_[0].pts-E-m)<20*v),_.forEach(function(t){t.pts=t.dts=N(t.pts-m,e*f)}),0!==(_=_.filter(function(t){return t.pts>=0})).length){if(r||(E=a?Math.max(0,e*f):_[0].pts),t.isAAC)for(var S=this.config.maxAudioFramesDrift,w=0,k=E;w<_.length;){var A=_[w],x=A.pts,L=x-k;if(L<=-S*v)r?(s.logger.warn("Dropping 1 audio frame @ "+O(k,!0)/1e3+"s due to "+O(L,!0)+" ms overlap."),_.splice(w,1)):(s.logger.warn("Audio frame @ "+O(x,!0)/1e3+"s overlaps nextAudioPts by "+O(L,!0)+" ms."),k=x+v,w++);else if(L>=S*v&&L<P&&k){var D=Math.round(L/v);s.logger.warn("Injecting "+D+" audio frames @ "+O(k,!0)/1e3+"s due to "+O(L,!0)+" ms gap.");for(var I=0;I<D;I++){var M=Math.max(k,0);(l=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),l=A.unit.subarray()),_.splice(w,0,{unit:l,pts:M,dts:M}),k+=v,w++}A.pts=A.dts=k,k+=v,w++}else Math.abs(L),A.pts=A.dts=k,k+=v,w++}for(var F=_.length,B=0;F--;)B+=_[F].unit.byteLength;for(var j=0,U=_.length;j<U;j++){var G=_[j],H=G.unit,V=G.pts;if(void 0!==d&&o)o.duration=Math.round((V-d)/g);else{var K=V-E,W=0;if(r&&t.isAAC&&K){if(K>0&&K<P)W=Math.round((V-E)/v),s.logger.log(O(K,!0)+" ms hole between AAC samples detected,filling it"),W>0&&((l=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(l=H.subarray()),B+=W*l.length);else if(K<-12){s.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+O(E,!0)+" ms / "+O(V,!0)+" ms / "+O(-K,!0)+" ms"),B-=H.byteLength;continue}V=E}if(h=V,!(B>0))return;B+=b;try{u=new Uint8Array(B)}catch(t){return void this.observer.trigger(i.default.ERROR,{type:n.ErrorTypes.MUX_ERROR,details:n.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:B,reason:"fail allocating audio mdat "+B})}y||(new DataView(u.buffer).setUint32(0,B),u.set(R.types.mdat,4));for(var z=0;z<W;z++)(l=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount))||(s.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),l=H.subarray()),u.set(l,b),b+=l.byteLength,o={size:l.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(o)}u.set(H,b);var q=H.byteLength;b+=q,o={size:q,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},T.push(o),d=V}var Y=0;if((F=T.length)>=2&&(Y=T[F-2].duration,o.duration=Y),F){this.nextAudioPts=E=d+g*Y,t.samples=T,c=y?new Uint8Array:R.moof(t.sequenceNumber++,h/g,t),t.samples=[];var X=h/f,$=E/f,J={data1:c,data2:u,startPTS:X,endPTS:$,startDTS:X,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:F};return this.observer.trigger(i.default.FRAG_PARSING_DATA,J),J}return null}},e.remuxEmptyAudio=function(t,e,r,i){var n=t.inputTimeScale,a=n/(t.samplerate?t.samplerate:n),o=this.nextAudioPts,l=(void 0!==o?o:i.startDTS*n)+this._initDTS,u=i.endDTS*n+this._initDTS,c=1024*a,h=Math.ceil((u-l)/c),d=C.getSilentFrame(t.manifestCodec||t.codec,t.channelCount);if(s.logger.warn("remux empty Audio"),d){for(var f=[],p=0;p<h;p++){var g=l+p*c;f.push({unit:d,pts:g,dts:g})}t.samples=f,this.remuxAudio(t,e,r)}else s.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},e.remuxID3=function(t){var e=t.samples.length;if(e){for(var r=t.inputTimeScale,n=this._initPTS,a=this._initDTS,o=0;o<e;o++){var s=t.samples[o];s.pts=(s.pts-n)/r,s.dts=(s.dts-a)/r}this.observer.trigger(i.default.FRAG_PARSING_METADATA,{samples:t.samples}),t.samples=[]}},e.remuxText=function(t){t.samples.sort(function(t,e){return t.pts-e.pts});var e,r=t.samples.length,n=t.inputTimeScale,a=this._initPTS;if(r){for(var o=0;o<r;o++)(e=t.samples[o]).pts=(e.pts-a)/n;this.observer.trigger(i.default.FRAG_PARSING_USERDATA,{samples:t.samples})}t.samples=[]},t}(),j=function(){function t(t){this.observer=t}var e=t.prototype;return e.destroy=function(){},e.resetTimeStamp=function(){},e.resetInitSegment=function(){},e.remux=function(t,e,r,n,a,o,s,l){var u=this.observer,c="";t&&(c+="audio"),e&&(c+="video"),u.trigger(i.default.FRAG_PARSING_DATA,{data1:l,startPTS:a,startDTS:a,type:c,hasAudio:!!t,hasVideo:!!e,nb:1,dropped:0}),u.trigger(i.default.FRAG_PARSED)},t}(),U=Object(l.getSelfScope)();try{F=U.performance.now.bind(U.performance)}catch(t){s.logger.debug("Unable to use Performance API on this environment"),F=U.Date.now}var G=function(){function t(t,e,r,i){this.observer=t,this.typeSupported=e,this.config=r,this.vendor=i}var e=t.prototype;return e.destroy=function(){var t=this.demuxer;t&&t.destroy()},e.push=function(t,e,r,n,o,s,l,u,c,h,d,f){var p=this;if(t.byteLength>0&&null!=e&&null!=e.key&&"AES-128"===e.method){var g=this.decrypter;null==g&&(g=this.decrypter=new a.default(this.observer,this.config));var v=F();g.decrypt(t,e.key.buffer,e.iv.buffer,function(t){var a=F();p.observer.trigger(i.default.FRAG_DECRYPTED,{stats:{tstart:v,tdecrypt:a}}),p.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),n,o,s,l,u,c,h,d,f)})}else this.pushDecrypted(new Uint8Array(t),e,new Uint8Array(r),n,o,s,l,u,c,h,d,f)},e.pushDecrypted=function(t,e,r,a,o,s,l,u,c,h,d,f){var p=this.demuxer,g=this.remuxer;if(!p||l||u){for(var v,m=this.observer,_=this.typeSupported,T=this.config,E=[{demux:k,remux:B},{demux:b.default,remux:j},{demux:y,remux:B},{demux:A,remux:B}],S=0,w=E.length;S<w&&!(v=E[S]).demux.probe(t);S++);if(!v)return void m.trigger(i.default.ERROR,{type:n.ErrorTypes.MEDIA_ERROR,details:n.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});g&&g instanceof v.remux||(g=new v.remux(m,T,_,this.vendor)),p&&p instanceof v.demux||(p=new v.demux(m,g,T,_),this.probe=v.demux.probe),this.demuxer=p,this.remuxer=g}(l||u)&&(p.resetInitSegment(r,a,o,h),g.resetInitSegment()),l&&(p.resetTimeStamp(f),g.resetTimeStamp(f)),"function"==typeof p.setDecryptData&&p.setDecryptData(e),p.append(t,s,c,d)},t}();e.default=G},"./src/demux/demuxer-worker.js":
/*!*************************************!*\
  !*** ./src/demux/demuxer-worker.js ***!
  \*************************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: ./src/demux/demuxer.js (referenced with require.resolve) */function(t,e,r){"use strict";r.r(e);var i=r(/*! ../demux/demuxer-inline */"./src/demux/demuxer-inline.js"),n=r(/*! ../events */"./src/events.js"),a=r(/*! ../utils/logger */"./src/utils/logger.js"),o=r(/*! eventemitter3 */"./node_modules/eventemitter3/index.js");e.default=function(t){var e=new o.EventEmitter;e.trigger=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.emit.apply(e,[t,t].concat(i))},e.off=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),n=1;n<r;n++)i[n-1]=arguments[n];e.removeListener.apply(e,[t].concat(i))};var r=function(e,r){t.postMessage({event:e,data:r})};t.addEventListener("message",function(n){var o=n.data;switch(o.cmd){case"init":var s=JSON.parse(o.config);t.demuxer=new i.default(e,o.typeSupported,s,o.vendor),Object(a.enableLogs)(s.debug),r("init",null);break;case"demux":t.demuxer.push(o.data,o.decryptdata,o.initSegment,o.audioCodec,o.videoCodec,o.timeOffset,o.discontinuity,o.trackSwitch,o.contiguous,o.duration,o.accurateTimeOffset,o.defaultInitPTS)}}),e.on(n.default.FRAG_DECRYPTED,r),e.on(n.default.FRAG_PARSING_INIT_SEGMENT,r),e.on(n.default.FRAG_PARSED,r),e.on(n.default.ERROR,r),e.on(n.default.FRAG_PARSING_METADATA,r),e.on(n.default.FRAG_PARSING_USERDATA,r),e.on(n.default.INIT_PTS_FOUND,r),e.on(n.default.FRAG_PARSING_DATA,function(e,r){var i=[],n={event:e,data:r};r.data1&&(n.data1=r.data1.buffer,i.push(r.data1.buffer),delete r.data1),r.data2&&(n.data2=r.data2.buffer,i.push(r.data2.buffer),delete r.data2),t.postMessage(n,i)})}},"./src/demux/id3.js":
/*!**************************!*\
  !*** ./src/demux/id3.js ***!
  \**************************/
/*! exports provided: default, utf8ArrayToStr */function(t,e,r){"use strict";r.r(e),r.d(e,"utf8ArrayToStr",function(){return s});var i,n=r(/*! ../utils/get-self-scope */"./src/utils/get-self-scope.js"),a=function(){function t(){}return t.isHeader=function(t,e){return e+10<=t.length&&73===t[e]&&68===t[e+1]&&51===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.isFooter=function(t,e){return e+10<=t.length&&51===t[e]&&68===t[e+1]&&73===t[e+2]&&t[e+3]<255&&t[e+4]<255&&t[e+6]<128&&t[e+7]<128&&t[e+8]<128&&t[e+9]<128},t.getID3Data=function(e,r){for(var i=r,n=0;t.isHeader(e,r);){n+=10,n+=t._readSize(e,r+6),t.isFooter(e,r+10)&&(n+=10),r+=n}if(n>0)return e.subarray(i,i+n)},t._readSize=function(t,e){var r=0;return r=(127&t[e])<<21,r|=(127&t[e+1])<<14,r|=(127&t[e+2])<<7,r|=127&t[e+3]},t.getTimeStamp=function(e){for(var r=t.getID3Frames(e),i=0;i<r.length;i++){var n=r[i];if(t.isTimeStampFrame(n))return t._readTimeStamp(n)}},t.isTimeStampFrame=function(t){return t&&"PRIV"===t.key&&"com.apple.streaming.transportStreamTimestamp"===t.info},t._getFrameData=function(e){var r=String.fromCharCode(e[0],e[1],e[2],e[3]),i=t._readSize(e,4);return{type:r,size:i,data:e.subarray(10,10+i)}},t.getID3Frames=function(e){for(var r=0,i=[];t.isHeader(e,r);){for(var n=t._readSize(e,r+6),a=(r+=10)+n;r+8<a;){var o=t._getFrameData(e.subarray(r)),s=t._decodeFrame(o);s&&i.push(s),r+=o.size+10}t.isFooter(e,r)&&(r+=10)}return i},t._decodeFrame=function(e){return"PRIV"===e.type?t._decodePrivFrame(e):"T"===e.type[0]?t._decodeTextFrame(e):"W"===e.type[0]?t._decodeURLFrame(e):void 0},t._readTimeStamp=function(t){if(8===t.data.byteLength){var e=new Uint8Array(t.data),r=1&e[3],i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,r&&(i+=47721858.84),Math.round(i)}},t._decodePrivFrame=function(e){if(!(e.size<2)){var r=t._utf8ArrayToStr(e.data,!0),i=new Uint8Array(e.data.subarray(r.length+1));return{key:e.type,info:r,data:i.buffer}}},t._decodeTextFrame=function(e){if(!(e.size<2)){if("TXXX"===e.type){var r=1,i=t._utf8ArrayToStr(e.data.subarray(r),!0);r+=i.length+1;var n=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:i,data:n}}var a=t._utf8ArrayToStr(e.data.subarray(1));return{key:e.type,data:a}}},t._decodeURLFrame=function(e){if("WXXX"===e.type){if(e.size<2)return;var r=1,i=t._utf8ArrayToStr(e.data.subarray(r));r+=i.length+1;var n=t._utf8ArrayToStr(e.data.subarray(r));return{key:e.type,info:i,data:n}}var a=t._utf8ArrayToStr(e.data);return{key:e.type,data:a}},t._utf8ArrayToStr=function(t,e){void 0===e&&(e=!1);var r=o();if(r){var i=r.decode(t);if(e){var n=i.indexOf("\0");return-1!==n?i.substring(0,n):i}return i.replace(/\0/g,"")}for(var a,s,l,u=t.length,c="",h=0;h<u;){if(0===(a=t[h++])&&e)return c;if(0!==a&&3!==a)switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:c+=String.fromCharCode(a);break;case 12:case 13:s=t[h++],c+=String.fromCharCode((31&a)<<6|63&s);break;case 14:s=t[h++],l=t[h++],c+=String.fromCharCode((15&a)<<12|(63&s)<<6|(63&l)<<0)}}return c},t}();function o(){var t=Object(n.getSelfScope)();return i||void 0===t.TextDecoder||(i=new t.TextDecoder("utf-8")),i}var s=a._utf8ArrayToStr;e.default=a},"./src/demux/mp4demuxer.js":
/*!*********************************!*\
  !*** ./src/demux/mp4demuxer.js ***!
  \*********************************/
/*! exports provided: default */function(t,e,r){"use strict";r.r(e);var i=r(/*! ../utils/logger */"./src/utils/logger.js"),n=r(/*! ../events */"./src/events.js"),a=Math.pow(2,32)-1,o=function(){function t(t,e){this.observer=t,this.remuxer=e}var e=t.prototype;return e.resetTimeStamp=function(t){this.initPTS=t},e.resetInitSegment=function(e,r,i,a){if(e&&e.byteLength){var o=this.initData=t.parseInitSegment(e);null==r&&(r="mp4a.40.5"),null==i&&(i="avc1.42e01e");var s={};o.audio&&o.video?s.audiovideo={container:"video/mp4",codec:r+","+i,initSegment:a?e:null}:(o.audio&&(s.audio={container:"audio/mp4",codec:r,initSegment:a?e:null}),o.video&&(s.video={container:"video/mp4",codec:i,initSegment:a?e:null})),this.observer.trigger(n.default.FRAG_PARSING_INIT_SEGMENT,{tracks:s})}else r&&(this.audioCodec=r),i&&(this.videoCodec=i)},t.probe=function(e){return t.findBox({data:e,start:0,end:Math.min(e.length,16384)},["moof"]).length>0},t.bin2str=function(t){return String.fromCharCode.apply(null,t)},t.readUint16=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<8|t[e+1];return r<0?65536+r:r},t.readUint32=function(t,e){t.data&&(e+=t.start,t=t.data);var r=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3];return r<0?4294967296+r:r},t.writeUint32=function(t,e,r){t.data&&(e+=t.start,t=t.data),t[e]=r>>24,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r},t.findBox=function(e,r){var i,n,a,o,s,l,u,c=[];if(e.data?(l=e.start,o=e.end,e=e.data):(l=0,o=e.byteLength),!r.length)return null;for(i=l;i<o;)n=t.readUint32(e,i),a=t.bin2str(e.subarray(i+4,i+8)),u=n>1?i+n:o,a===r[0]&&(1===r.length?c.push({data:e,start:i+8,end:u}):(s=t.findBox({data:e,start:i+8,end:u},r.slice(1))).length&&(c=c.concat(s))),i=u;return c},t.parseSegmentIndex=function(e){var r,i=t.findBox(e,["moov"])[0],n=i?i.end:null,a=0,o=t.findBox(e,["sidx"]);if(!o||!o[0])return null;r=[];var s=(o=o[0]).data[0];a=0===s?8:16;var l=t.readUint32(o,a);a+=4;a+=0===s?8:16,a+=2;var u=o.end+0,c=t.readUint16(o,a);a+=2;for(var h=0;h<c;h++){var d=a,f=t.readUint32(o,d);d+=4;var p=2147483647&f;if(1===(2147483648&f)>>>31)return void console.warn("SIDX has hierarchical references (not supported)");var g=t.readUint32(o,d);d+=4,r.push({referenceSize:p,subsegmentDuration:g,info:{duration:g/l,start:u,end:u+p-1}}),u+=p,a=d+=4}return{earliestPresentationTime:0,timescale:l,version:s,referencesCount:c,references:r,moovEndOffset:n}},t.parseInitSegment=function(e){var r=[];return t.findBox(e,["moov","trak"]).forEach(function(e){var n=t.findBox(e,["tkhd"])[0];if(n){var a=n.data[n.start],o=0===a?12:20,s=t.readUint32(n,o),l=t.findBox(e,["mdia","mdhd"])[0];if(l){o=0===(a=l.data[l.start])?12:20;var u=t.readUint32(l,o),c=t.findBox(e,["mdia","hdlr"])[0];if(c){var h={soun:"audio",vide:"video"}[t.bin2str(c.data.subarray(c.start+8,c.start+12))];if(h){var d=t.findBox(e,["mdia","minf","stbl","stsd"]);if(d.length){d=d[0];var f=t.bin2str(d.data.subarray(d.start+12,d.start+16));i.logger.log("MP4Demuxer:"+h+":"+f+" found")}r[s]={timescale:u,type:h},r[h]={timescale:u,id:s}}}}}}),r},t.getStartDTS=function(e,r){var i,n,a;return i=t.findBox(r,["moof","traf"]),n=[].concat.apply([],i.map(function(r){return t.findBox(r,["tfhd"]).map(function(i){var n,a;return n=t.readUint32(i,4),a=e[n].timescale||9e4,t.findBox(r,["tfdt"]).map(function(e){var r,i;return r=e.data[e.start],i=t.readUint32(e,4),1===r&&(i*=Math.pow(2,32),i+=t.readUint32(e,8)),i})[0]/a})})),a=Math.min.apply(null,n),isFinite(a)?a:0},t.offsetStartDTS=function(e,r,i){t.findBox(r,["moof","traf"]).map(function(r){return t.findBox(r,["tfhd"]).map(function(n){var o=t.readUint32(n,4),s=e[o].timescale||9e4;t.findBox(r,["tfdt"]).map(function(e){var r=e.data[e.start],n=t.readUint32(e,4);if(0===r)t.writeUint32(e,4,n-i*s);else{n*=Math.pow(2,32),n+=t.readUint32(e,8),n-=i*s,n=Math.max(n,0);var o=Math.floor(n/(a+1)),l=Math.floor(n%(a+1));t.writeUint32(e,4,o),t.writeUint32(e,8,l)}})})})},e.append=function(e,r,i,a){var o=this.initData;o||(this.resetInitSegment(e,this.audioCodec,this.videoCodec,!1),o=this.initData);var s,l=this.initPTS;if(void 0===l){var u=t.getStartDTS(o,e);this.initPTS=l=u-r,this.observer.trigger(n.default.INIT_PTS_FOUND,{initPTS:l})}t.offsetStartDTS(o,e,l),s=t.getStartDTS(o,e),this.remuxer.remux(o.audio,o.video,null,null,s,i,a,e)},e.destroy=function(){},t}();e.default=o},"./src/errors.ts":
/*!***********************!*\
  !*** ./src/errors.ts ***!
  \***********************/
/*! exports provided: ErrorTypes, ErrorDetails */function(t,e,r){"use strict";var i,n;r.r(e),r.d(e,"ErrorTypes",function(){return i}),r.d(e,"ErrorDetails",function(){return n}),function(t){t.NETWORK_ERROR="networkError",t.MEDIA_ERROR="mediaError",t.KEY_SYSTEM_ERROR="keySystemError",t.MUX_ERROR="muxError",t.OTHER_ERROR="otherError"}(i||(i={})),function(t){t.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",t.KEY_SYSTEM_NO_SESSION="keySystemNoSession",t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",t.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",t.MANIFEST_LOAD_ERROR="manifestLoadError",t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",t.MANIFEST_PARSING_ERROR="manifestParsingError",t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",t.LEVEL_EMPTY_ERROR="levelEmptyError",t.LEVEL_LOAD_ERROR="levelLoadError",t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",t.LEVEL_SWITCH_ERROR="levelSwitchError",t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",t.FRAG_LOAD_ERROR="fragLoadError",t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",t.FRAG_DECRYPT_ERROR="fragDecryptError",t.FRAG_PARSING_ERROR="fragParsingError",t.REMUX_ALLOC_ERROR="remuxAllocError",t.KEY_LOAD_ERROR="keyLoadError",t.KEY_LOAD_TIMEOUT="keyLoadTimeOut",t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",t.BUFFER_APPEND_ERROR="bufferAppendError",t.BUFFER_APPENDING_ERROR="bufferAppendingError",t.BUFFER_STALLED_ERROR="bufferStalledError",t.BUFFER_FULL_ERROR="bufferFullError",t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",t.INTERNAL_EXCEPTION="internalException"}(n||(n={}))},"./src/events.js":
/*!***********************!*\
  !*** ./src/events.js ***!
  \***********************/
/*! exports provided: default */function(t,e,r){"use strict";r.r(e);e.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",LEVELS_UPDATED:"hlsLevelsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",CUES_PARSED:"hlsCuesParsed",NON_NATIVE_TEXT_TRACKS_FOUND:"hlsNonNativeTextTracksFound",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":
/*!*********************************!*\
  !*** ./src/hls.ts + 50 modules ***!
  \*********************************/
/*! exports provided: default */
/*! ModuleConcatenation bailout: Cannot concat with ./src/crypt/decrypter.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/demuxer-inline.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/id3.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/demux/mp4demuxer.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/errors.ts because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/events.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/polyfills/number.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/get-self-scope.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./src/utils/logger.js because of ./src/demux/demuxer-worker.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/eventemitter3/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url-toolkit/src/url-toolkit.js (<- Module is not an ECMAScript module) */function(t,e,r){"use strict";r.r(e),r.d(e,"default",function(){return ze});var i={};r.r(i),r.d(i,"newCue",function(){return Qt});var n,a,o=r("./node_modules/url-toolkit/src/url-toolkit.js"),s=r("./src/errors.ts"),l=r("./src/polyfills/number.js"),u=r("./src/events.js"),c=r("./src/utils/logger.js"),h={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},d=function(){function t(t){this.hls=void 0,this.handledEvents=void 0,this.useGenericHandler=void 0,this.hls=t,this.onEvent=this.onEvent.bind(this);for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.handledEvents=r,this.useGenericHandler=!0,this.registerListeners()}var e=t.prototype;return e.destroy=function(){this.onHandlerDestroying(),this.unregisterListeners(),this.onHandlerDestroyed()},e.onHandlerDestroying=function(){},e.onHandlerDestroyed=function(){},e.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},e.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){if(h[t])throw new Error("Forbidden event-name: "+t);this.hls.on(t,this.onEvent)},this)},e.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(t){this.hls.off(t,this.onEvent)},this)},e.onEvent=function(t,e){this.onEventGeneric(t,e)},e.onEventGeneric=function(t,e){try{(function(t,e){var r="on"+t.replace("hls","");if("function"!=typeof this[r])throw new Error("Event "+t+" has no generic handler in this "+this.constructor.name+" class (tried "+r+")");return this[r].bind(this,e)}).call(this,t,e).call()}catch(e){c.logger.error("An internal error happened while handling event "+t+'. Error message: "'+e.message+'". Here is a stacktrace:',e),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:t,err:e})}},t}();!function(t){t.MANIFEST="manifest",t.LEVEL="level",t.AUDIO_TRACK="audioTrack",t.SUBTITLE_TRACK="subtitleTrack"}(n||(n={})),function(t){t.MAIN="main",t.AUDIO="audio",t.SUBTITLE="subtitle"}(a||(a={}));var f=r("./src/demux/mp4demuxer.js");function p(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var g,v=function(){function t(t,e){this._uri=null,this.baseuri=void 0,this.reluri=void 0,this.method=null,this.key=null,this.iv=null,this.baseuri=t,this.reluri=e}var e,r,i;return e=t,(r=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(o.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&p(e.prototype,r),i&&p(e,i),t}();function m(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}!function(t){t.AUDIO="audio",t.VIDEO="video"}(g||(g={}));var y=function(){function t(){var t;this._url=null,this._byteRange=null,this._decryptdata=null,this._elementaryStreams=((t={})[g.AUDIO]=!1,t[g.VIDEO]=!1,t),this.deltaPTS=0,this.rawProgramDateTime=null,this.programDateTime=null,this.title=null,this.tagList=[],this.cc=void 0,this.type=void 0,this.relurl=void 0,this.baseurl=void 0,this.duration=void 0,this.start=void 0,this.sn=0,this.urlId=0,this.level=0,this.levelkey=void 0,this.loader=void 0}var e,r,i,n=t.prototype;return n.setByteRange=function(t,e){var r=t.split("@",2),i=[];1===r.length?i[0]=e?e.byteRangeEndOffset:0:i[0]=parseInt(r[1]),i[1]=parseInt(r[0])+i[0],this._byteRange=i},n.addElementaryStream=function(t){this._elementaryStreams[t]=!0},n.hasElementaryStream=function(t){return!0===this._elementaryStreams[t]},n.createInitializationVector=function(t){for(var e=new Uint8Array(16),r=12;r<16;r++)e[r]=t>>8*(15-r)&255;return e},n.setDecryptDataFromLevelKey=function(t,e){var r=t;return(null===t||void 0===t?void 0:t.method)&&t.uri&&!t.iv&&((r=new v(t.baseuri,t.reluri)).method=t.method,r.iv=this.createInitializationVector(e)),r},e=t,(r=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(o.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(t){this._url=t}},{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var t=this.sn;"number"!=typeof t&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&c.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),t=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,t)}return this._decryptdata}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Object(l.isFiniteNumber)(this.programDateTime))return null;var t=Object(l.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*t}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&m(e.prototype,r),i&&m(e,i),t}();function b(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var _=function(){function t(t){this.endCC=0,this.endSN=0,this.fragments=[],this.initSegment=null,this.live=!0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=t,this.version=null}var e,r,i;return e=t,(r=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(l.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&b(e.prototype,r),i&&b(e,i),t}(),T=/^(\d+)x(\d+)$/,E=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,S=function(){function t(e){for(var r in"string"==typeof e&&(e=t.parseAttrList(e)),e)e.hasOwnProperty(r)&&(this[r]=e[r])}var e=t.prototype;return e.decimalInteger=function(t){var e=parseInt(this[t],10);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.hexadecimalInteger=function(t){if(this[t]){var e=(this[t]||"0x").slice(2);e=(1&e.length?"0":"")+e;for(var r=new Uint8Array(e.length/2),i=0;i<e.length/2;i++)r[i]=parseInt(e.slice(2*i,2*i+2),16);return r}return null},e.hexadecimalIntegerAsNumber=function(t){var e=parseInt(this[t],16);return e>Number.MAX_SAFE_INTEGER?1/0:e},e.decimalFloatingPoint=function(t){return parseFloat(this[t])},e.enumeratedString=function(t){return this[t]},e.decimalResolution=function(t){var e=T.exec(this[t]);if(null!==e)return{width:parseInt(e[1],10),height:parseInt(e[2],10)}},t.parseAttrList=function(t){var e,r={};for(E.lastIndex=0;null!==(e=E.exec(t));){var i=e[2];0===i.indexOf('"')&&i.lastIndexOf('"')===i.length-1&&(i=i.slice(1,-1)),r[e[1]]=i}return r},t}(),w={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function k(t,e){return MediaSource.isTypeSupported((e||"video")+'/mp4;codecs="'+t+'"')}var A=/(?:#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)|#EXT-X-SESSION-DATA:([^\n\r]*)[\r\n]+)/g,C=/#EXT-X-MEDIA:(.*)/g,x=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),R=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,L=/\.(mp4|m4s|m4v|m4a)$/i,D=function(){function t(){}return t.findGroup=function(t,e){for(var r=0;r<t.length;r++){var i=t[r];if(i.id===e)return i}},t.convertAVC1ToAVCOTI=function(t){var e,r=t.split(".");return r.length>2?(e=r.shift()+".",e+=parseInt(r.shift()).toString(16),e+=("000"+parseInt(r.shift()).toString(16)).substr(-4)):e=t,e},t.resolve=function(t,e){return o.buildAbsoluteURL(e,t,{alwaysNormalize:!0})},t.parseMasterPlaylist=function(e,r){var i,n=[],a={},o=!1;function s(t,e){["video","audio"].forEach(function(r){var i=t.filter(function(t){return function(t,e){var r=w[e];return!!r&&!0===r[t.slice(0,4)]}(t,r)});if(i.length){var n=i.filter(function(t){return 0===t.lastIndexOf("avc1",0)||0===t.lastIndexOf("mp4a",0)});e[r+"Codec"]=n.length>0?n[0]:i[0],t=t.filter(function(t){return-1===i.indexOf(t)})}}),e.unknownCodecs=t}for(A.lastIndex=0;null!=(i=A.exec(e));)if(i[1]){var l={},u=l.attrs=new S(i[1]);l.url=t.resolve(i[2],r);var c=u.decimalResolution("RESOLUTION");c&&(l.width=c.width,l.height=c.height),l.bitrate=u.decimalInteger("AVERAGE-BANDWIDTH")||u.decimalInteger("BANDWIDTH"),l.name=u.NAME,s([].concat((u.CODECS||"").split(/[ ,]+/)),l),l.videoCodec&&-1!==l.videoCodec.indexOf("avc1")&&(l.videoCodec=t.convertAVC1ToAVCOTI(l.videoCodec)),n.push(l)}else if(i[3]){var h=new S(i[3]);h["DATA-ID"]&&(o=!0,a[h["DATA-ID"]]=h)}return{levels:n,sessionData:o?a:null}},t.parseMasterPlaylistMedia=function(e,r,i,n){var a;void 0===n&&(n=[]);var o=[],s=0;for(C.lastIndex=0;null!==(a=C.exec(e));){var l=new S(a[1]);if(l.TYPE===i){var u={attrs:l,id:s++,groupId:l["GROUP-ID"],instreamId:l["INSTREAM-ID"],name:l.NAME||l.LANGUAGE,type:i,default:"YES"===l.DEFAULT,autoselect:"YES"===l.AUTOSELECT,forced:"YES"===l.FORCED,lang:l.LANGUAGE};if(l.URI&&(u.url=t.resolve(l.URI,r)),n.length){var c=t.findGroup(n,u.groupId);u.audioCodec=c?c.codec:n[0].codec}o.push(u)}}return o},t.parseLevelPlaylist=function(t,e,r,i,n){var a,o,s,u=0,h=0,d=new _(e),f=0,p=null,g=new y,m=null;for(x.lastIndex=0;null!==(a=x.exec(t));){var b=a[1];if(b){g.duration=parseFloat(b);var T=(" "+a[2]).slice(1);g.title=T||null,g.tagList.push(T?["INF",b,T]:["INF",b])}else if(a[3]){if(Object(l.isFiniteNumber)(g.duration)){var E=u++;g.type=i,g.start=h,s&&(g.levelkey=s),g.sn=E,g.level=r,g.cc=f,g.urlId=n,g.baseurl=e,g.relurl=(" "+a[3]).slice(1),O(g,p),d.fragments.push(g),p=g,h+=g.duration,g=new y}}else if(a[4]){var w=(" "+a[4]).slice(1);p?g.setByteRange(w,p):g.setByteRange(w)}else if(a[5])g.rawProgramDateTime=(" "+a[5]).slice(1),g.tagList.push(["PROGRAM-DATE-TIME",g.rawProgramDateTime]),null===m&&(m=d.fragments.length);else{if(!(a=a[0].match(R))){c.logger.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<a.length&&void 0===a[o];o++);var k=(" "+a[o+1]).slice(1),A=(" "+a[o+2]).slice(1);switch(a[o]){case"#":g.tagList.push(A?[k,A]:[k]);break;case"PLAYLIST-TYPE":d.type=k.toUpperCase();break;case"MEDIA-SEQUENCE":u=d.startSN=parseInt(k);break;case"TARGETDURATION":d.targetduration=parseFloat(k);break;case"VERSION":d.version=parseInt(k);break;case"EXTM3U":break;case"ENDLIST":d.live=!1;break;case"DIS":f++,g.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":f=parseInt(k);break;case"KEY":var C=new S(k),D=C.enumeratedString("METHOD"),I=C.URI,P=C.hexadecimalInteger("IV");if("com.apple.streamingkeydelivery"===(C.KEYFORMAT||"identity")){c.logger.warn("Keyformat com.apple.streamingkeydelivery is not supported");continue}D&&(s=new v(e,I),I&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(D)>=0&&(s.method=D,s.key=null,s.iv=P));break;case"START":var M=new S(k).decimalFloatingPoint("TIME-OFFSET");Object(l.isFiniteNumber)(M)&&(d.startTimeOffset=M);break;case"MAP":var N=new S(k);g.relurl=N.URI,N.BYTERANGE&&g.setByteRange(N.BYTERANGE),g.baseurl=e,g.level=r,g.type=i,g.sn="initSegment",d.initSegment=g,(g=new y).rawProgramDateTime=d.initSegment.rawProgramDateTime;break;default:c.logger.warn("line parsed but not handled: "+a)}}}return(g=p)&&!g.relurl&&(d.fragments.pop(),h-=g.duration),d.totalduration=h,d.averagetargetduration=h/d.fragments.length,d.endSN=u-1,d.startCC=d.fragments[0]?d.fragments[0].cc:0,d.endCC=f,!d.initSegment&&d.fragments.length&&d.fragments.every(function(t){return L.test(t.relurl)})&&(c.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(g=new y).relurl=d.fragments[0].relurl,g.baseurl=e,g.level=r,g.type=i,g.sn="initSegment",d.initSegment=g,d.needSidxRanges=!0),m&&function(t,e){for(var r=t[e],i=e-1;i>=0;i--){var n=t[i];n.programDateTime=r.programDateTime-1e3*n.duration,r=n}}(d.fragments,m),d},t}();function O(t,e){t.rawProgramDateTime?t.programDateTime=Date.parse(t.rawProgramDateTime):(null===e||void 0===e?void 0:e.programDateTime)&&(t.programDateTime=e.endProgramDateTime),Object(l.isFiniteNumber)(t.programDateTime)||(t.programDateTime=null,t.rawProgramDateTime=null)}var I=window.performance,P=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING)||this).loaders={},r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i.canHaveQualityLevels=function(t){return t!==n.AUDIO_TRACK&&t!==n.SUBTITLE_TRACK},i.mapContextToLevelType=function(t){switch(t.type){case n.AUDIO_TRACK:return a.AUDIO;case n.SUBTITLE_TRACK:return a.SUBTITLE;default:return a.MAIN}},i.getResponseUrl=function(t,e){var r=t.url;return void 0!==r&&0!==r.indexOf("data:")||(r=e.url),r};var o=i.prototype;return o.createInternalLoader=function(t){var e=this.hls.config,r=e.pLoader,i=e.loader,n=new(r||i)(e);return t.loader=n,this.loaders[t.type]=n,n},o.getInternalLoader=function(t){return this.loaders[t.type]},o.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},o.destroyInternalLoaders=function(){for(var t in this.loaders){var e=this.loaders[t];e&&e.destroy(),this.resetInternalLoader(t)}},o.destroy=function(){this.destroyInternalLoaders(),t.prototype.destroy.call(this)},o.onManifestLoading=function(t){this.load({url:t.url,type:n.MANIFEST,level:0,id:null,responseType:"text"})},o.onLevelLoading=function(t){this.load({url:t.url,type:n.LEVEL,level:t.level,id:t.id,responseType:"text"})},o.onAudioTrackLoading=function(t){this.load({url:t.url,type:n.AUDIO_TRACK,level:null,id:t.id,responseType:"text"})},o.onSubtitleTrackLoading=function(t){this.load({url:t.url,type:n.SUBTITLE_TRACK,level:null,id:t.id,responseType:"text"})},o.load=function(t){var e=this.hls.config;c.logger.debug("Loading playlist of type "+t.type+", level: "+t.level+", id: "+t.id);var r,i,a,o,s=this.getInternalLoader(t);if(s){var l=s.context;if(l&&l.url===t.url)return c.logger.trace("playlist request ongoing"),!1;c.logger.warn("aborting previous loader for type: "+t.type),s.abort()}switch(t.type){case n.MANIFEST:r=e.manifestLoadingMaxRetry,i=e.manifestLoadingTimeOut,a=e.manifestLoadingRetryDelay,o=e.manifestLoadingMaxRetryTimeout;break;case n.LEVEL:r=0,o=0,a=0,i=e.levelLoadingTimeOut;break;default:r=e.levelLoadingMaxRetry,i=e.levelLoadingTimeOut,a=e.levelLoadingRetryDelay,o=e.levelLoadingMaxRetryTimeout}s=this.createInternalLoader(t);var u={timeout:i,maxRetry:r,retryDelay:a,maxRetryDelay:o},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return c.logger.debug("Calling internal loader delegate for URL: "+t.url),s.load(t,u,h),!0},o.loadsuccess=function(t,e,r,i){if(void 0===i&&(i=null),r.isSidxRequest)return this._handleSidxRequest(t,r),void this._handlePlaylistLoaded(t,e,r,i);if(this.resetInternalLoader(r.type),"string"!=typeof t.data)throw new Error('expected responseType of "text" for PlaylistLoader');var n=t.data;e.tload=I.now(),0===n.indexOf("#EXTM3U")?n.indexOf("#EXTINF:")>0||n.indexOf("#EXT-X-TARGETDURATION:")>0?this._handleTrackOrLevelPlaylist(t,e,r,i):this._handleMasterPlaylist(t,e,r,i):this._handleManifestParsingError(t,r,"no EXTM3U delimiter",i)},o.loaderror=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!1,t)},o.loadtimeout=function(t,e,r){void 0===r&&(r=null),this._handleNetworkError(e,r,!0)},o._handleMasterPlaylist=function(t,e,r,n){var a=this.hls,o=t.data,s=i.getResponseUrl(t,r),l=D.parseMasterPlaylist(o,s),h=l.levels,d=l.sessionData;if(h.length){var f=h.map(function(t){return{id:t.attrs.AUDIO,codec:t.audioCodec}}),p=D.parseMasterPlaylistMedia(o,s,"AUDIO",f),g=D.parseMasterPlaylistMedia(o,s,"SUBTITLES"),v=D.parseMasterPlaylistMedia(o,s,"CLOSED-CAPTIONS");if(p.length){var m=!1;p.forEach(function(t){t.url||(m=!0)}),!1===m&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(c.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:{},url:""}))}a.trigger(u.default.MANIFEST_LOADED,{levels:h,audioTracks:p,subtitles:g,captions:v,url:s,stats:e,networkDetails:n,sessionData:d})}else this._handleManifestParsingError(t,r,"no level found in manifest",n)},o._handleTrackOrLevelPlaylist=function(t,e,r,a){var o=this.hls,c=r.id,h=r.level,d=r.type,f=i.getResponseUrl(t,r),p=Object(l.isFiniteNumber)(c)?c:0,g=Object(l.isFiniteNumber)(h)?h:p,v=i.mapContextToLevelType(r),m=D.parseLevelPlaylist(t.data,f,g,v,p);if(m.tload=e.tload,m.fragments.length){if(d===n.MANIFEST){var y={url:f,details:m};o.trigger(u.default.MANIFEST_LOADED,{levels:[y],audioTracks:[],url:f,stats:e,networkDetails:a,sessionData:null})}if(e.tparsed=I.now(),m.needSidxRanges){var b=m.initSegment.url;this.load({url:b,isSidxRequest:!0,type:d,level:h,levelDetails:m,id:c,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"})}else r.levelDetails=m,this._handlePlaylistLoaded(t,e,r,a)}else o.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:f,reason:"no fragments found in level",level:"number"==typeof r.level?r.level:void 0})},o._handleSidxRequest=function(t,e){if("string"==typeof t.data)throw new Error("sidx request must be made with responseType of array buffer");var r=f.default.parseSegmentIndex(new Uint8Array(t.data));if(r){var i=r.references,n=e.levelDetails;i.forEach(function(t,e){var r=t.info;if(n){var i=n.fragments[e];0===i.byteRange.length&&i.setByteRange(String(1+r.end-r.start)+"@"+String(r.start))}}),n&&n.initSegment.setByteRange(String(r.moovEndOffset)+"@0")}},o._handleManifestParsingError=function(t,e,r,i){this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:t.url,reason:r,networkDetails:i})},o._handleNetworkError=function(t,e,r,i){var a,o;void 0===r&&(r=!1),void 0===i&&(i=null),c.logger.info("A network error occured while loading a "+t.type+"-type playlist");var l=this.getInternalLoader(t);switch(t.type){case n.MANIFEST:a=r?s.ErrorDetails.MANIFEST_LOAD_TIMEOUT:s.ErrorDetails.MANIFEST_LOAD_ERROR,o=!0;break;case n.LEVEL:a=r?s.ErrorDetails.LEVEL_LOAD_TIMEOUT:s.ErrorDetails.LEVEL_LOAD_ERROR,o=!1;break;case n.AUDIO_TRACK:a=r?s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,o=!1;break;default:o=!1}l&&(l.abort(),this.resetInternalLoader(t.type));var h={type:s.ErrorTypes.NETWORK_ERROR,details:a,fatal:o,url:t.url,loader:l,context:t,networkDetails:e};i&&(h.response=i),this.hls.trigger(u.default.ERROR,h)},o._handlePlaylistLoaded=function(t,e,r,a){var o=r.type,s=r.level,l=r.id,c=r.levelDetails;if(c&&c.targetduration)if(i.canHaveQualityLevels(r.type))this.hls.trigger(u.default.LEVEL_LOADED,{details:c,level:s||0,id:l||0,stats:e,networkDetails:a});else switch(o){case n.AUDIO_TRACK:this.hls.trigger(u.default.AUDIO_TRACK_LOADED,{details:c,id:l,stats:e,networkDetails:a});break;case n.SUBTITLE_TRACK:this.hls.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:c,id:l,stats:e,networkDetails:a})}else this._handleManifestParsingError(t,r,"invalid target duration",a)},i}(d);var M=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.FRAG_LOADING)||this).loaders={},r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){var e=this.loaders;for(var r in e){var i=e[r];i&&i.destroy()}this.loaders={},t.prototype.destroy.call(this)},n.onFragLoading=function(t){var e=t.frag,r=e.type,i=this.loaders,n=this.hls.config,a=n.fLoader,o=n.loader;e.loaded=0;var s,u,h,d=i[r];d&&(c.logger.warn("abort previous fragment loader for type: "+r),d.abort()),d=i[r]=e.loader=n.fLoader?new a(n):new o(n),s={url:e.url,frag:e,responseType:"arraybuffer",progressData:!1};var f=e.byteRangeStartOffset,p=e.byteRangeEndOffset;Object(l.isFiniteNumber)(f)&&Object(l.isFiniteNumber)(p)&&(s.rangeStart=f,s.rangeEnd=p),u={timeout:n.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:n.fragLoadingMaxRetryTimeout},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)},d.load(s,u,h)},n.loadsuccess=function(t,e,r,i){void 0===i&&(i=null);var n=t.data,a=r.frag;a.loader=void 0,this.loaders[a.type]=void 0,this.hls.trigger(u.default.FRAG_LOADED,{payload:n,frag:a,stats:e,networkDetails:i})},n.loaderror=function(t,e,r){void 0===r&&(r=null);var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:e.frag,response:t,networkDetails:r})},n.loadtimeout=function(t,e,r){void 0===r&&(r=null);var i=e.frag,n=i.loader;n&&n.abort(),this.loaders[i.type]=void 0,this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e.frag,networkDetails:r})},n.loadprogress=function(t,e,r,i){void 0===i&&(i=null);var n=e.frag;n.loaded=t.loaded,this.hls.trigger(u.default.FRAG_LOAD_PROGRESS,{frag:n,stats:t,networkDetails:i})},i}(d);var N=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.KEY_LOADING)||this).loaders={},r.decryptkey=null,r.decrypturl=null,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){for(var e in this.loaders){var r=this.loaders[e];r&&r.destroy()}this.loaders={},t.prototype.destroy.call(this)},n.onKeyLoading=function(t){var e=t.frag,r=e.type,i=this.loaders[r];if(e.decryptdata){var n=e.decryptdata.uri;if(n!==this.decrypturl||null===this.decryptkey){var a=this.hls.config;if(i&&(c.logger.warn("abort previous key loader for type:"+r),i.abort()),!n)return void c.logger.warn("key uri is falsy");e.loader=this.loaders[r]=new a.loader(a),this.decrypturl=n,this.decryptkey=null;var o={url:n,frag:e,responseType:"arraybuffer"},s={timeout:a.fragLoadingTimeOut,maxRetry:0,retryDelay:a.fragLoadingRetryDelay,maxRetryDelay:a.fragLoadingMaxRetryTimeout},l={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};e.loader.load(o,s,l)}else this.decryptkey&&(e.decryptdata.key=this.decryptkey,this.hls.trigger(u.default.KEY_LOADED,{frag:e}))}else c.logger.warn("Missing decryption data on fragment in onKeyLoading")},n.loadsuccess=function(t,e,r){var i=r.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(t.data),i.loader=void 0,delete this.loaders[i.type],this.hls.trigger(u.default.KEY_LOADED,{frag:i})):c.logger.error("after key load, decryptdata unset")},n.loaderror=function(t,e){var r=e.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:r,response:t})},n.loadtimeout=function(t,e){var r=e.frag,i=r.loader;i&&i.abort(),delete this.loaders[r.type],this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.NETWORK_ERROR,details:s.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:r})},i}(d);var F="NOT_LOADED",B="APPENDING",j="PARTIAL",U="OK",G=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.BUFFER_APPENDED,u.default.FRAG_BUFFERED,u.default.FRAG_LOADED)||this).bufferPadding=.2,r.fragments=Object.create(null),r.timeRanges=Object.create(null),r.config=e.config,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.config=null,d.prototype.destroy.call(this),t.prototype.destroy.call(this)},n.getBufferedFrag=function(t,e){var r=this.fragments,i=Object.keys(r).filter(function(i){var n=r[i];if(n.body.type!==e)return!1;if(!n.buffered)return!1;var a=n.body;return a.startPTS<=t&&t<=a.endPTS});if(0===i.length)return null;var n=i.pop();return r[n].body},n.detectEvictedFragments=function(t,e){var r=this;Object.keys(this.fragments).forEach(function(i){var n=r.fragments[i];if(n&&n.buffered){var a=n.range[t];if(a)for(var o=a.time,s=0;s<o.length;s++){var l=o[s];if(!r.isTimeBuffered(l.startPTS,l.endPTS,e)){r.removeFragment(n.body);break}}}})},n.detectPartialFragments=function(t){var e=this,r=this.getFragmentKey(t),i=this.fragments[r];i&&(i.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){if(t.hasElementaryStream(r)){var n=e.timeRanges[r];i.range[r]=e.getBufferedTimes(t.startPTS,t.endPTS,n)}}))},n.getBufferedTimes=function(t,e,r){for(var i,n,a=[],o=!1,s=0;s<r.length;s++){if(i=r.start(s)-this.bufferPadding,n=r.end(s)+this.bufferPadding,t>=i&&e<=n){a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))});break}if(t<n&&e>i)a.push({startPTS:Math.max(t,r.start(s)),endPTS:Math.min(e,r.end(s))}),o=!0;else if(e<=i)break}return{time:a,partial:o}},n.getFragmentKey=function(t){return t.type+"_"+t.level+"_"+t.urlId+"_"+t.sn},n.getPartialFragment=function(t){var e,r,i,n=this,a=null,o=0;return Object.keys(this.fragments).forEach(function(s){var l=n.fragments[s];n.isPartial(l)&&(r=l.body.startPTS-n.bufferPadding,i=l.body.endPTS+n.bufferPadding,t>=r&&t<=i&&(e=Math.min(t-r,i-t),o<=e&&(a=l.body,o=e)))}),a},n.getState=function(t){var e=this.getFragmentKey(t),r=this.fragments[e],i=F;return void 0!==r&&(i=r.buffered?!0===this.isPartial(r)?j:U:B),i},n.isPartial=function(t){return!0===t.buffered&&(void 0!==t.range.video&&!0===t.range.video.partial||void 0!==t.range.audio&&!0===t.range.audio.partial)},n.isTimeBuffered=function(t,e,r){for(var i,n,a=0;a<r.length;a++){if(i=r.start(a)-this.bufferPadding,n=r.end(a)+this.bufferPadding,t>=i&&e<=n)return!0;if(e<=i)return!1}return!1},n.onFragLoaded=function(t){var e=t.frag;Object(l.isFiniteNumber)(e.sn)&&!e.bitrateTest&&(this.fragments[this.getFragmentKey(e)]={body:e,range:Object.create(null),buffered:!1})},n.onBufferAppended=function(t){var e=this;this.timeRanges=t.timeRanges,Object.keys(this.timeRanges).forEach(function(t){var r=e.timeRanges[t];e.detectEvictedFragments(t,r)})},n.onFragBuffered=function(t){this.detectPartialFragments(t.frag)},n.hasFragment=function(t){var e=this.getFragmentKey(t);return void 0!==this.fragments[e]},n.removeFragment=function(t){var e=this.getFragmentKey(t);delete this.fragments[e]},n.removeAllFragments=function(){this.fragments=Object.create(null)},i}(d),H={search:function(t,e){for(var r=0,i=t.length-1,n=null,a=null;r<=i;){var o=e(a=t[n=(r+i)/2|0]);if(o>0)r=n+1;else{if(!(o<0))return a;i=n-1}}return null}},V=function(){function t(){}return t.isBuffered=function(t,e){try{if(t)for(var r=t.buffered,i=0;i<r.length;i++)if(e>=r.start(i)&&e<=r.end(i))return!0}catch(t){}return!1},t.bufferInfo=function(t,e,r){try{if(t){var i,n=t.buffered,a=[];for(i=0;i<n.length;i++)a.push({start:n.start(i),end:n.end(i)});return this.bufferedInfo(a,e,r)}}catch(t){}return{len:0,start:e,end:e,nextStart:void 0}},t.bufferedInfo=function(t,e,r){t.sort(function(t,e){var r=t.start-e.start;return r||e.end-t.end});var i=[];if(r)for(var n=0;n<t.length;n++){var a=i.length;if(a){var o=i[a-1].end;t[n].start-o<r?t[n].end>o&&(i[a-1].end=t[n].end):i.push(t[n])}else i.push(t[n])}else i=t;for(var s,l=0,u=e,c=e,h=0;h<i.length;h++){var d=i[h].start,f=i[h].end;if(e+r>=d&&e<f)u=d,l=(c=f)-e;else if(e+r<d){s=d;break}}return{len:l,start:u,end:c,nextStart:s}},t}(),K=r("./node_modules/eventemitter3/index.js"),W=r("./node_modules/webworkify-webpack/index.js"),z=r("./src/demux/demuxer-inline.js");function q(){return window.MediaSource||window.WebKitMediaSource}var Y=r("./src/utils/get-self-scope.js");var X=function(t){var e,r;function i(){return t.apply(this,arguments)||this}return r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i.prototype.trigger=function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];this.emit.apply(this,[t,t].concat(r))},i}(K.EventEmitter),$=Object(Y.getSelfScope)(),J=q()||{isTypeSupported:function(){return!1}},Q=function(){function t(t,e){var r=this;this.hls=t,this.id=e;var i=this.observer=new X,n=t.config,a=function(e,i){(i=i||{}).frag=r.frag,i.id=r.id,t.trigger(e,i)};i.on(u.default.FRAG_DECRYPTED,a),i.on(u.default.FRAG_PARSING_INIT_SEGMENT,a),i.on(u.default.FRAG_PARSING_DATA,a),i.on(u.default.FRAG_PARSED,a),i.on(u.default.ERROR,a),i.on(u.default.FRAG_PARSING_METADATA,a),i.on(u.default.FRAG_PARSING_USERDATA,a),i.on(u.default.INIT_PTS_FOUND,a);var o={mp4:J.isTypeSupported("video/mp4"),mpeg:J.isTypeSupported("audio/mpeg"),mp3:J.isTypeSupported('audio/mp4; codecs="mp3"')},l=navigator.vendor;if(n.enableWorker&&"undefined"!=typeof Worker){var h;c.logger.log("demuxing in webworker");try{h=this.w=W(/*! ../demux/demuxer-worker.js */"./src/demux/demuxer-worker.js"),this.onwmsg=this.onWorkerMessage.bind(this),h.addEventListener("message",this.onwmsg),h.onerror=function(e){t.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:e.message+" ("+e.filename+":"+e.lineno+")"}})},h.postMessage({cmd:"init",typeSupported:o,vendor:l,id:e,config:JSON.stringify(n)})}catch(t){c.logger.warn("Error in worker:",t),c.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline"),h&&$.URL.revokeObjectURL(h.objectURL),this.demuxer=new z.default(i,o,n,l),this.w=void 0}}else this.demuxer=new z.default(i,o,n,l)}var e=t.prototype;return e.destroy=function(){var t=this.w;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.w=null;else{var e=this.demuxer;e&&(e.destroy(),this.demuxer=null)}var r=this.observer;r&&(r.removeAllListeners(),this.observer=null)},e.push=function(t,e,r,i,n,a,o,s){var u=this.w,h=Object(l.isFiniteNumber)(n.startPTS)?n.startPTS:n.start,d=n.decryptdata,f=this.frag,p=!(f&&n.cc===f.cc),g=!(f&&n.level===f.level),v=f&&n.sn===f.sn+1,m=!g&&v;if(p&&c.logger.log(this.id+":discontinuity detected"),g&&c.logger.log(this.id+":switch detected"),this.frag=n,u)u.postMessage({cmd:"demux",data:t,decryptdata:d,initSegment:e,audioCodec:r,videoCodec:i,timeOffset:h,discontinuity:p,trackSwitch:g,contiguous:m,duration:a,accurateTimeOffset:o,defaultInitPTS:s},t instanceof ArrayBuffer?[t]:[]);else{var y=this.demuxer;y&&y.push(t,d,e,r,i,h,p,g,m,a,o,s)}},e.onWorkerMessage=function(t){var e=t.data,r=this.hls;switch(e.event){case"init":$.URL.revokeObjectURL(this.w.objectURL);break;case u.default.FRAG_PARSING_DATA:e.data.data1=new Uint8Array(e.data1),e.data2&&(e.data.data2=new Uint8Array(e.data2));default:e.data=e.data||{},e.data.frag=this.frag,e.data.id=this.id,r.trigger(e.event,e.data)}},t}();function Z(t,e,r){switch(e){case"audio":t.audioGroupIds||(t.audioGroupIds=[]),t.audioGroupIds.push(r);break;case"text":t.textGroupIds||(t.textGroupIds=[]),t.textGroupIds.push(r)}}function tt(t,e,r){var i=t[e],n=t[r],a=n.startPTS;Object(l.isFiniteNumber)(a)?r>e?(i.duration=a-i.start,i.duration<0&&c.logger.warn("negative duration computed for frag "+i.sn+",level "+i.level+", there should be some duration drift between playlist and fragment!")):(n.duration=i.start-a,n.duration<0&&c.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=r>e?i.start+(i.minEndPTS?i.minEndPTS-i.start:i.duration):Math.max(i.start-n.duration,0)}function et(t,e,r,i,n,a){var o=r,s=i;if(Object(l.isFiniteNumber)(e.startPTS)){var u=Math.abs(e.startPTS-r);Object(l.isFiniteNumber)(e.deltaPTS)?e.deltaPTS=Math.max(u,e.deltaPTS):e.deltaPTS=u,o=Math.max(r,e.startPTS),r=Math.min(r,e.startPTS),s=Math.min(i,e.endPTS),i=Math.max(i,e.endPTS),n=Math.min(n,e.startDTS),a=Math.max(a,e.endDTS)}var c=r-e.start;e.start=e.startPTS=r,e.maxStartPTS=o,e.endPTS=i,e.minEndPTS=s,e.startDTS=n,e.endDTS=a,e.duration=i-r;var h,d,f,p=e.sn;if(!t||p<t.startSN||p>t.endSN)return 0;for(h=p-t.startSN,(d=t.fragments)[h]=e,f=h;f>0;f--)tt(d,f,f-1);for(f=h;f<d.length-1;f++)tt(d,f,f+1);return t.PTSKnown=!0,c}function rt(t,e){e.initSegment&&t.initSegment&&(e.initSegment=t.initSegment);var r,i=0;if(it(t,e,function(t,n){i=t.cc-n.cc,Object(l.isFiniteNumber)(t.startPTS)&&(n.start=n.startPTS=t.startPTS,n.endPTS=t.endPTS,n.duration=t.duration,n.backtracked=t.backtracked,n.dropped=t.dropped,r=n),e.PTSKnown=!0}),e.PTSKnown){if(i){c.logger.log("discontinuity sliding from playlist, take drift into account");for(var n=e.fragments,a=0;a<n.length;a++)n[a].cc+=i}r?et(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):function(t,e){var r=e.startSN-t.startSN,i=t.fragments,n=e.fragments;if(r<0||r>i.length)return;for(var a=0;a<n.length;a++)n[a].start+=i[r].start}(t,e),e.PTSKnown=t.PTSKnown}}function it(t,e,r){if(t&&e)for(var i=Math.max(t.startSN,e.startSN)-e.startSN,n=Math.min(t.endSN,e.endSN)-e.startSN,a=e.startSN-t.startSN,o=i;o<=n;o++){var s=t.fragments[a+o],l=e.fragments[o];if(!s||!l)break;r(s,l,o)}}function nt(t,e,r){var i=1e3*(e.averagetargetduration?e.averagetargetduration:e.targetduration),n=i/2;return t&&e.endSN===t.endSN&&(i=n),r&&(i=Math.max(n,i-(window.performance.now()-r))),Math.round(i)}var at={toString:function(t){for(var e="",r=t.length,i=0;i<r;i++)e+="["+t.start(i).toFixed(3)+","+t.end(i).toFixed(3)+"]";return e}};function ot(t,e){e.fragments.forEach(function(e){if(e){var r=e.start+t;e.start=e.startPTS=r,e.endPTS=r+e.duration}}),e.PTSKnown=!0}function st(t,e,r){!function(t,e,r){if(function(t,e,r){var i=!1;return e&&e.details&&r&&(r.endCC>r.startCC||t&&t.cc<r.startCC)&&(i=!0),i}(t,r,e)){var i=function(t,e){var r=t.fragments,i=e.fragments;if(i.length&&r.length){var n=function(t,e){for(var r=null,i=0;i<t.length;i+=1){var n=t[i];if(n&&n.cc===e){r=n;break}}return r}(r,i[0].cc);if(n&&(!n||n.startPTS))return n;c.logger.log("No frag in previous level to align on")}else c.logger.log("No fragments to align")}(r.details,e);i&&(c.logger.log("Adjusting PTS using last level due to CC increase within current level"),ot(i.start,e))}}(t,r,e),!r.PTSKnown&&e&&function(t,e){if(e&&e.fragments.length){if(!t.hasProgramDateTime||!e.hasProgramDateTime)return;var r=e.fragments[0].programDateTime,i=t.fragments[0].programDateTime,n=(i-r)/1e3+e.fragments[0].start;Object(l.isFiniteNumber)(n)&&(c.logger.log("adjusting PTS using programDateTime delta, sliding:"+n.toFixed(3)),ot(n,t))}}(r,e.details)}function lt(t,e,r){if(null===e||!Array.isArray(t)||!t.length||!Object(l.isFiniteNumber)(e))return null;if(e<(t[0].programDateTime||0))return null;if(e>=(t[t.length-1].endProgramDateTime||0))return null;r=r||0;for(var i=0;i<t.length;++i){var n=t[i];if(ht(e,r,n))return n}return null}function ut(t,e,r,i){void 0===r&&(r=0),void 0===i&&(i=0);var n=null;if(t?n=e[t.sn-e[0].sn+1]:0===r&&0===e[0].start&&(n=e[0]),n&&0===ct(r,i,n))return n;var a=H.search(e,ct.bind(null,r,i));return a||n}function ct(t,e,r){void 0===t&&(t=0),void 0===e&&(e=0);var i=Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-i<=t?1:r.start-i>t&&r.start?-1:0}function ht(t,e,r){var i=1e3*Math.min(e,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-i>t}var dt=function(){function t(t,e,r,i){this.config=t,this.media=e,this.fragmentTracker=r,this.hls=i,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1}var e=t.prototype;return e.poll=function(t){var e=this.config,r=this.media,i=this.stalled,n=r.currentTime,a=r.seeking,o=this.seeking&&!a,s=!this.seeking&&a;if(this.seeking=a,n===t){if((s||o)&&(this.stalled=null),!r.paused&&!r.ended&&0!==r.playbackRate&&r.buffered.length){var l=V.bufferInfo(r,n,0),u=l.len>0,h=l.nextStart||0;if(u||h){if(a){var d=l.len>2,f=!h||h-n>2&&!this.fragmentTracker.getPartialFragment(n);if(d||f)return;this.moved=!1}if(!this.moved&&this.stalled){var p=Math.max(h,l.start||0)-n;if(p>0&&p<=2)return void this._trySkipBufferHole(null)}var g=self.performance.now();if(null!==i){var v=g-i;!a&&v>=250&&this._reportStall(l.len);var m=V.bufferInfo(r,n,e.maxBufferHole);this._tryFixBufferStall(m,v)}else this.stalled=g}}}else if(this.moved=!0,null!==i){if(this.stallReported){var y=self.performance.now()-i;c.logger.warn("playback not stuck anymore @"+n+", after "+Math.round(y)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}},e._tryFixBufferStall=function(t,e){var r=this.config,i=this.fragmentTracker,n=this.media.currentTime,a=i.getPartialFragment(n);if(a&&this._trySkipBufferHole(a))return;t.len>r.maxBufferHole&&e>1e3*r.highBufferWatchdogPeriod&&(c.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},e._reportStall=function(t){var e=this.hls,r=this.media;this.stallReported||(this.stallReported=!0,c.logger.warn("Playback stalling at @"+r.currentTime+" due to low buffer (buffer="+t+")"),e.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t}))},e._trySkipBufferHole=function(t){for(var e=this.config,r=this.hls,i=this.media,n=i.currentTime,a=0,o=0;o<i.buffered.length;o++){var l=i.buffered.start(o);if(n+e.maxBufferHole>=a&&n<l){var h=Math.max(l+.05,i.currentTime+.1);return c.logger.warn("skipping hole, adjusting currentTime from "+n+" to "+h),this.moved=!0,this.stalled=null,i.currentTime=h,t&&r.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+n+" to "+h,frag:t}),h}a=i.buffered.end(o)}return 0},e._tryNudgeBuffer=function(){var t=this.config,e=this.hls,r=this.media,i=r.currentTime,n=(this.nudgeRetry||0)+1;if(this.nudgeRetry=n,n<t.nudgeMaxRetry){var a=i+n*t.nudgeOffset;c.logger.warn("Nudging 'currentTime' from "+i+" to "+a),r.currentTime=a,e.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else c.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+t.nudgeMaxRetry+" nudges"),e.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},t}();var ft=function(t){var e,r;function i(e){for(var r,i=arguments.length,n=new Array(i>1?i-1:0),a=1;a<i;a++)n[a-1]=arguments[a];return(r=t.call.apply(t,[this,e].concat(n))||this)._boundTick=void 0,r._tickTimer=null,r._tickInterval=null,r._tickCallCount=0,r._boundTick=r.tick.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},n.hasInterval=function(){return!!this._tickInterval},n.hasNextTick=function(){return!!this._tickTimer},n.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},n.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},n.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},n.tick=function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},n.doTick=function(){},i}(d);var pt={STOPPED:"STOPPED",STARTING:"STARTING",IDLE:"IDLE",PAUSED:"PAUSED",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BUFFER_FLUSHING:"BUFFER_FLUSHING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},gt=function(t){var e,r;function i(){return t.apply(this,arguments)||this}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.doTick=function(){},n.startLoad=function(){},n.stopLoad=function(){var t=this.fragCurrent;t&&(t.loader&&t.loader.abort(),this.fragmentTracker.removeFragment(t)),this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=pt.STOPPED},n._streamEnded=function(t,e){var r=this.fragCurrent,i=this.fragmentTracker;if(!e.live&&r&&!r.backtracked&&r.sn===e.endSN&&!t.nextStart){var n=i.getState(r);return n===j||n===U}return!1},n.onMediaSeeking=function(){var t=this.config,e=this.media,r=this.mediaBuffer,i=this.state,n=e?e.currentTime:null,a=V.bufferInfo(r||e,n,this.config.maxBufferHole);if(c.logger.log("media seeking to "+(Object(l.isFiniteNumber)(n)?n.toFixed(3):n)),i===pt.FRAG_LOADING){var o=this.fragCurrent;if(0===a.len&&o){var s=t.maxFragLookUpTolerance,u=o.start-s,h=o.start+o.duration+s;n<u||n>h?(o.loader&&(c.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=pt.IDLE):c.logger.log("seeking outside of buffer but within currently loaded fragment range")}}else i===pt.ENDED&&(0===a.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=pt.IDLE);e&&(this.lastCurrentTime=n),this.loadedmetadata||(this.nextLoadPosition=this.startPosition=n),this.tick()},n.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},n.onHandlerDestroying=function(){this.stopLoad(),t.prototype.onHandlerDestroying.call(this)},n.onHandlerDestroyed=function(){this.state=pt.STOPPED,this.fragmentTracker=null},n.computeLivePosition=function(t,e){var r=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*e.targetduration;return t+Math.max(0,e.totalduration-r)},i}(ft);function vt(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var mt,yt=function(t){var e,r;function i(e,r){var i;return(i=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.LEVEL_LOADED,u.default.LEVELS_UPDATED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_LOAD_EMERGENCY_ABORTED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_SWITCHED,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED)||this).fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=pt.STOPPED,i.stallReported=!1,i.gapController=null,i.altAudio=!1,i.audioOnly=!1,i.bitrateTest=!1,i}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,o,h,d=i.prototype;return d.startLoad=function(t){if(this.levels){var e=this.lastCurrentTime,r=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var i=r.startLevel;-1===i&&(r.config.testBandwidth?(i=0,this.bitrateTest=!0):i=r.nextAutoLevel),this.level=r.nextLoadLevel=i,this.loadedmetadata=!1}e>0&&-1===t&&(c.logger.log("override startPosition with lastCurrentTime @"+e.toFixed(3)),t=e),this.state=pt.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=t,this.tick()}else this.forceStartLoad=!0,this.state=pt.STOPPED},d.stopLoad=function(){this.forceStartLoad=!1,t.prototype.stopLoad.call(this)},d.doTick=function(){switch(this.state){case pt.BUFFER_FLUSHING:this.fragLoadError=0;break;case pt.IDLE:this._doTickIdle();break;case pt.WAITING_LEVEL:var t=this.levels[this.level];t&&t.details&&(this.state=pt.IDLE);break;case pt.FRAG_LOADING_WAITING_RETRY:var e=window.performance.now(),r=this.retryDate;(!r||e>=r||this.media&&this.media.seeking)&&(c.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=pt.IDLE);break;case pt.ERROR:case pt.STOPPED:case pt.FRAG_LOADING:case pt.PARSING:case pt.PARSED:case pt.ENDED:}this._checkBuffer(),this._checkFragmentChanged()},d._doTickIdle=function(){var t=this.hls,e=t.config,r=this.media;if(void 0!==this.levelLastLoaded&&(r||!this.startFragRequested&&e.startFragPrefetch))if(this.altAudio&&this.audioOnly)this.demuxer.frag=null;else{var i;i=this.loadedmetadata?r.currentTime:this.nextLoadPosition;var n=t.nextLoadLevel,a=this.levels[n];if(a){var o,s=a.bitrate;o=s?Math.max(8*e.maxBufferSize/s,e.maxBufferLength):e.maxBufferLength,o=Math.min(o,e.maxMaxBufferLength);var l=i<e.maxBufferHole?Math.max(2,e.maxBufferHole):e.maxBufferHole,h=V.bufferInfo(this.mediaBuffer?this.mediaBuffer:r,i,l),d=h.len;if(!(d>=o)){c.logger.trace("buffer length of "+d.toFixed(3)+" is below max of "+o.toFixed(3)+". checking for more payload ..."),this.level=t.nextLoadLevel=n;var f=a.details;if(!f||f.live&&this.levelLastLoaded!==n)this.state=pt.WAITING_LEVEL;else{if(this._streamEnded(h,f)){var p={};return this.altAudio&&(p.type="video"),this.hls.trigger(u.default.BUFFER_EOS,p),void(this.state=pt.ENDED)}this._fetchPayloadOrEos(i,h,f)}}}}},d._fetchPayloadOrEos=function(t,e,r){var i=this.fragPrevious,n=(this.level,r.fragments),a=n.length;if(0!==a){var o,s=n[0].start,l=n[a-1].start+n[a-1].duration,u=e.end;if(r.initSegment&&!r.initSegment.data)o=r.initSegment;else if(r.live){var h=this.config.initialLiveManifestSize;if(a<h)return void c.logger.warn("Can not start playback of a level, reason: not enough fragments "+a+" < "+h);if(null===(o=this._ensureFragmentAtLivePoint(r,u,s,l,i,n)))return}else u<s&&(o=n[0]);o||(o=this._findFragment(s,i,a,n,u,l,r)),o&&(o.encrypted?this._loadKey(o,r):this._loadFragment(o,r,t,u))}},d._ensureFragmentAtLivePoint=function(t,e,r,i,n,a){var o,s=this.hls.config,u=this.media,h=1/0;if(void 0!==s.liveMaxLatencyDuration?h=s.liveMaxLatencyDuration:Object(l.isFiniteNumber)(s.liveMaxLatencyDurationCount)&&(h=s.liveMaxLatencyDurationCount*t.targetduration),e<Math.max(r-s.maxFragLookUpTolerance,i-h)){var d=this.liveSyncPosition=this.computeLivePosition(r,t);e=d,u&&!u.paused&&u.readyState&&u.duration>d&&d>u.currentTime&&(c.logger.log("buffer end: "+e.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+d.toFixed(3)),u.currentTime=d),this.nextLoadPosition=d}if(t.PTSKnown&&e>i&&u&&u.readyState)return null;if(this.startFragRequested&&!t.PTSKnown&&n)if(t.hasProgramDateTime)c.logger.log("live playlist, switching playlist, load frag with same PDT: "+n.programDateTime),o=lt(a,n.endProgramDateTime,s.maxFragLookUpTolerance);else{var f=n.sn+1;if(f>=t.startSN&&f<=t.endSN){var p=a[f-t.startSN];n.cc===p.cc&&(o=p,c.logger.log("live playlist, switching playlist, load frag with next SN: "+o.sn))}o||(o=H.search(a,function(t){return n.cc-t.cc}))&&c.logger.log("live playlist, switching playlist, load frag with same CC: "+o.sn)}return o},d._findFragment=function(t,e,r,i,n,a,o){var s,l=this.hls.config;n<a?s=ut(e,i,n,n>a-l.maxFragLookUpTolerance?0:l.maxFragLookUpTolerance):s=i[r-1];if(s){var u=s.sn-o.startSN,h=e&&s.level===e.level,d=i[u-1],f=i[u+1];if(e&&s.sn===e.sn)if(h&&!s.backtracked)if(s.sn<o.endSN){var p=e.deltaPTS;p&&p>l.maxBufferHole&&e.dropped&&u?(s=d,c.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):(s=f,c.logger.log("Re-loading fragment with SN: "+s.sn))}else s=null;else s.backtracked&&(f&&f.backtracked?(c.logger.warn("Already backtracked from fragment "+f.sn+", will not backtrack to fragment "+s.sn+". Loading fragment "+f.sn),s=f):(c.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),s.dropped=0,d?(s=d).backtracked=!0:u&&(s=null)))}return s},d._loadKey=function(t,e){c.logger.log("Loading key for "+t.sn+" of ["+e.startSN+" ,"+e.endSN+"],level "+this.level),this.state=pt.KEY_LOADING,this.hls.trigger(u.default.KEY_LOADING,{frag:t})},d._loadFragment=function(t,e,r,i){var n=this.fragmentTracker.getState(t);this.fragCurrent=t,"initSegment"!==t.sn&&(this.startFragRequested=!0),Object(l.isFiniteNumber)(t.sn)&&!t.bitrateTest&&(this.nextLoadPosition=t.start+t.duration),t.backtracked||n===F||n===j?(t.autoLevel=this.hls.autoLevelEnabled,t.bitrateTest=this.bitrateTest,c.logger.log("Loading "+t.sn+" of ["+e.startSN+" ,"+e.endSN+"],level "+this.level+", currentTime:"+r.toFixed(3)+",bufferEnd:"+i.toFixed(3)),this.hls.trigger(u.default.FRAG_LOADING,{frag:t}),this.demuxer||(this.demuxer=new Q(this.hls,"main")),this.state=pt.FRAG_LOADING):n===B&&this._reduceMaxBufferLength(t.duration)&&this.fragmentTracker.removeFragment(t)},d.getBufferedFrag=function(t){return this.fragmentTracker.getBufferedFrag(t,a.MAIN)},d.followingBufferedFrag=function(t){return t?this.getBufferedFrag(t.endPTS+.5):null},d._checkFragmentChanged=function(){var t,e,r=this.media;if(r&&r.readyState&&!1===r.seeking&&((e=r.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=e),V.isBuffered(r,e)?t=this.getBufferedFrag(e):V.isBuffered(r,e+.1)&&(t=this.getBufferedFrag(e+.1)),t)){var i=t;if(i!==this.fragPlaying){this.hls.trigger(u.default.FRAG_CHANGED,{frag:i});var n=i.level;this.fragPlaying&&this.fragPlaying.level===n||this.hls.trigger(u.default.LEVEL_SWITCHED,{level:n}),this.fragPlaying=i}}},d.immediateLevelSwitch=function(){if(c.logger.log("immediateLevelSwitch"),!this.immediateSwitch){this.immediateSwitch=!0;var t,e=this.media;e?(t=e.paused,e.pause()):t=!0,this.previouslyPaused=t}var r=this.fragCurrent;r&&r.loader&&r.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},d.immediateLevelSwitchEnd=function(){var t=this.media;t&&t.buffered.length&&(this.immediateSwitch=!1,V.isBuffered(t,t.currentTime)&&(t.currentTime-=1e-4),this.previouslyPaused||t.play())},d.nextLevelSwitch=function(){var t=this.media;if(t&&t.readyState){var e,r=this.getBufferedFrag(t.currentTime);if(r&&r.startPTS>1&&this.flushMainBuffer(0,r.startPTS-1),t.paused)e=0;else{var i=this.hls.nextLoadLevel,n=this.levels[i],a=this.fragLastKbps;e=a&&this.fragCurrent?this.fragCurrent.duration*n.bitrate/(1e3*a)+1:0}var o=this.getBufferedFrag(t.currentTime+e);if(o){var s=this.followingBufferedFrag(o);if(s){var l=this.fragCurrent;l&&l.loader&&l.loader.abort(),this.fragCurrent=null;var u=Math.max(o.endPTS,s.maxStartPTS+Math.min(this.config.maxFragLookUpTolerance,s.duration));this.flushMainBuffer(u,Number.POSITIVE_INFINITY)}}}},d.flushMainBuffer=function(t,e){this.state=pt.BUFFER_FLUSHING;var r={startOffset:t,endOffset:e};this.altAudio&&(r.type="video"),this.hls.trigger(u.default.BUFFER_FLUSHING,r)},d.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("seeked",this.onvseeked),e.addEventListener("ended",this.onvended);var r=this.config;this.levels&&r.autoStartLoad&&this.hls.startLoad(r.startPosition),this.gapController=new dt(r,e,this.fragmentTracker,this.hls)},d.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(c.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);var e=this.levels;e&&e.forEach(function(t){t.details&&t.details.fragments.forEach(function(t){t.backtracked=void 0})}),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("seeked",this.onvseeked),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.fragmentTracker.removeAllFragments(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.stopLoad()},d.onMediaSeeked=function(){var t=this.media,e=t?t.currentTime:void 0;Object(l.isFiniteNumber)(e)&&c.logger.log("media seeked to "+e.toFixed(3)),this.tick()},d.onManifestLoading=function(){c.logger.log("trigger BUFFER_RESET"),this.hls.trigger(u.default.BUFFER_RESET),this.fragmentTracker.removeAllFragments(),this.stalled=!1,this.startPosition=this.lastCurrentTime=0},d.onManifestParsed=function(t){var e,r=!1,i=!1;t.levels.forEach(function(t){(e=t.audioCodec)&&(-1!==e.indexOf("mp4a.40.2")&&(r=!0),-1!==e.indexOf("mp4a.40.5")&&(i=!0))}),this.audioCodecSwitch=r&&i,this.audioCodecSwitch&&c.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=t.altAudio,this.levels=t.levels,this.startFragRequested=!1;var n=this.config;(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},d.onLevelLoaded=function(t){var e=t.details,r=t.level,i=this.levels[this.levelLastLoaded],n=this.levels[r],a=e.totalduration,o=0;if(c.logger.log("level "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+a),e.live){var s=n.details;s&&e.fragments.length>0?(rt(s,e),o=e.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(o,s),e.PTSKnown&&Object(l.isFiniteNumber)(o)?c.logger.log("live playlist sliding:"+o.toFixed(3)):(c.logger.log("live playlist - outdated PTS, unknown sliding"),st(this.fragPrevious,i,e))):(c.logger.log("live playlist - first load, unknown sliding"),e.PTSKnown=!1,st(this.fragPrevious,i,e))}else e.PTSKnown=!1;if(n.details=e,this.levelLastLoaded=r,this.hls.trigger(u.default.LEVEL_UPDATED,{details:e,level:r}),!1===this.startFragRequested){if(-1===this.startPosition||-1===this.lastCurrentTime){var h=e.startTimeOffset;Object(l.isFiniteNumber)(h)?(h<0&&(c.logger.log("negative start time offset "+h+", count from end of last fragment"),h=o+a+h),c.logger.log("start time offset found in playlist, adjust startPosition to "+h),this.startPosition=h):e.live?(this.startPosition=this.computeLivePosition(o,e),c.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition}this.nextLoadPosition=this.startPosition}this.state===pt.WAITING_LEVEL&&(this.state=pt.IDLE),this.tick()},d.onKeyLoaded=function(){this.state===pt.KEY_LOADING&&(this.state=pt.IDLE,this.tick())},d.onFragLoaded=function(t){var e=this.fragCurrent,r=this.hls,i=this.levels,n=this.media,a=t.frag;if(this.state===pt.FRAG_LOADING&&e&&"main"===a.type&&a.level===e.level&&a.sn===e.sn){var o=t.stats,s=i[e.level],l=s.details;if(this.bitrateTest=!1,this.stats=o,c.logger.log("Loaded "+e.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+e.level),a.bitrateTest&&r.nextLoadLevel)this.state=pt.IDLE,this.startFragRequested=!1,o.tparsed=o.tbuffered=window.performance.now(),r.trigger(u.default.FRAG_BUFFERED,{stats:o,frag:e,id:"main"}),this.tick();else if("initSegment"===a.sn)this.state=pt.IDLE,o.tparsed=o.tbuffered=window.performance.now(),l.initSegment.data=t.payload,r.trigger(u.default.FRAG_BUFFERED,{stats:o,frag:e,id:"main"}),this.tick();else{c.logger.log("Parsing "+e.sn+" of ["+l.startSN+" ,"+l.endSN+"],level "+e.level+", cc "+e.cc),this.state=pt.PARSING,this.pendingBuffering=!0,this.appended=!1,a.bitrateTest&&(a.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:a}));var h=!(n&&n.seeking)&&(l.PTSKnown||!l.live),d=l.initSegment?l.initSegment.data:[],f=this._getAudioCodec(s);(this.demuxer=this.demuxer||new Q(this.hls,"main")).push(t.payload,d,f,s.videoCodec,e,l.totalduration,h)}}this.fragLoadError=0},d.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===pt.PARSING){var i,n,a=t.tracks;if(this.audioOnly=a.audio&&!a.video,this.altAudio&&!this.audioOnly&&delete a.audio,n=a.audio){var o=this.levels[this.level].audioCodec,s=navigator.userAgent.toLowerCase();o&&this.audioCodecSwap&&(c.logger.log("swapping playlist audio codec"),o=-1!==o.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==n.metadata.channelCount&&-1===s.indexOf("firefox")&&(o="mp4a.40.5"),-1!==s.indexOf("android")&&"audio/mpeg"!==n.container&&(o="mp4a.40.2",c.logger.log("Android: force audio codec to "+o)),n.levelCodec=o,n.id=t.id}for(i in(n=a.video)&&(n.levelCodec=this.levels[this.level].videoCodec,n.id=t.id),this.hls.trigger(u.default.BUFFER_CODECS,a),a){n=a[i],c.logger.log("main track:"+i+",container:"+n.container+",codecs[level/parsed]=["+n.levelCodec+"/"+n.codec+"]");var l=n.initSegment;l&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,{type:i,data:l,parent:"main",content:"initSegment"}))}this.tick()}},d.onFragParsingData=function(t){var e=this,r=this.fragCurrent,i=t.frag;if(r&&"main"===t.id&&i.sn===r.sn&&i.level===r.level&&("audio"!==t.type||!this.altAudio)&&this.state===pt.PARSING){var n=this.levels[this.level],a=r;if(Object(l.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),!0===t.hasAudio&&a.addElementaryStream(g.AUDIO),!0===t.hasVideo&&a.addElementaryStream(g.VIDEO),c.logger.log("Parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb+",dropped:"+(t.dropped||0)),"video"===t.type)if(a.dropped=t.dropped,a.dropped)if(a.backtracked)c.logger.warn("Already backtracked on this fragment, appending with the gap",a.sn);else{var o=n.details;if(!o||a.sn!==o.startSN)return c.logger.warn("missing video frame(s), backtracking fragment",a.sn),this.fragmentTracker.removeFragment(a),a.backtracked=!0,this.nextLoadPosition=t.startPTS,this.state=pt.IDLE,this.fragPrevious=a,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),void this.tick();c.logger.warn("missing video frame(s) on first frag, appending with gap",a.sn)}else a.backtracked=!1;var s=et(n.details,a,t.startPTS,t.endPTS,t.startDTS,t.endDTS),h=this.hls;h.trigger(u.default.LEVEL_PTS_UPDATED,{details:n.details,level:this.level,drift:s,type:t.type,start:t.startPTS,end:t.endPTS}),[t.data1,t.data2].forEach(function(r){r&&r.length&&e.state===pt.PARSING&&(e.appended=!0,e.pendingBuffering=!0,h.trigger(u.default.BUFFER_APPENDING,{type:t.type,data:r,parent:"main",content:"data"}))}),this.tick()}},d.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"main"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===pt.PARSING&&(this.stats.tparsed=window.performance.now(),this.state=pt.PARSED,this._checkAppendedParsed())},d.onAudioTrackSwitching=function(t){var e=!!t.url,r=t.id;if(!e){if(this.mediaBuffer!==this.media){c.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var i=this.fragCurrent;i.loader&&(c.logger.log("switching to main audio track, cancel main fragment load"),i.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=pt.IDLE}var n=this.hls;n.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),n.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:r}),this.altAudio=!1}},d.onAudioTrackSwitched=function(t){var e=t.id,r=!!this.hls.audioTracks[e].url;if(r){var i=this.videoBuffer;i&&this.mediaBuffer!==i&&(c.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r,this.tick()},d.onBufferCreated=function(t){var e,r,i=t.tracks,n=!1;for(var a in i){var o=i[a];"main"===o.id?(r=a,e=o,"video"===a&&(this.videoBuffer=i[a].buffer)):n=!0}n&&e?(c.logger.log("alternate track found, use "+r+".buffered to schedule main fragment loading"),this.mediaBuffer=e.buffer):this.mediaBuffer=this.media},d.onBufferAppended=function(t){if("main"===t.parent){var e=this.state;e!==pt.PARSING&&e!==pt.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},d._checkAppendedParsed=function(){if(!(this.state!==pt.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent;if(t){var e=this.mediaBuffer?this.mediaBuffer:this.media;c.logger.log("main buffered : "+at.toString(e.buffered)),this.fragPrevious=t;var r=this.stats;r.tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*r.total/(r.tbuffered-r.tfirst)),this.hls.trigger(u.default.FRAG_BUFFERED,{stats:r,frag:t,id:"main"}),this.state=pt.IDLE}(this.loadedmetadata||this.startPosition<=0)&&this.tick()}},d.onError=function(t){var e=t.frag||this.fragCurrent;if(!e||"main"===e.type){var r=!!this.media&&V.isBuffered(this.media,this.media.currentTime)&&V.isBuffered(this.media,this.media.currentTime+.5);switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:if(!t.fatal)if(this.fragLoadError+1<=this.config.fragLoadingMaxRetry){var i=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout);c.logger.warn("mediaController: frag loading failed, retry in "+i+" ms"),this.retryDate=window.performance.now()+i,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=pt.FRAG_LOADING_WAITING_RETRY}else c.logger.error("mediaController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=pt.ERROR;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==pt.ERROR&&(t.fatal?(this.state=pt.ERROR,c.logger.warn("streamController: "+t.details+",switch to "+this.state+" state ...")):t.levelRetry||this.state!==pt.WAITING_LEVEL||(this.state=pt.IDLE));break;case s.ErrorDetails.BUFFER_FULL_ERROR:"main"!==t.parent||this.state!==pt.PARSING&&this.state!==pt.PARSED||(r?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=pt.IDLE):(c.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},d._reduceMaxBufferLength=function(t){var e=this.config;return e.maxMaxBufferLength>=t&&(e.maxMaxBufferLength/=2,c.logger.warn("main:reduce max buffer length to "+e.maxMaxBufferLength+"s"),!0)},d._checkBuffer=function(){var t=this.media;if(t&&0!==t.readyState){var e=(this.mediaBuffer?this.mediaBuffer:t).buffered;!this.loadedmetadata&&e.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,e)}},d.onFragLoadEmergencyAborted=function(){this.state=pt.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tick()},d.onBufferFlushed=function(){var t=this.mediaBuffer?this.mediaBuffer:this.media;if(t){var e=this.audioOnly?g.AUDIO:g.VIDEO;this.fragmentTracker.detectEvictedFragments(e,t.buffered)}this.state=pt.IDLE,this.fragPrevious=null},d.onLevelsUpdated=function(t){this.levels=t.levels},d.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},d._seekToStartPos=function(){var t=this.media,e=t.currentTime,r=this.startPosition;if(e!==r&&r>=0){if(t.seeking)return void c.logger.log("could not seek to "+r+", already seeking at "+e);var i=(t.buffered.length?t.buffered.start(0):0)-r;i>0&&i<this.config.maxBufferHole&&(c.logger.log("adjusting start position by "+i+" to match buffer start"),r+=i,this.startPosition=r),c.logger.log("seek to target start position "+r+" from current time "+e+". ready state "+t.readyState),t.currentTime=r}},d._getAudioCodec=function(t){var e=this.config.defaultAudioCodec||t.audioCodec;return this.audioCodecSwap&&(c.logger.log("swapping playlist audio codec"),e&&(e=-1!==e.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),e},n=i,(o=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,c.logger.log("main stream-controller: "+e+"->"+t),this.hls.trigger(u.default.STREAM_STATE_TRANSITION,{previousState:e,nextState:t})}},get:function(){return this._state}},{key:"currentLevel",get:function(){var t=this.media;if(t){var e=this.getBufferedFrag(t.currentTime);if(e)return e.level}return-1}},{key:"nextBufferedFrag",get:function(){var t=this.media;return t?this.followingBufferedFrag(this.getBufferedFrag(t.currentTime)):null}},{key:"nextLevel",get:function(){var t=this.nextBufferedFrag;return t?t.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(t){this._liveSyncPosition=t}}])&&vt(n.prototype,o),h&&vt(n,h),i}(gt);function bt(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var _t=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MANIFEST_LOADED,u.default.LEVEL_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.FRAG_LOADED,u.default.ERROR)||this).canload=!1,r.currentLevelIndex=null,r.manualLevelIndex=-1,r.timer=null,mt=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,l=i.prototype;return l.onHandlerDestroying=function(){this.clearTimer(),this.manualLevelIndex=-1},l.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},l.startLoad=function(){var t=this._levels;this.canload=!0,this.levelRetryCount=0,t&&t.forEach(function(t){t.loadError=0;var e=t.details;e&&e.live&&(t.details=void 0)}),null!==this.timer&&this.loadLevel()},l.stopLoad=function(){this.canload=!1},l.onManifestLoaded=function(t){var e,r=[],i=[],n={},a=null,o=!1,l=!1;if(t.levels.forEach(function(t){var e=t.attrs;t.loadError=0,t.fragmentError=!1,o=o||!!t.videoCodec,l=l||!!t.audioCodec,mt&&t.audioCodec&&-1!==t.audioCodec.indexOf("mp4a.40.34")&&(t.audioCodec=void 0),(a=n[t.bitrate])?a.url.push(t.url):(t.url=[t.url],t.urlId=0,n[t.bitrate]=t,r.push(t)),e&&(e.AUDIO&&Z(a||t,"audio",e.AUDIO),e.SUBTITLES&&Z(a||t,"text",e.SUBTITLES))}),o&&l&&(r=r.filter(function(t){return!!t.videoCodec})),r=r.filter(function(t){var e=t.audioCodec,r=t.videoCodec;return(!e||k(e,"audio"))&&(!r||k(r,"video"))}),t.audioTracks&&(i=t.audioTracks.filter(function(t){return!t.audioCodec||k(t.audioCodec,"audio")})).forEach(function(t,e){t.id=e}),r.length>0){e=r[0].bitrate,r.sort(function(t,e){return t.bitrate-e.bitrate}),this._levels=r;for(var h=0;h<r.length;h++)if(r[h].bitrate===e){this._firstLevel=h,c.logger.log("manifest loaded,"+r.length+" level(s) found, first bitrate:"+e);break}var d=l&&!o;this.hls.trigger(u.default.MANIFEST_PARSED,{levels:r,audioTracks:i,firstLevel:this._firstLevel,stats:t.stats,audio:l,video:o,altAudio:!d&&i.some(function(t){return!!t.url})})}else this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},l.setLevelInternal=function(t){var e=this._levels,r=this.hls;if(t>=0&&t<e.length){if(this.clearTimer(),this.currentLevelIndex!==t){c.logger.log("switching to level "+t),this.currentLevelIndex=t;var i=e[t];i.level=t,r.trigger(u.default.LEVEL_SWITCHING,i)}var n=e[t],a=n.details;if(!a||a.live){var o=n.urlId;r.trigger(u.default.LEVEL_LOADING,{url:n.url[o],level:t,id:o})}}else r.trigger(u.default.ERROR,{type:s.ErrorTypes.OTHER_ERROR,details:s.ErrorDetails.LEVEL_SWITCH_ERROR,level:t,fatal:!1,reason:"invalid level idx"})},l.onError=function(t){if(t.fatal)t.type===s.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var e,r=!1,i=!1;switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:e=t.frag.level,i=!0;break;case s.ErrorDetails.LEVEL_LOAD_ERROR:case s.ErrorDetails.LEVEL_LOAD_TIMEOUT:e=t.context.level,r=!0;break;case s.ErrorDetails.REMUX_ALLOC_ERROR:e=t.level,r=!0}void 0!==e&&this.recoverLevel(t,e,r,i)}},l.recoverLevel=function(t,e,r,i){var n,a,o,s=this,l=this.hls.config,u=t.details,h=this._levels[e];if(h.loadError++,h.fragmentError=i,r){if(!(this.levelRetryCount+1<=l.levelLoadingMaxRetry))return c.logger.error("level controller, cannot recover from "+u+" error"),this.currentLevelIndex=null,this.clearTimer(),void(t.fatal=!0);a=Math.min(Math.pow(2,this.levelRetryCount)*l.levelLoadingRetryDelay,l.levelLoadingMaxRetryTimeout),this.timer=setTimeout(function(){return s.loadLevel()},a),t.levelRetry=!0,this.levelRetryCount++,c.logger.warn("level controller, "+u+", retry in "+a+" ms, current retry count is "+this.levelRetryCount)}(r||i)&&((n=h.url.length)>1&&h.loadError<n?(h.urlId=(h.urlId+1)%n,h.details=void 0,c.logger.warn("level controller, "+u+" for level "+e+": switching to redundant URL-id "+h.urlId)):-1===this.manualLevelIndex?(o=0===e?this._levels.length-1:e-1,c.logger.warn("level controller, "+u+": switch to "+o),this.hls.nextAutoLevel=this.currentLevelIndex=o):i&&(c.logger.warn("level controller, "+u+": reload a fragment"),this.currentLevelIndex=null))},l.onFragLoaded=function(t){var e=t.frag;if(void 0!==e&&"main"===e.type){var r=this._levels[e.level];void 0!==r&&(r.fragmentError=!1,r.loadError=0,this.levelRetryCount=0)}},l.onLevelLoaded=function(t){var e=this,r=t.level,i=t.details;if(r===this.currentLevelIndex){var n=this._levels[r];if(n.fragmentError||(n.loadError=0,this.levelRetryCount=0),i.live){var a=nt(n.details,i,t.stats.trequest);c.logger.log("live playlist, reload in "+Math.round(a)+" ms"),this.timer=setTimeout(function(){return e.loadLevel()},a)}else this.clearTimer()}},l.onAudioTrackSwitched=function(t){var e=this.hls.audioTracks[t.id].groupId,r=this.hls.levels[this.currentLevelIndex];if(r&&r.audioGroupIds){for(var i=-1,n=0;n<r.audioGroupIds.length;n++)if(r.audioGroupIds[n]===e){i=n;break}i!==r.urlId&&(r.urlId=i,this.startLoad())}},l.loadLevel=function(){if(c.logger.debug("call to loadLevel"),null!==this.currentLevelIndex&&this.canload){var t=this._levels[this.currentLevelIndex];if("object"==typeof t&&t.url.length>0){var e=this.currentLevelIndex,r=t.urlId,i=t.url[r];c.logger.log("Attempt loading level index "+e+" with URL-id "+r),this.hls.trigger(u.default.LEVEL_LOADING,{url:i,level:e,id:r})}}},l.removeLevel=function(t,e){var r=this.levels.filter(function(r,i){return i!==t||r.url.length>1&&void 0!==e&&(r.url=r.url.filter(function(t,r){return r!==e}),r.urlId=0,!0)}).map(function(t,e){var r=t.details;return r&&r.fragments&&r.fragments.forEach(function(t){t.level=e}),t});this._levels=r,this.hls.trigger(u.default.LEVELS_UPDATED,{levels:r})},n=i,(a=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(t){var e=this._levels;e&&(t=Math.min(t,e.length-1),this.currentLevelIndex===t&&e[t].details||this.setLevelInternal(t))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(t){this.manualLevelIndex=t,void 0===this._startLevel&&(this._startLevel=t),-1!==t&&(this.level=t)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(t){this._firstLevel=t}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var t=this.hls.config.startLevel;return void 0!==t?t:this._firstLevel}return this._startLevel},set:function(t){this._startLevel=t}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(t){this.level=t,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=t)}}])&&bt(n.prototype,a),o&&bt(n,o),i}(d),Tt=r("./src/demux/id3.js");function Et(t,e){var r;try{r=new Event("addtrack")}catch(t){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=t,e.dispatchEvent(r)}function St(t){if(null===t||void 0===t?void 0:t.cues)for(;t.cues.length>0;)t.removeCue(t.cues[0])}var wt=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_METADATA,u.default.LIVE_BACK_BUFFER_REACHED)||this).id3Track=void 0,r.media=void 0,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){d.prototype.destroy.call(this)},n.onMediaAttached=function(t){this.media=t.media,this.media},n.onMediaDetaching=function(){St(this.id3Track),this.id3Track=void 0,this.media=void 0},n.getID3Track=function(t){for(var e=0;e<t.length;e++){var r=t[e];if("metadata"===r.kind&&"id3"===r.label)return Et(r,this.media),r}return this.media.addTextTrack("metadata","id3")},n.onFragParsingMetadata=function(t){var e=t.frag,r=t.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var i=window.WebKitDataCue||window.VTTCue||window.TextTrackCue,n=0;n<r.length;n++){var a=Tt.default.getID3Frames(r[n].data);if(a){var o=Math.max(r[n].pts,0),s=n<r.length-1?r[n+1].pts:e.endPTS;s||(s=e.start+e.duration),o===s?s+=1e-4:o>s&&(c.logger.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),s=o+.25);for(var l=0;l<a.length;l++){var u=a[l];if(!Tt.default.isTimeStampFrame(u)){var h=new i(o,s,"");h.value=u,this.id3Track.addCue(h)}}}}},n.onLiveBackBufferReached=function(t){var e=t.bufferEnd,r=this.id3Track;if(r&&r.cues&&r.cues.length){var i=function(t,e){if(e<t[0].endTime)return t[0];if(e>t[t.length-1].endTime)return t[t.length-1];for(var r=0,i=t.length-1;r<=i;){var n=Math.floor((i+r)/2);if(e<t[n].endTime)i=n-1;else{if(!(e>t[n].endTime))return t[n];r=n+1}}return t[r].endTime-e<e-t[i].endTime?t[r]:t[i]}(r.cues,e);if(i)for(;r.cues[0]!==i;)r.removeCue(r.cues[0])}},i}(d);var kt=function(){function t(t){this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=0,this.totalWeight_=0}var e=t.prototype;return e.sample=function(t,e){var r=Math.pow(this.alpha_,t);this.estimate_=e*(1-r)+r*this.estimate_,this.totalWeight_+=t},e.getTotalWeight=function(){return this.totalWeight_},e.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);return this.estimate_/t}return this.estimate_},t}(),At=function(){function t(t,e,r,i){this.hls=void 0,this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.hls=t,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new kt(e),this.fast_=new kt(r)}var e=t.prototype;return e.sample=function(t,e){var r=(t=Math.max(t,this.minDelayMs_))/1e3,i=8*e/r;this.fast_.sample(r,i),this.slow_.sample(r,i)},e.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},e.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},e.destroy=function(){},t}();function Ct(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var xt=window.performance,Rt=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.FRAG_LOADING,u.default.FRAG_LOADED,u.default.FRAG_BUFFERED,u.default.ERROR)||this).lastLoadedFragLevel=0,r._nextAutoLevel=-1,r.hls=e,r.timer=null,r._bwEstimator=null,r.onCheck=r._abandonRulesCheck.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(r)),r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,h=i.prototype;return h.destroy=function(){this.clearTimer(),d.prototype.destroy.call(this)},h.onFragLoading=function(t){var e=t.frag;if("main"===e.type&&(this.timer||(this.fragCurrent=e,this.timer=setInterval(this.onCheck,100)),!this._bwEstimator)){var r,i,n=this.hls,a=n.config,o=e.level;n.levels[o].details.live?(r=a.abrEwmaFastLive,i=a.abrEwmaSlowLive):(r=a.abrEwmaFastVoD,i=a.abrEwmaSlowVoD),this._bwEstimator=new At(n,i,r,a.abrEwmaDefaultEstimate)}},h._abandonRulesCheck=function(){var t=this.hls,e=t.media,r=this.fragCurrent;if(r){var i=r.loader;if(!i||i.stats&&i.stats.aborted)return c.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);var n=i.stats;if(e&&n&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&r.autoLevel&&r.level){var a=xt.now()-n.trequest,o=Math.abs(e.playbackRate);if(a>500*r.duration/o){var s=t.levels,l=Math.max(1,n.bw?n.bw/8:1e3*n.loaded/a),h=s[r.level];if(!h)return;var d=h.realBitrate?Math.max(h.realBitrate,h.bitrate):h.bitrate,f=n.total?n.total:Math.max(n.loaded,Math.round(r.duration*d/8)),p=e.currentTime,g=(f-n.loaded)/l,v=(V.bufferInfo(e,p,t.config.maxBufferHole).end-p)/o;if(v<2*r.duration/o&&g>v){var m,y=t.minAutoLevel;for(m=r.level-1;m>y;m--){var b=s[m].realBitrate?Math.max(s[m].realBitrate,s[m].bitrate):s[m].bitrate;if(r.duration*b/(6.4*l)<v)break}void 0<g&&(c.logger.warn("loading too slow, abort fragment loading and switch to level "+m+":fragLoadedDelay["+m+"]<fragLoadedDelay["+(r.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+g.toFixed(1)+":"+v.toFixed(1)),t.nextLoadLevel=m,this._bwEstimator.sample(a,n.loaded),i.abort(),this.clearTimer(),t.trigger(u.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,stats:n}))}}}}},h.onFragLoaded=function(t){var e=t.frag;if("main"===e.type&&Object(l.isFiniteNumber)(e.sn)){if(this.clearTimer(),this.lastLoadedFragLevel=e.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var r=this.hls.levels[e.level],i=(r.loaded?r.loaded.bytes:0)+t.stats.loaded,n=(r.loaded?r.loaded.duration:0)+t.frag.duration;r.loaded={bytes:i,duration:n},r.realBitrate=Math.round(8*i/n)}if(t.frag.bitrateTest){var a=t.stats;a.tparsed=a.tbuffered=a.tload,this.onFragBuffered(t)}}},h.onFragBuffered=function(t){var e=t.stats,r=t.frag;if(!0!==e.aborted&&"main"===r.type&&Object(l.isFiniteNumber)(r.sn)&&(!r.bitrateTest||e.tload===e.tbuffered)){var i=e.tparsed-e.trequest;c.logger.log("latency/loading/parsing/append/kbps:"+Math.round(e.tfirst-e.trequest)+"/"+Math.round(e.tload-e.tfirst)+"/"+Math.round(e.tparsed-e.tload)+"/"+Math.round(e.tbuffered-e.tparsed)+"/"+Math.round(8*e.loaded/(e.tbuffered-e.trequest))),this._bwEstimator.sample(i,e.loaded),e.bwEstimate=this._bwEstimator.getEstimate(),r.bitrateTest?this.bitrateTestDelay=i/1e3:this.bitrateTestDelay=0}},h.onError=function(t){switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},h.clearTimer=function(){clearInterval(this.timer),this.timer=null},h._findBestLevel=function(t,e,r,i,n,a,o,s,l){for(var u=n;u>=i;u--){var h=l[u];if(h){var d=h.details,f=d?d.totalduration/d.fragments.length:e,p=!!d&&d.live,g=void 0;g=u<=t?o*r:s*r;var v=l[u].realBitrate?Math.max(l[u].realBitrate,l[u].bitrate):l[u].bitrate,m=v*f/g;if(c.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+u+"/"+Math.round(g)+"/"+v+"/"+f+"/"+a+"/"+m),g>v&&(!m||p&&!this.bitrateTestDelay||m<a))return u}}return-1},n=i,(a=[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,e=this._bwEstimator;if(!(-1===t||e&&e.canEstimate()))return t;var r=this._nextABRAutoLevel;return-1!==t&&(r=Math.min(t,r)),r},set:function(t){this._nextAutoLevel=t}},{key:"_nextABRAutoLevel",get:function(){var t=this.hls,e=t.maxAutoLevel,r=t.levels,i=t.config,n=t.minAutoLevel,a=t.media,o=this.lastLoadedFragLevel,s=this.fragCurrent?this.fragCurrent.duration:0,l=a?a.currentTime:0,u=a&&0!==a.playbackRate?Math.abs(a.playbackRate):1,h=this._bwEstimator?this._bwEstimator.getEstimate():i.abrEwmaDefaultEstimate,d=(V.bufferInfo(a,l,i.maxBufferHole).end-l)/u,f=this._findBestLevel(o,s,h,n,e,d,i.abrBandWidthFactor,i.abrBandWidthUpFactor,r);if(f>=0)return f;c.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering");var p=s?Math.min(s,i.maxStarvationDelay):i.maxStarvationDelay,g=i.abrBandWidthFactor,v=i.abrBandWidthUpFactor;if(0===d){var m=this.bitrateTestDelay;if(m)p=(s?Math.min(s,i.maxLoadingDelay):i.maxLoadingDelay)-m,c.logger.trace("bitrate test took "+Math.round(1e3*m)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*p)+" ms"),g=v=1}return f=this._findBestLevel(o,s,h,n,e,d+p,g,v,r),Math.max(f,0)}}])&&Ct(n.prototype,a),o&&Ct(n,o),i}(d);var Lt=q(),Dt=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_RESET,u.default.BUFFER_APPENDING,u.default.BUFFER_CODECS,u.default.BUFFER_EOS,u.default.BUFFER_FLUSHING,u.default.LEVEL_PTS_UPDATED,u.default.LEVEL_UPDATED)||this)._msDuration=null,r._levelDuration=null,r._levelTargetDuration=10,r._live=null,r._objectUrl=null,r._needsFlush=!1,r._needsEos=!1,r.config=void 0,r.audioTimestampOffset=void 0,r.bufferCodecEventsExpected=0,r._bufferCodecEventsTotal=0,r.media=null,r.mediaSource=null,r.segments=[],r.parent=void 0,r.appending=!1,r.appended=0,r.appendError=0,r.flushBufferCounter=0,r.tracks={},r.pendingTracks={},r.sourceBuffer={},r.flushRange=[],r._onMediaSourceOpen=function(){c.logger.log("media source opened"),r.hls.trigger(u.default.MEDIA_ATTACHED,{media:r.media});var t=r.mediaSource;t&&t.removeEventListener("sourceopen",r._onMediaSourceOpen),r.checkPendingTracks()},r._onMediaSourceClose=function(){c.logger.log("media source closed")},r._onMediaSourceEnded=function(){c.logger.log("media source ended")},r._onSBUpdateEnd=function(){if(r.audioTimestampOffset&&r.sourceBuffer.audio){var t=r.sourceBuffer.audio;c.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+r.audioTimestampOffset),t.timestampOffset=r.audioTimestampOffset,delete r.audioTimestampOffset}r._needsFlush&&r.doFlush(),r._needsEos&&r.checkEos(),r.appending=!1;var e=r.parent,i=r.segments.reduce(function(t,r){return r.parent===e?t+1:t},0),n={},a=r.sourceBuffer;for(var o in a){var s=a[o];if(!s)throw Error("handling source buffer update end error: source buffer for "+o+" uninitilized and unable to update buffered TimeRanges.");n[o]=s.buffered}r.hls.trigger(u.default.BUFFER_APPENDED,{parent:e,pending:i,timeRanges:n}),r._needsFlush||r.doAppending(),r.updateMediaElementDuration(),0===i&&r.flushLiveBackBuffer()},r._onSBUpdateError=function(t){c.logger.error("sourceBuffer error:",t),r.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},r.config=e.config,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){d.prototype.destroy.call(this)},n.onLevelPtsUpdated=function(t){var e=t.type,r=this.tracks.audio;if("audio"===e&&r&&"audio/mpeg"===r.container){var i=this.sourceBuffer.audio;if(!i)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(Math.abs(i.timestampOffset-t.start)>.1){var n=i.updating;try{i.abort()}catch(t){c.logger.warn("can not abort audio buffer: "+t)}n?this.audioTimestampOffset=t.start:(c.logger.warn("change mpeg audio timestamp offset from "+i.timestampOffset+" to "+t.start),i.timestampOffset=t.start)}}},n.onManifestParsed=function(t){var e=2;(t.audio&&!t.video||!t.altAudio)&&(e=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=e,c.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},n.onMediaAttaching=function(t){var e=this.media=t.media;if(e&&Lt){var r=this.mediaSource=new Lt;r.addEventListener("sourceopen",this._onMediaSourceOpen),r.addEventListener("sourceended",this._onMediaSourceEnded),r.addEventListener("sourceclose",this._onMediaSourceClose),e.src=window.URL.createObjectURL(r),this._objectUrl=e.src}},n.onMediaDetaching=function(){c.logger.log("media source detaching");var t=this.mediaSource;if(t){if("open"===t.readyState)try{t.endOfStream()}catch(t){c.logger.warn("onMediaDetaching:"+t.message+" while calling endOfStream")}t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):c.logger.warn("media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={},this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0}this.hls.trigger(u.default.MEDIA_DETACHED)},n.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,e=this.pendingTracks,r=Object.keys(e).length;(r&&!t||2===r)&&(this.createSourceBuffers(e),this.pendingTracks={},this.doAppending())},n.onBufferReset=function(){var t=this.sourceBuffer;for(var e in t){var r=t[e];try{r&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(r),r.removeEventListener("updateend",this._onSBUpdateEnd),r.removeEventListener("error",this._onSBUpdateError))}catch(t){}}this.sourceBuffer={},this.flushRange=[],this.segments=[],this.appended=0},n.onBufferCodecs=function(t){var e=this;Object.keys(this.sourceBuffer).length||(Object.keys(t).forEach(function(r){e.pendingTracks[r]=t[r]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},n.createSourceBuffers=function(t){var e=this.sourceBuffer,r=this.mediaSource;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(var i in t)if(!e[i]){var n=t[i];if(!n)throw Error("source buffer exists for track "+i+", however track does not");var a=n.levelCodec||n.codec,o=n.container+";codecs="+a;c.logger.log("creating sourceBuffer("+o+")");try{var l=e[i]=r.addSourceBuffer(o);l.addEventListener("updateend",this._onSBUpdateEnd),l.addEventListener("error",this._onSBUpdateError),this.tracks[i]={buffer:l,codec:a,id:n.id,container:n.container,levelCodec:n.levelCodec}}catch(t){c.logger.error("error while trying to add sourceBuffer:"+t.message),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:t,mimeType:o})}}this.hls.trigger(u.default.BUFFER_CREATED,{tracks:this.tracks})},n.onBufferAppending=function(t){this._needsFlush||(this.segments?this.segments.push(t):this.segments=[t],this.doAppending())},n.onBufferEos=function(t){for(var e in this.sourceBuffer)if(!t.type||t.type===e){var r=this.sourceBuffer[e];r&&!r.ended&&(r.ended=!0,c.logger.log(e+" sourceBuffer now EOS"))}this.checkEos()},n.checkEos=function(){var t=this.sourceBuffer,e=this.mediaSource;if(e&&"open"===e.readyState){for(var r in t){var i=t[r];if(i){if(!i.ended)return;if(i.updating)return void(this._needsEos=!0)}}c.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{e.endOfStream()}catch(t){c.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},n.onBufferFlushing=function(t){t.type?this.flushRange.push({start:t.startOffset,end:t.endOffset,type:t.type}):(this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"video"}),this.flushRange.push({start:t.startOffset,end:t.endOffset,type:"audio"})),this.flushBufferCounter=0,this.doFlush()},n.flushLiveBackBuffer=function(){if(this._live){var t=this.config.liveBackBufferLength;if(isFinite(t)&&!(t<0))if(this.media)for(var e=this.media.currentTime,r=this.sourceBuffer,i=Object.keys(r),n=e-Math.max(t,this._levelTargetDuration),a=i.length-1;a>=0;a--){var o=i[a],s=r[o];if(s){var l=s.buffered;l.length>0&&n>l.start(0)&&this.removeBufferRange(o,s,0,n)&&this.hls.trigger(u.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:n})}}else c.logger.error("flushLiveBackBuffer called without attaching media")}},n.onLevelUpdated=function(t){var e=t.details;e.fragments.length>0&&(this._levelDuration=e.totalduration+e.fragments[0].start,this._levelTargetDuration=e.averagetargetduration||e.targetduration||10,this._live=e.live,this.updateMediaElementDuration())},n.updateMediaElementDuration=function(){var t,e=this.config;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(var r in this.sourceBuffer){var i=this.sourceBuffer[r];if(i&&!0===i.updating)return}t=this.media.duration,null===this._msDuration&&(this._msDuration=this.mediaSource.duration),!0===this._live&&!0===e.liveDurationInfinity?(c.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!Object(l.isFiniteNumber)(t))&&(c.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},n.doFlush=function(){for(;this.flushRange.length;){var t=this.flushRange[0];if(!this.flushBuffer(t.start,t.end,t.type))return void(this._needsFlush=!0);this.flushRange.shift(),this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;var e=0,r=this.sourceBuffer;try{for(var i in r){var n=r[i];n&&(e+=n.buffered.length)}}catch(t){c.logger.error("error while accessing sourceBuffer.buffered")}this.appended=e,this.hls.trigger(u.default.BUFFER_FLUSHED)}},n.doAppending=function(){var t=this.config,e=this.hls,r=this.segments,i=this.sourceBuffer;if(Object.keys(i).length){if(!this.media||this.media.error)return this.segments=[],void c.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending){var n=r.shift();if(n)try{var a=i[n.type];if(!a)return void this._onSBUpdateEnd();if(a.updating)return void r.unshift(n);a.ended=!1,this.parent=n.parent,a.appendBuffer(n.data),this.appendError=0,this.appended++,this.appending=!0}catch(i){c.logger.error("error while trying to append buffer:"+i.message),r.unshift(n);var o={type:s.ErrorTypes.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===i.code?(this.segments=[],o.details=s.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,o.details=s.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>t.appendErrorMaxRetry&&(c.logger.log("fail "+t.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],o.fatal=!0)),e.trigger(u.default.ERROR,o)}}}},n.flushBuffer=function(t,e,r){var i=this.sourceBuffer;if(!Object.keys(i).length)return!0;var n="null";if(this.media&&(n=this.media.currentTime.toFixed(3)),c.logger.log("flushBuffer,pos/start/end: "+n+"/"+t+"/"+e),this.flushBufferCounter>=this.appended)return c.logger.warn("abort flushing too many retries"),!0;var a=i[r];if(a){if(a.ended=!1,a.updating)return c.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(r,a,t,e))return this.flushBufferCounter++,!1}return c.logger.log("buffer flushed"),!0},n.removeBufferRange=function(t,e,r,i){try{for(var n=0;n<e.buffered.length;n++){var a=e.buffered.start(n),o=e.buffered.end(n),s=Math.max(a,r),l=Math.min(o,i);if(Math.min(l,o)-s>.5){var u="null";return this.media&&(u=this.media.currentTime.toString()),c.logger.log("sb remove "+t+" ["+s+","+l+"], of ["+a+","+o+"], pos:"+u),e.remove(s,l),!0}}}catch(t){c.logger.warn("removeBufferRange failed",t)}return!1},i}(d);function Ot(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var It=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.FPS_DROP_LEVEL_CAPPING,u.default.MEDIA_ATTACHING,u.default.MANIFEST_PARSED,u.default.LEVELS_UPDATED,u.default.BUFFER_CODECS,u.default.MEDIA_DETACHING)||this).autoLevelCapping=Number.POSITIVE_INFINITY,r.firstLevel=null,r.levels=[],r.media=null,r.restrictedLevels=[],r.timer=null,r.clientRect=null,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,s=i.prototype;return s.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.clientRect=null,this.stopCapping())},s.onFpsDropLevelCapping=function(t){i.isLevelAllowed(t.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(t.droppedLevel)},s.onMediaAttaching=function(t){this.media=t.media instanceof window.HTMLVideoElement?t.media:null},s.onManifestParsed=function(t){var e=this.hls;this.restrictedLevels=[],this.levels=t.levels,this.firstLevel=t.firstLevel,e.config.capLevelToPlayerSize&&t.video&&this.startCapping()},s.onBufferCodecs=function(t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()},s.onLevelsUpdated=function(t){this.levels=t.levels},s.onMediaDetaching=function(){this.stopCapping()},s.detectPlayerSize=function(){if(this.media){var t=this.levels?this.levels.length:0;if(t){var e=this.hls;e.autoLevelCapping=this.getMaxLevel(t-1),e.autoLevelCapping>this.autoLevelCapping&&e.streamController.nextLevelSwitch(),this.autoLevelCapping=e.autoLevelCapping}}},s.getMaxLevel=function(t){var e=this;if(!this.levels)return-1;var r=this.levels.filter(function(r,n){return i.isLevelAllowed(n,e.restrictedLevels)&&n<=t});return this.clientRect=null,i.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)},s.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},s.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=null,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},s.getDimensions=function(){if(this.clientRect)return this.clientRect;var t=this.media,e={width:0,height:0};if(t){var r=t.getBoundingClientRect();e.width=r.width,e.height=r.height,e.width||e.height||(e.width=r.right-r.left||t.width||0,e.height=r.bottom-r.top||t.height||0)}return this.clientRect=e,e},i.isLevelAllowed=function(t,e){return void 0===e&&(e=[]),-1===e.indexOf(t)},i.getMaxLevelByMediaSize=function(t,e,r){if(!t||t&&!t.length)return-1;for(var i,n,a=t.length-1,o=0;o<t.length;o+=1){var s=t[o];if((s.width>=e||s.height>=r)&&(i=s,!(n=t[o+1])||i.width!==n.width||i.height!==n.height)){a=o;break}}return a},n=i,o=[{key:"contentScaleFactor",get:function(){var t=1;try{t=window.devicePixelRatio}catch(t){}return t}}],(a=[{key:"mediaWidth",get:function(){return this.getDimensions().width*i.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*i.contentScaleFactor}}])&&Ot(n.prototype,a),o&&Ot(n,o),i}(d);var Pt=window.performance,Mt=function(t){var e,r;function i(e){return t.call(this,e,u.default.MEDIA_ATTACHING)||this}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.destroy=function(){this.timer&&clearInterval(this.timer),this.isVideoPlaybackQualityAvailable=!1},n.onMediaAttaching=function(t){var e=this.hls.config;e.capLevelOnFPSDrop&&("function"==typeof(this.video=t.media instanceof window.HTMLVideoElement?t.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),e.fpsDroppedMonitoringPeriod))},n.checkFPS=function(t,e,r){var i=Pt.now();if(e){if(this.lastTime){var n=i-this.lastTime,a=r-this.lastDroppedFrames,o=e-this.lastDecodedFrames,s=1e3*a/n,l=this.hls;if(l.trigger(u.default.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),s>0&&a>l.config.fpsDroppedMonitoringThreshold*o){var h=l.currentLevel;c.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=h)&&(h-=1,l.trigger(u.default.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:l.currentLevel}),l.autoLevelCapping=h,l.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=e}},n.checkFPSInterval=function(){var t=this.video;if(t)if(this.isVideoPlaybackQualityAvailable){var e=t.getVideoPlaybackQuality();this.checkFPS(t,e.totalVideoFrames,e.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},i}(d),Nt=function(){function t(t){t&&t.xhrSetup&&(this.xhrSetup=t.xhrSetup)}var e=t.prototype;return e.destroy=function(){this.abort(),this.loader=null},e.abort=function(){var t=this.loader;t&&4!==t.readyState&&(this.stats.aborted=!0,t.abort()),window.clearTimeout(this.requestTimeout),this.requestTimeout=null,window.clearTimeout(this.retryTimeout),this.retryTimeout=null},e.load=function(t,e,r){this.context=t,this.config=e,this.callbacks=r,this.stats={trequest:window.performance.now(),retry:0},this.retryDelay=e.retryDelay,this.loadInternal()},e.loadInternal=function(){var t,e=this.context;t=this.loader=new window.XMLHttpRequest;var r=this.stats;r.tfirst=0,r.loaded=0;var i=this.xhrSetup;try{if(i)try{i(t,e.url)}catch(r){t.open("GET",e.url,!0),i(t,e.url)}t.readyState||t.open("GET",e.url,!0)}catch(r){return void this.callbacks.onError({code:t.status,text:r.message},e,t)}e.rangeEnd&&t.setRequestHeader("Range","bytes="+e.rangeStart+"-"+(e.rangeEnd-1)),t.onreadystatechange=this.readystatechange.bind(this),t.onprogress=this.loadprogress.bind(this),t.responseType=e.responseType,this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout),t.send()},e.readystatechange=function(t){var e=t.currentTarget,r=e.readyState,i=this.stats,n=this.context,a=this.config;if(!i.aborted&&r>=2)if(window.clearTimeout(this.requestTimeout),0===i.tfirst&&(i.tfirst=Math.max(window.performance.now(),i.trequest)),4===r){var o=e.status;if(o>=200&&o<300){var s,l;i.tload=Math.max(i.tfirst,window.performance.now()),l="arraybuffer"===n.responseType?(s=e.response).byteLength:(s=e.responseText).length,i.loaded=i.total=l;var u={url:e.responseURL,data:s};this.callbacks.onSuccess(u,i,n,e)}else i.retry>=a.maxRetry||o>=400&&o<499?(c.logger.error(o+" while loading "+n.url),this.callbacks.onError({code:o,text:e.statusText},n,e)):(c.logger.warn(o+" while loading "+n.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,a.maxRetryDelay),i.retry++)}else this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),a.timeout)},e.loadtimeout=function(){c.logger.warn("timeout while loading "+this.context.url),this.callbacks.onTimeout(this.stats,this.context,null)},e.loadprogress=function(t){var e=t.currentTarget,r=this.stats;r.loaded=t.loaded,t.lengthComputable&&(r.total=t.total);var i=this.callbacks.onProgress;i&&i(r,this.context,null,e)},t}();function Ft(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Bt=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.AUDIO_TRACK_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.LEVEL_LOADED,u.default.ERROR)||this)._trackId=-1,r._selectDefaultTrack=!0,r.tracks=[],r.trackIdBlacklist=Object.create(null),r.audioGroupId=null,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,l=i.prototype;return l.onManifestLoading=function(){this.tracks=[],this._trackId=-1,this._selectDefaultTrack=!0},l.onManifestParsed=function(t){var e=this.tracks=t.audioTracks||[];this.hls.trigger(u.default.AUDIO_TRACKS_UPDATED,{audioTracks:e}),this._selectAudioGroup(this.hls.nextLoadLevel)},l.onAudioTrackLoaded=function(t){if(t.id>=this.tracks.length)c.logger.warn("Invalid audio track id:",t.id);else{if(c.logger.log("audioTrack "+t.id+" loaded"),this.tracks[t.id].details=t.details,t.details.live&&!this.hasInterval()){var e=1e3*t.details.targetduration;this.setInterval(e)}!t.details.live&&this.hasInterval()&&this.clearInterval()}},l.onAudioTrackSwitched=function(t){var e=this.tracks[t.id].groupId;e&&this.audioGroupId!==e&&(this.audioGroupId=e)},l.onLevelLoaded=function(t){this._selectAudioGroup(t.level)},l.onError=function(t){t.type===s.ErrorTypes.NETWORK_ERROR&&(t.fatal&&this.clearInterval(),t.details===s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(c.logger.warn("Network failure on audio-track id:",t.context.id),this._handleLoadError()))},l._setAudioTrack=function(t){if(this._trackId===t&&this.tracks[this._trackId].details)c.logger.debug("Same id as current audio-track passed, and track details available -> no-op");else if(t<0||t>=this.tracks.length)c.logger.warn("Invalid id passed to audio-track controller");else{var e=this.tracks[t];c.logger.log("Now switching to audio-track index "+t),this.clearInterval(),this._trackId=t;var r=e.url,i=e.type,n=e.id;this.hls.trigger(u.default.AUDIO_TRACK_SWITCHING,{id:n,type:i,url:r}),this._loadTrackDetailsIfNeeded(e)}},l.doTick=function(){this._updateTrack(this._trackId)},l._selectAudioGroup=function(t){var e=this.hls.levels[t];if(e&&e.audioGroupIds){var r=e.audioGroupIds[e.urlId];this.audioGroupId!==r&&(this.audioGroupId=r,this._selectInitialAudioTrack())}},l._selectInitialAudioTrack=function(){var t=this,e=this.tracks;if(e.length){var r=this.tracks[this._trackId],i=null;if(r&&(i=r.name),this._selectDefaultTrack){var n=e.filter(function(t){return t.default});n.length?e=n:c.logger.warn("No default audio tracks defined")}var a=!1,o=function(){e.forEach(function(e){a||t.audioGroupId&&e.groupId!==t.audioGroupId||i&&i!==e.name||(t._setAudioTrack(e.id),a=!0)})};o(),a||(i=null,o()),a||(c.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))}},l._needsTrackLoading=function(t){var e=t.details,r=t.url;return!(e&&!e.live)&&!!r},l._loadTrackDetailsIfNeeded=function(t){if(this._needsTrackLoading(t)){var e=t.url,r=t.id;c.logger.log("loading audio-track playlist for id: "+r),this.hls.trigger(u.default.AUDIO_TRACK_LOADING,{url:e,id:r})}},l._updateTrack=function(t){if(!(t<0||t>=this.tracks.length)){this.clearInterval(),this._trackId=t,c.logger.log("trying to update audio-track "+t);var e=this.tracks[t];this._loadTrackDetailsIfNeeded(e)}},l._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;var t=this._trackId,e=this.tracks[t],r=e.name,i=e.language,n=e.groupId;c.logger.warn("Loading failed on audio track id: "+t+", group-id: "+n+', name/language: "'+r+'" / "'+i+'"');for(var a=t,o=0;o<this.tracks.length;o++){if(!this.trackIdBlacklist[o])if(this.tracks[o].name===r){a=o;break}}a!==t?(c.logger.log("Attempting audio-track fallback id:",a,"group-id:",this.tracks[a].groupId),this._setAudioTrack(a)):c.logger.warn('No fallback audio-track found for name/language: "'+r+'" / "'+i+'"')},n=i,(a=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(t){this._setAudioTrack(t),this._selectDefaultTrack=!1}}])&&Ft(n.prototype,a),o&&Ft(n,o),i}(ft);function jt(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Ut=window.performance,Gt=function(t){var e,r;function i(e,r){var i;return(i=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.AUDIO_TRACKS_UPDATED,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_LOADED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.BUFFER_RESET,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED,u.default.INIT_PTS_FOUND)||this).fragmentTracker=r,i.config=e.config,i.audioCodecSwap=!1,i._state=pt.STOPPED,i.initPTS=[],i.waitingFragment=null,i.videoTrackCC=null,i}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,h=i.prototype;return h.onInitPtsFound=function(t){var e=t.id,r=t.frag.cc,i=t.initPTS;"main"===e&&(this.initPTS[r]=i,this.videoTrackCC=r,c.logger.log("InitPTS for cc: "+r+" found from video track: "+i),this.state===pt.WAITING_INIT_PTS&&this.tick())},h.startLoad=function(t){if(this.tracks){var e=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,e>0&&-1===t?(c.logger.log("audio:override startPosition with lastCurrentTime @"+e.toFixed(3)),this.state=pt.IDLE):(this.lastCurrentTime=this.startPosition?this.startPosition:t,this.state=pt.STARTING),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()}else this.startPosition=t,this.state=pt.STOPPED},h.doTick=function(){var t,e,r,i=this.hls,n=i.config;switch(this.state){case pt.ERROR:case pt.PAUSED:case pt.BUFFER_FLUSHING:break;case pt.STARTING:this.state=pt.WAITING_TRACK,this.loadedmetadata=!1;break;case pt.IDLE:var a=this.tracks;if(!a)break;if(!this.media&&(this.startFragRequested||!n.startFragPrefetch))break;if(this.loadedmetadata)t=this.media.currentTime;else if(void 0===(t=this.nextLoadPosition))break;var o=this.mediaBuffer?this.mediaBuffer:this.media,s=this.videoBuffer?this.videoBuffer:this.media,h=t<n.maxBufferHole?Math.max(2,n.maxBufferHole):n.maxBufferHole,d=V.bufferInfo(o,t,h),f=V.bufferInfo(s,t,h),p=d.len,g=d.end,v=this.fragPrevious,m=Math.min(n.maxBufferLength,n.maxMaxBufferLength),y=Math.max(m,f.len),b=this.audioSwitch,_=this.trackId;if((p<y||b)&&_<a.length){if(void 0===(r=a[_].details)){this.state=pt.WAITING_TRACK;break}if(!b&&this._streamEnded(d,r))return this.hls.trigger(u.default.BUFFER_EOS,{type:"audio"}),void(this.state=pt.ENDED);var T,E=r.fragments,S=E.length,w=E[0].start,k=E[S-1].start+E[S-1].duration;if(b)if(r.live&&!r.PTSKnown)c.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),g=0;else if(g=t,r.PTSKnown&&t<w){if(!(d.end>w||d.nextStart))return;c.logger.log("alt audio track ahead of main track, seek to start of alt audio track"),this.media.currentTime=w+.05}if(r.initSegment&&!r.initSegment.data)T=r.initSegment;else if(g<=w){if(T=E[0],null!==this.videoTrackCC&&T.cc!==this.videoTrackCC&&(T=function(t,e){return H.search(t,function(t){return t.cc<e?1:t.cc>e?-1:0})}(E,this.videoTrackCC)),r.live&&T.loadIdx&&T.loadIdx===this.fragLoadIdx){var A=d.nextStart?d.nextStart:w;return c.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(A+.05)),void(this.media.currentTime=A+.05)}}else{var C,x=n.maxFragLookUpTolerance,R=v?E[v.sn-E[0].sn+1]:void 0,L=function(t){var e=Math.min(x,t.duration);return t.start+t.duration-e<=g?1:t.start-e>g&&t.start?-1:0};g<k?(g>k-x&&(x=0),C=R&&!L(R)?R:H.search(E,L)):C=E[S-1],C&&(T=C,w=C.start,v&&T.level===v.level&&T.sn===v.sn&&(T.sn<r.endSN?(T=E[T.sn+1-r.startSN],c.logger.log("SN just loaded, load next one: "+T.sn)):T=null))}T&&(T.encrypted?(c.logger.log("Loading key for "+T.sn+" of ["+r.startSN+" ,"+r.endSN+"],track "+_),this.state=pt.KEY_LOADING,i.trigger(u.default.KEY_LOADING,{frag:T})):(this.fragCurrent=T,(b||this.fragmentTracker.getState(T)===F)&&(c.logger.log("Loading "+T.sn+", cc: "+T.cc+" of ["+r.startSN+" ,"+r.endSN+"],track "+_+", currentTime:"+t+",bufferEnd:"+g.toFixed(3)),"initSegment"!==T.sn&&(this.startFragRequested=!0),Object(l.isFiniteNumber)(T.sn)&&(this.nextLoadPosition=T.start+T.duration),i.trigger(u.default.FRAG_LOADING,{frag:T}),this.state=pt.FRAG_LOADING)))}break;case pt.WAITING_TRACK:(e=this.tracks[this.trackId])&&e.details&&(this.state=pt.IDLE);break;case pt.FRAG_LOADING_WAITING_RETRY:var D=Ut.now(),O=this.retryDate,I=(o=this.media)&&o.seeking;(!O||D>=O||I)&&(c.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=pt.IDLE);break;case pt.WAITING_INIT_PTS:var P=this.videoTrackCC;if(void 0===this.initPTS[P])break;var M=this.waitingFragment;if(M){var N=M.frag.cc;P!==N?(e=this.tracks[this.trackId]).details&&e.details.live&&(c.logger.warn("Waiting fragment CC ("+N+") does not match video track CC ("+P+")"),this.waitingFragment=null,this.state=pt.IDLE):(this.state=pt.FRAG_LOADING,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null)}else this.state=pt.IDLE;break;case pt.STOPPED:case pt.FRAG_LOADING:case pt.PARSING:case pt.PARSED:case pt.ENDED:}},h.onMediaAttached=function(t){var e=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),e.addEventListener("seeking",this.onvseeking),e.addEventListener("ended",this.onvended);var r=this.config;this.tracks&&r.autoStartLoad&&this.startLoad(r.startPosition)},h.onMediaDetaching=function(){var t=this.media;t&&t.ended&&(c.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),t&&(t.removeEventListener("seeking",this.onvseeking),t.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null),this.media=this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},h.onAudioTracksUpdated=function(t){c.logger.log("audio tracks updated"),this.tracks=t.audioTracks},h.onAudioTrackSwitching=function(t){var e=!!t.url;this.trackId=t.id,this.fragCurrent=null,this.state=pt.PAUSED,this.waitingFragment=null,e?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),e&&(this.audioSwitch=!0,this.state=pt.IDLE),this.tick()},h.onAudioTrackLoaded=function(t){var e=t.details,r=t.id,i=this.tracks[r],n=e.totalduration,a=0;if(c.logger.log("track "+r+" loaded ["+e.startSN+","+e.endSN+"],duration:"+n),e.live){var o=i.details;o&&e.fragments.length>0?(rt(o,e),a=e.fragments[0].start,e.PTSKnown?c.logger.log("live audio playlist sliding:"+a.toFixed(3)):c.logger.log("live audio playlist - outdated PTS, unknown sliding")):(e.PTSKnown=!1,c.logger.log("live audio playlist - first load, unknown sliding"))}else e.PTSKnown=!1;if(i.details=e,!this.startFragRequested){if(-1===this.startPosition){var s=e.startTimeOffset;Object(l.isFiniteNumber)(s)?(c.logger.log("start time offset found in playlist, adjust startPosition to "+s),this.startPosition=s):e.live?(this.startPosition=this.computeLivePosition(a,e),c.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0}this.nextLoadPosition=this.startPosition}this.state===pt.WAITING_TRACK&&(this.state=pt.IDLE),this.tick()},h.onKeyLoaded=function(){this.state===pt.KEY_LOADING&&(this.state=pt.IDLE,this.tick())},h.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag;if(this.state===pt.FRAG_LOADING&&e&&"audio"===r.type&&r.level===e.level&&r.sn===e.sn){var i=this.tracks[this.trackId],n=i.details,a=n.totalduration,o=e.level,s=e.sn,l=e.cc,h=this.config.defaultAudioCodec||i.audioCodec||"mp4a.40.2",d=this.stats=t.stats;if("initSegment"===s)this.state=pt.IDLE,d.tparsed=d.tbuffered=Ut.now(),n.initSegment.data=t.payload,this.hls.trigger(u.default.FRAG_BUFFERED,{stats:d,frag:e,id:"audio"}),this.tick();else{this.state=pt.PARSING,this.appended=!1,this.demuxer||(this.demuxer=new Q(this.hls,"audio"));var f=this.initPTS[l],p=n.initSegment?n.initSegment.data:[];if(n.initSegment||void 0!==f){this.pendingBuffering=!0,c.logger.log("Demuxing "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o);this.demuxer.push(t.payload,p,h,null,e,a,!1,f)}else c.logger.log("unknown video PTS for continuity counter "+l+", waiting for video PTS before demuxing audio frag "+s+" of ["+n.startSN+" ,"+n.endSN+"],track "+o),this.waitingFragment=t,this.state=pt.WAITING_INIT_PTS}}this.fragLoadError=0},h.onFragParsingInitSegment=function(t){var e=this.fragCurrent,r=t.frag;if(e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===pt.PARSING){var i,n=t.tracks;if(n.video&&delete n.video,i=n.audio){i.levelCodec=i.codec,i.id=t.id,this.hls.trigger(u.default.BUFFER_CODECS,n),c.logger.log("audio track:audio,container:"+i.container+",codecs[level/parsed]=["+i.levelCodec+"/"+i.codec+"]");var a=i.initSegment;if(a){var o={type:"audio",data:a,parent:"audio",content:"initSegment"};this.audioSwitch?this.pendingData=[o]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,o))}this.tick()}}},h.onFragParsingData=function(t){var e=this,r=this.fragCurrent,i=t.frag;if(r&&"audio"===t.id&&"audio"===t.type&&i.sn===r.sn&&i.level===r.level&&this.state===pt.PARSING){var n=this.trackId,a=this.tracks[n],o=this.hls;Object(l.isFiniteNumber)(t.endPTS)||(t.endPTS=t.startPTS+r.duration,t.endDTS=t.startDTS+r.duration),r.addElementaryStream(g.AUDIO),c.logger.log("parsed "+t.type+",PTS:["+t.startPTS.toFixed(3)+","+t.endPTS.toFixed(3)+"],DTS:["+t.startDTS.toFixed(3)+"/"+t.endDTS.toFixed(3)+"],nb:"+t.nb),et(a.details,r,t.startPTS,t.endPTS);var h=this.audioSwitch,d=this.media,f=!1;if(h)if(d&&d.readyState){var p=d.currentTime;c.logger.log("switching audio track : currentTime:"+p),p>=t.startPTS&&(c.logger.log("switching audio track : flushing all audio"),this.state=pt.BUFFER_FLUSHING,o.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),f=!0,this.audioSwitch=!1,o.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:n}))}else this.audioSwitch=!1,o.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:n});var v=this.pendingData;if(!v)return c.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void o.trigger(u.default.ERROR,{type:s.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([t.data1,t.data2].forEach(function(e){e&&e.length&&v.push({type:t.type,data:e,parent:"audio",content:"data"})}),!f&&v.length&&(v.forEach(function(t){e.state===pt.PARSING&&(e.pendingBuffering=!0,e.hls.trigger(u.default.BUFFER_APPENDING,t))}),this.pendingData=[],this.appended=!0)),this.tick()}},h.onFragParsed=function(t){var e=this.fragCurrent,r=t.frag;e&&"audio"===t.id&&r.sn===e.sn&&r.level===e.level&&this.state===pt.PARSING&&(this.stats.tparsed=Ut.now(),this.state=pt.PARSED,this._checkAppendedParsed())},h.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},h.onBufferCreated=function(t){var e=t.tracks.audio;e&&(this.mediaBuffer=e.buffer,this.loadedmetadata=!0),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer)},h.onBufferAppended=function(t){if("audio"===t.parent){var e=this.state;e!==pt.PARSING&&e!==pt.PARSED||(this.pendingBuffering=t.pending>0,this._checkAppendedParsed())}},h._checkAppendedParsed=function(){if(!(this.state!==pt.PARSED||this.appended&&this.pendingBuffering)){var t=this.fragCurrent,e=this.stats,r=this.hls;if(t){this.fragPrevious=t,e.tbuffered=Ut.now(),r.trigger(u.default.FRAG_BUFFERED,{stats:e,frag:t,id:"audio"});var i=this.mediaBuffer?this.mediaBuffer:this.media;i&&c.logger.log("audio buffered : "+at.toString(i.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,r.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=pt.IDLE}this.tick()}},h.onError=function(t){var e=t.frag;if(!e||"audio"===e.type)switch(t.details){case s.ErrorDetails.FRAG_LOAD_ERROR:case s.ErrorDetails.FRAG_LOAD_TIMEOUT:var r=t.frag;if(r&&"audio"!==r.type)break;if(!t.fatal){var i=this.fragLoadError;i?i++:i=1;var n=this.config;if(i<=n.fragLoadingMaxRetry){this.fragLoadError=i;var a=Math.min(Math.pow(2,i-1)*n.fragLoadingRetryDelay,n.fragLoadingMaxRetryTimeout);c.logger.warn("AudioStreamController: frag loading failed, retry in "+a+" ms"),this.retryDate=Ut.now()+a,this.state=pt.FRAG_LOADING_WAITING_RETRY}else c.logger.error("AudioStreamController: "+t.details+" reaches max retry, redispatch as fatal ..."),t.fatal=!0,this.state=pt.ERROR}break;case s.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case s.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case s.ErrorDetails.KEY_LOAD_ERROR:case s.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==pt.ERROR&&(this.state=t.fatal?pt.ERROR:pt.IDLE,c.logger.warn("AudioStreamController: "+t.details+" while loading frag, now switching to "+this.state+" state ..."));break;case s.ErrorDetails.BUFFER_FULL_ERROR:if("audio"===t.parent&&(this.state===pt.PARSING||this.state===pt.PARSED)){var o=this.mediaBuffer,l=this.media.currentTime;if(o&&V.isBuffered(o,l)&&V.isBuffered(o,l+.5)){var h=this.config;h.maxMaxBufferLength>=h.maxBufferLength&&(h.maxMaxBufferLength/=2,c.logger.warn("AudioStreamController: reduce max buffer length to "+h.maxMaxBufferLength+"s")),this.state=pt.IDLE}else c.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=pt.BUFFER_FLUSHING,this.hls.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})}}},h.onBufferFlushed=function(){var t=this,e=this.pendingData;e&&e.length?(c.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),e.forEach(function(e){t.hls.trigger(u.default.BUFFER_APPENDING,e)}),this.appended=!0,this.pendingData=[],this.state=pt.PARSED):(this.state=pt.IDLE,this.fragPrevious=null,this.tick())},n=i,(a=[{key:"state",set:function(t){if(this.state!==t){var e=this.state;this._state=t,c.logger.log("audio stream:"+e+"->"+t)}},get:function(){return this._state}}])&&jt(n.prototype,a),o&&jt(n,o),i}(gt),Ht=function(){if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var t="auto",e={"":!0,lr:!0,rl:!0},r={start:!0,middle:!0,end:!0,left:!0,right:!0};function i(t){return"string"==typeof t&&(!!r[t.toLowerCase()]&&t.toLowerCase())}function n(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)t[i]=r[i]}return t}function a(r,a,o){var s=this,l={enumerable:!0};s.hasBeenReset=!1;var u="",c=!1,h=r,d=a,f=o,p=null,g="",v=!0,m="auto",y="start",b=50,_="middle",T=50,E="middle";Object.defineProperty(s,"id",n({},l,{get:function(){return u},set:function(t){u=""+t}})),Object.defineProperty(s,"pauseOnExit",n({},l,{get:function(){return c},set:function(t){c=!!t}})),Object.defineProperty(s,"startTime",n({},l,{get:function(){return h},set:function(t){if("number"!=typeof t)throw new TypeError("Start time must be set to a number.");h=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",n({},l,{get:function(){return d},set:function(t){if("number"!=typeof t)throw new TypeError("End time must be set to a number.");d=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",n({},l,{get:function(){return f},set:function(t){f=""+t,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",n({},l,{get:function(){return p},set:function(t){p=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",n({},l,{get:function(){return g},set:function(t){var r=function(t){return"string"==typeof t&&!!e[t.toLowerCase()]&&t.toLowerCase()}(t);if(!1===r)throw new SyntaxError("An invalid or illegal string was specified.");g=r,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",n({},l,{get:function(){return v},set:function(t){v=!!t,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",n({},l,{get:function(){return m},set:function(e){if("number"!=typeof e&&e!==t)throw new SyntaxError("An invalid number or illegal string was specified.");m=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",n({},l,{get:function(){return y},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",n({},l,{get:function(){return b},set:function(t){if(t<0||t>100)throw new Error("Position must be between 0 and 100.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",n({},l,{get:function(){return _},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",n({},l,{get:function(){return T},set:function(t){if(t<0||t>100)throw new Error("Size must be between 0 and 100.");T=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",n({},l,{get:function(){return E},set:function(t){var e=i(t);if(!e)throw new SyntaxError("An invalid or illegal string was specified.");E=e,this.hasBeenReset=!0}})),s.displayState=void 0}return a.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},a}(),Vt=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}};function Kt(){this.window=window,this.state="INITIAL",this.buffer="",this.decoder=new Vt,this.regionList=[]}function Wt(){this.values=Object.create(null)}function zt(t,e,r,i){var n=i?t.split(i):[t];for(var a in n)if("string"==typeof n[a]){var o=n[a].split(r);if(2===o.length)e(o[0],o[1])}}Wt.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var i=0;i<r.length;++i)if(e===r[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var qt=new Ht(0,0,0),Yt="middle"===qt.align?"middle":"center";function Xt(t,e,r){var i=t;function n(){var e=function(t){function e(t,e,r,i){return 3600*(0|t)+60*(0|e)+(0|r)+(0|i)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}(t);if(null===e)throw new Error("Malformed timestamp: "+i);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function a(){t=t.replace(/^\s+/,"")}if(a(),e.startTime=n(),a(),"--\x3e"!==t.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+i);t=t.substr(3),a(),e.endTime=n(),a(),function(t,e){var i=new Wt;zt(t,function(t,e){switch(t){case"region":for(var n=r.length-1;n>=0;n--)if(r[n].id===e){i.set(t,r[n].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];i.integer(t,o),i.percent(t,o)&&i.set("snapToLines",!1),i.alt(t,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start",Yt,"end"]);break;case"position":a=e.split(","),i.percent(t,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start",Yt,"end","line-left","line-right","auto"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start",Yt,"end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical","");var n=i.get("line","auto");"auto"===n&&-1===qt.line&&(n=-1),e.line=n,e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align",Yt);var a=i.get("position","auto");"auto"===a&&50===qt.position&&(a="start"===e.align||"left"===e.align?0:"end"===e.align||"right"===e.align?100:50),e.position=a}(t,e)}function $t(t){return t.replace(/<br(?: \/)?>/gi,"\n")}Kt.prototype={parse:function(t){var e=this;function r(){var t=e.buffer,r=0;for(t=$t(t);r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;var i=t.substr(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.substr(r),i}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var i;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var n=(i=r()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!n||!n[0])throw new Error("Malformed WebVTT signature.");e.state="HEADER"}for(var a=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(a?a=!1:i=r(),e.state){case"HEADER":/:/.test(i)?zt(i,function(t,e){},/:/):i||(e.state="ID");continue;case"NOTE":i||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){e.state="NOTE";break}if(!i)continue;if(e.cue=new Ht(0,0,""),e.state="CUE",-1===i.indexOf("--\x3e")){e.cue.id=i;continue}case"CUE":try{Xt(i,e.cue,e.regionList)}catch(t){e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var o=-1!==i.indexOf("--\x3e");if(!i||o&&(a=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=i;continue;case"BADCUE":i||(e.state="ID");continue}}}catch(t){"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.")}catch(t){throw t}return this.onflush&&this.onflush(),this}};var Jt=Kt;function Qt(t,e,r,i){for(var n,a,o,s,l,u=[],c=window.VTTCue||TextTrackCue,h=0;h<i.rows.length;h++)if(o=!0,s=0,l="",!(n=i.rows[h]).isEmpty()){for(var d=0;d<n.chars.length;d++)n.chars[d].uchar.match(/\s/)&&o?s++:(l+=n.chars[d].uchar,o=!1);n.cueStartTime=e,e===r&&(r+=1e-4),a=new c(e,r,$t(l.trim())),s>=16?s--:s++,navigator.userAgent.match(/Firefox\//)?a.line=h+1:a.line=h>7?h-2:h+1,a.align="left",a.position=Math.max(0,Math.min(100,s/32*100)),u.push(a),t&&t.addCue(a)}return u}var Zt,te={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},ee=function(t){var e=t;return te.hasOwnProperty(t)&&(e=te[t]),String.fromCharCode(e)},re=15,ie=100,ne={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},ae={17:2,18:4,21:6,22:8,23:10,19:13,20:15},oe={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},se={25:2,26:4,29:6,30:8,31:10,27:13,28:15},le=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];!function(t){t[t.ERROR=0]="ERROR",t[t.TEXT=1]="TEXT",t[t.WARNING=2]="WARNING",t[t.INFO=2]="INFO",t[t.DEBUG=3]="DEBUG",t[t.DATA=3]="DATA"}(Zt||(Zt={}));var ue=function(){function t(){this.time=null,this.verboseLevel=Zt.ERROR}return t.prototype.log=function(t,e){this.verboseLevel>=t&&c.logger.log(this.time+" ["+t+"] "+e)},t}(),ce=function(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r].toString(16));return e},he=function(){function t(t,e,r,i,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=e||!1,this.italics=r||!1,this.background=i||"black",this.flash=n||!1}var e=t.prototype;return e.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},e.setStyles=function(t){for(var e=["foreground","underline","italics","background","flash"],r=0;r<e.length;r++){var i=e[r];t.hasOwnProperty(i)&&(this[i]=t[i])}},e.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},e.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},e.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},e.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),de=function(){function t(t,e,r,i,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new he(e,r,i,n,a)}var e=t.prototype;return e.reset=function(){this.uchar=" ",this.penState.reset()},e.setChar=function(t,e){this.uchar=t,this.penState.copy(e)},e.setPenState=function(t){this.penState.copy(t)},e.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},e.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},e.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),fe=function(){function t(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var e=0;e<ie;e++)this.chars.push(new de);this.logger=t,this.pos=0,this.currPenState=new he}var e=t.prototype;return e.equals=function(t){for(var e=!0,r=0;r<ie;r++)if(!this.chars[r].equals(t.chars[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<ie;e++)this.chars[e].copy(t.chars[e])},e.isEmpty=function(){for(var t=!0,e=0;e<ie;e++)if(!this.chars[e].isEmpty()){t=!1;break}return t},e.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(Zt.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>ie&&(this.logger.log(Zt.DEBUG,"Too large cursor position "+this.pos),this.pos=ie)},e.moveCursor=function(t){var e=this.pos+t;if(t>1)for(var r=this.pos+1;r<e+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(e)},e.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},e.insertChar=function(t){t>=144&&this.backSpace();var e=ee(t);this.pos>=ie?this.logger.log(Zt.ERROR,"Cannot insert "+t.toString(16)+" ("+e+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(e,this.currPenState),this.moveCursor(1))},e.clearFromPos=function(t){var e;for(e=t;e<ie;e++)this.chars[e].reset()},e.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},e.clearToEndOfRow=function(){this.clearFromPos(this.pos)},e.getTextString=function(){for(var t=[],e=!0,r=0;r<ie;r++){var i=this.chars[r].uchar;" "!==i&&(e=!1),t.push(i)}return e?"":t.join("")},e.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},t}(),pe=function(){function t(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var e=0;e<re;e++)this.rows.push(new fe(t));this.logger=t,this.currRow=re-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var e=t.prototype;return e.reset=function(){for(var t=0;t<re;t++)this.rows[t].clear();this.currRow=re-1},e.equals=function(t){for(var e=!0,r=0;r<re;r++)if(!this.rows[r].equals(t.rows[r])){e=!1;break}return e},e.copy=function(t){for(var e=0;e<re;e++)this.rows[e].copy(t.rows[e])},e.isEmpty=function(){for(var t=!0,e=0;e<re;e++)if(!this.rows[e].isEmpty()){t=!1;break}return t},e.backSpace=function(){this.rows[this.currRow].backSpace()},e.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},e.insertChar=function(t){this.rows[this.currRow].insertChar(t)},e.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},e.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},e.setCursor=function(t){this.logger.log(Zt.INFO,"setCursor: "+t),this.rows[this.currRow].setCursor(t)},e.setPAC=function(t){this.logger.log(Zt.INFO,"pacData = "+JSON.stringify(t));var e=t.row-1;if(this.nrRollUpRows&&e<this.nrRollUpRows-1&&(e=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==e){for(var r=0;r<re;r++)this.rows[r].clear();var i=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){var a=n.rows[i].cueStartTime,o=this.logger.time;if(a&&null!==o&&a<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[e-this.nrRollUpRows+s+1].copy(n.rows[i+s])}}this.currRow=e;var l=this.rows[this.currRow];if(null!==t.indent){var u=t.indent,c=Math.max(u-1,0);l.setCursor(t.indent),t.color=l.chars[c].penState.foreground}var h={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(h)},e.setBkgData=function(t){this.logger.log(Zt.INFO,"bkgData = "+JSON.stringify(t)),this.backSpace(),this.setPen(t),this.insertChar(32)},e.setRollUpRows=function(t){this.nrRollUpRows=t},e.rollUp=function(){if(null!==this.nrRollUpRows){this.logger.log(Zt.TEXT,this.getDisplayText());var t=this.currRow+1-this.nrRollUpRows,e=this.rows.splice(t,1)[0];e.clear(),this.rows.splice(this.currRow,0,e),this.logger.log(Zt.INFO,"Rolling up")}else this.logger.log(Zt.DEBUG,"roll_up but nrRollUpRows not set yet")},e.getDisplayText=function(t){t=t||!1;for(var e=[],r="",i=-1,n=0;n<re;n++){var a=this.rows[n].getTextString();a&&(i=n+1,t?e.push("Row "+i+": '"+a+"'"):e.push(a.trim()))}return e.length>0&&(r=t?"["+e.join(" | ")+"]":e.join("\n")),r},e.getTextAndFormat=function(){return this.rows},t}(),ge=function(){function t(t,e,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=e,this.mode=null,this.verbose=0,this.displayedMemory=new pe(r),this.nonDisplayedMemory=new pe(r),this.lastOutputScreen=new pe(r),this.currRollUpRow=this.displayedMemory.rows[re-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}var e=t.prototype;return e.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[re-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},e.getHandler=function(){return this.outputFilter},e.setHandler=function(t){this.outputFilter=t},e.setPAC=function(t){this.writeScreen.setPAC(t)},e.setBkgData=function(t){this.writeScreen.setBkgData(t)},e.setMode=function(t){t!==this.mode&&(this.mode=t,this.logger.log(Zt.INFO,"MODE="+t),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},e.insertChars=function(t){for(var e=0;e<t.length;e++)this.writeScreen.insertChar(t[e]);var r=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(Zt.INFO,r+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(Zt.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},e.ccRCL=function(){this.logger.log(Zt.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},e.ccBS=function(){this.logger.log(Zt.INFO,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},e.ccAOF=function(){},e.ccAON=function(){},e.ccDER=function(){this.logger.log(Zt.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},e.ccRU=function(t){this.logger.log(Zt.INFO,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},e.ccFON=function(){this.logger.log(Zt.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},e.ccRDC=function(){this.logger.log(Zt.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},e.ccTR=function(){this.logger.log(Zt.INFO,"TR"),this.setMode("MODE_TEXT")},e.ccRTD=function(){this.logger.log(Zt.INFO,"RTD"),this.setMode("MODE_TEXT")},e.ccEDM=function(){this.logger.log(Zt.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},e.ccCR=function(){this.logger.log(Zt.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},e.ccENM=function(){this.logger.log(Zt.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},e.ccEOC=function(){if(this.logger.log(Zt.INFO,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(Zt.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},e.ccTO=function(t){this.logger.log(Zt.INFO,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},e.ccMIDROW=function(t){var e={flash:!1};if(e.underline=t%2==1,e.italics=t>=46,e.italics)e.foreground="white";else{var r=Math.floor(t/2)-16;e.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(Zt.INFO,"MIDROW: "+JSON.stringify(e)),this.writeScreen.setPen(e)},e.outputDataUpdate=function(t){void 0===t&&(t=!1);var e=this.logger.time;null!==e&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,e,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:e):this.cueStartTime=e,this.lastOutputScreen.copy(this.displayedMemory))},e.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},t}();function ve(t,e,r){r.a=t,r.b=e}function me(t,e,r){return r.a===t&&r.b===e}var ye=function(){function t(t,e,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var i=new ue;this.channels=[null,new ge(t,e,i),new ge(t+1,r,i)],this.cmdHistory={a:null,b:null},this.logger=i}var e=t.prototype;return e.getHandler=function(t){return this.channels[t].getHandler()},e.setHandler=function(t,e){this.channels[t].setHandler(e)},e.addData=function(t,e){var r,i,n,a=!1;this.logger.time=t;for(var o=0;o<e.length;o+=2)if(i=127&e[o],n=127&e[o+1],0!==i||0!==n){if(this.logger.log(Zt.DATA,"["+ce([e[o],e[o+1]])+"] -> ("+ce([i,n])+")"),(r=this.parseCmd(i,n))||(r=this.parseMidrow(i,n)),r||(r=this.parsePAC(i,n)),r||(r=this.parseBackgroundAttributes(i,n)),!r&&(a=this.parseChars(i,n))){var s=this.currentChannel;if(s&&s>0)this.channels[s].insertChars(a);else this.logger.log(Zt.WARNING,"No channel found yet. TEXT-MODE?")}r||a||this.logger.log(Zt.WARNING,"Couldn't parse cleaned data "+ce([i,n])+" orig: "+ce([e[o],e[o+1]]))}},e.parseCmd=function(t,e){var r=this.cmdHistory;if(!((20===t||28===t||21===t||29===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=33&&e<=35))return!1;if(me(t,e,r))return ve(null,null,r),this.logger.log(Zt.DEBUG,"Repeated command ("+ce([t,e])+") is dropped"),!0;var i=20===t||21===t||23===t?1:2,n=this.channels[i];return 20===t||21===t||28===t||29===t?32===e?n.ccRCL():33===e?n.ccBS():34===e?n.ccAOF():35===e?n.ccAON():36===e?n.ccDER():37===e?n.ccRU(2):38===e?n.ccRU(3):39===e?n.ccRU(4):40===e?n.ccFON():41===e?n.ccRDC():42===e?n.ccTR():43===e?n.ccRTD():44===e?n.ccEDM():45===e?n.ccCR():46===e?n.ccENM():47===e&&n.ccEOC():n.ccTO(e-32),ve(t,e,r),this.currentChannel=i,!0},e.parseMidrow=function(t,e){var r=0;if((17===t||25===t)&&e>=32&&e<=47){if((r=17===t?1:2)!==this.currentChannel)return this.logger.log(Zt.ERROR,"Mismatch channel in midrow parsing"),!1;var i=this.channels[r];return!!i&&(i.ccMIDROW(e),this.logger.log(Zt.DEBUG,"MIDROW ("+ce([t,e])+")"),!0)}return!1},e.parsePAC=function(t,e){var r,i=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&e>=64&&e<=127)&&!((16===t||24===t)&&e>=64&&e<=95))return!1;if(me(t,e,i))return ve(null,null,i),!0;var n=t<=23?1:2;r=e>=64&&e<=95?1===n?ne[t]:oe[t]:1===n?ae[t]:se[t];var a=this.channels[n];return!!a&&(a.setPAC(this.interpretPAC(r,e)),ve(t,e,i),this.currentChannel=n,!0)},e.interpretPAC=function(t,e){var r=e,i={color:null,italics:!1,indent:null,underline:!1,row:t};return r=e>95?e-96:e-64,i.underline=1==(1&r),r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i},e.parseChars=function(t,e){var r,i=null,n=null;if(t>=25?(r=2,n=t-8):(r=1,n=t),n>=17&&n<=19){var a=e;a=17===n?e+80:18===n?e+112:e+144,this.logger.log(Zt.INFO,"Special char '"+ee(a)+"' in channel "+r),i=[a]}else t>=32&&t<=127&&(i=0===e?[t]:[t,e]);if(i){var o=ce(i);this.logger.log(Zt.DEBUG,"Char codes =  "+o.join(",")),ve(t,e,this.cmdHistory)}return i},e.parseBackgroundAttributes=function(t,e){var r;if(!((16===t||24===t)&&e>=32&&e<=47)&&!((23===t||31===t)&&e>=45&&e<=47))return!1;var i={};16===t||24===t?(r=Math.floor((e-32)/2),i.background=le[r],e%2==1&&(i.background=i.background+"_semi")):45===e?i.background="transparent":(i.foreground="black",47===e&&(i.underline=!0));var n=t<=23?1:2;return this.channels[n].setBkgData(i),ve(t,e,this.cmdHistory),!0},e.reset=function(){for(var t=0;t<Object.keys(this.channels).length;t++){var e=this.channels[t];e&&e.reset()}this.cmdHistory={a:null,b:null}},e.cueSplitAtTime=function(t){for(var e=0;e<this.channels.length;e++){var r=this.channels[e];r&&r.cueSplitAtTime(t)}},t}(),be=function(){function t(t,e){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=e}var e=t.prototype;return e.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},e.newCue=function(t,e,r){(null===this.startTime||this.startTime>t)&&(this.startTime=t),this.endTime=e,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)},e.reset=function(){this.cueRanges=[]},t}(),_e=function(t,e,r){return t.substr(r||0,e.length)===e},Te=function(t){for(var e=5381,r=t.length;r;)e=33*e^t.charCodeAt(--r);return(e>>>0).toString()},Ee={parse:function(t,e,r,i,n,a){var o,s=Object(Tt.utf8ArrayToStr)(new Uint8Array(t)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),u="00:00.000",c=0,h=0,d=0,f=[],p=!0,g=!1,v=new Jt;v.oncue=function(t){var e=r[i],n=r.ccOffset;e&&e.new&&(void 0!==h?n=r.ccOffset=e.start:function(t,e,r){var i=t[e],n=t[i.prevCC];if(!n||!n.new&&i.new)return t.ccOffset=t.presentationOffset=i.start,void(i.new=!1);for(;n&&n.new;)t.ccOffset+=i.start-n.start,i.new=!1,n=t[(i=n).prevCC];t.presentationOffset=r}(r,i,d)),d&&(n=d-r.presentationOffset),g&&(t.startTime+=n-h,t.endTime+=n-h),t.id=Te(t.startTime.toString())+Te(t.endTime.toString())+Te(t.text),t.text=decodeURIComponent(encodeURIComponent(t.text)),t.endTime>0&&f.push(t)},v.onparsingerror=function(t){o=t},v.onflush=function(){o&&a?a(o):n(f)},s.forEach(function(t){if(p){if(_e(t,"X-TIMESTAMP-MAP=")){p=!1,g=!0,t.substr(16).split(",").forEach(function(t){_e(t,"LOCAL:")?u=t.substr(6):_e(t,"MPEGTS:")&&(c=parseInt(t.substr(7)))});try{e+(9e4*r[i].start||0)<0&&(e+=8589934592),c-=e,h=function(t){var e=parseInt(t.substr(-3)),r=parseInt(t.substr(-6,2)),i=parseInt(t.substr(-9,2)),n=t.length>9?parseInt(t.substr(0,t.indexOf(":"))):0;if(!(Object(l.isFiniteNumber)(e)&&Object(l.isFiniteNumber)(r)&&Object(l.isFiniteNumber)(i)&&Object(l.isFiniteNumber)(n)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+t);return e+=1e3*r,e+=6e4*i,e+=36e5*n}(u)/1e3,d=c/9e4}catch(t){g=!1,o=t}return}""===t&&(p=!1)}v.parse(t+"\n")}),v.flush()}};function Se(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function we(t,e){return t&&t.label===e.name&&!(t.textTrack1||t.textTrack2)}var ke=function(t){var e,r;function i(e){var r;if((r=t.call(this,e,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_USERDATA,u.default.FRAG_DECRYPTED,u.default.MANIFEST_LOADING,u.default.MANIFEST_LOADED,u.default.FRAG_LOADED,u.default.INIT_PTS_FOUND)||this).media=null,r.config=void 0,r.enabled=!0,r.Cues=void 0,r.textTracks=[],r.tracks=[],r.initPTS=[],r.unparsedVttFrags=[],r.captionsTracks={},r.nonNativeCaptionsTracks={},r.captionsProperties=void 0,r.cea608Parser1=void 0,r.cea608Parser2=void 0,r.lastSn=-1,r.prevCC=-1,r.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},r.hls=e,r.config=e.config,r.Cues=e.config.cueHandler,r.captionsProperties={textTrack1:{label:r.config.captionsTextTrack1Label,languageCode:r.config.captionsTextTrack1LanguageCode},textTrack2:{label:r.config.captionsTextTrack2Label,languageCode:r.config.captionsTextTrack2LanguageCode},textTrack3:{label:r.config.captionsTextTrack3Label,languageCode:r.config.captionsTextTrack3LanguageCode},textTrack4:{label:r.config.captionsTextTrack4Label,languageCode:r.config.captionsTextTrack4LanguageCode}},r.config.enableCEA708Captions){var i=new be(Se(r),"textTrack1"),n=new be(Se(r),"textTrack2"),a=new be(Se(r),"textTrack3"),o=new be(Se(r),"textTrack4");r.cea608Parser1=new ye(1,i,n),r.cea608Parser2=new ye(3,a,o)}return r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.addCues=function(t,e,r,i,n){for(var a,o,s,l,c=!1,h=n.length;h--;){var d=n[h],f=(a=d[0],o=d[1],s=e,l=r,Math.min(o,l)-Math.max(a,s));if(f>=0&&(d[0]=Math.min(d[0],e),d[1]=Math.max(d[1],r),c=!0,f/(r-e)>.5))return}if(c||n.push([e,r]),this.config.renderTextTracksNatively)this.Cues.newCue(this.captionsTracks[t],e,r,i);else{var p=this.Cues.newCue(null,e,r,i);this.hls.trigger(u.default.CUES_PARSED,{type:"captions",cues:p,track:t})}},n.onInitPtsFound=function(t){var e=this,r=t.frag,i=t.id,n=t.initPTS,a=this.unparsedVttFrags;"main"===i&&(this.initPTS[r.cc]=n),a.length&&(this.unparsedVttFrags=[],a.forEach(function(t){e.onFragLoaded(t)}))},n.getExistingTrack=function(t){var e=this.media;if(e)for(var r=0;r<e.textTracks.length;r++){var i=e.textTracks[r];if(i[t])return i}return null},n.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},n.createNativeTrack=function(t){if(!this.captionsTracks[t]){var e=this.captionsProperties,r=this.captionsTracks,i=this.media,n=e[t],a=n.label,o=n.languageCode,s=this.getExistingTrack(t);if(s)r[t]=s,St(r[t]),Et(r[t],i);else{var l=this.createTextTrack("captions",a,o);l&&(l[t]=!0,r[t]=l)}}},n.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var e=this.captionsProperties[t];if(e){var r={_id:t,label:e.label,kind:"captions",default:!!e.media&&!!e.media.default,closedCaptions:e.media};this.nonNativeCaptionsTracks[t]=r,this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}},n.createTextTrack=function(t,e,r){var i=this.media;if(i)return i.addTextTrack(t,e,r)},n.destroy=function(){t.prototype.destroy.call(this)},n.onMediaAttaching=function(t){this.media=t.media,this._cleanTracks()},n.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(e){St(t[e]),delete t[e]}),this.nonNativeCaptionsTracks={}},n.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={}},n._cleanTracks=function(){var t=this.media;if(t){var e=t.textTracks;if(e)for(var r=0;r<e.length;r++)St(e[r])}},n.onManifestLoaded=function(t){var e=this;if(this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset()),this.config.enableWebVTT){var r=t.subtitles||[],i=this.tracks&&r&&this.tracks.length===r.length;if(this.tracks=t.subtitles||[],this.config.renderTextTracksNatively){var n=this.media?this.media.textTracks:[];this.tracks.forEach(function(t,r){var i;if(r<n.length){for(var a=null,o=0;o<n.length;o++)if(we(n[o],t)){a=n[o];break}a&&(i=a)}i||(i=e.createTextTrack("subtitles",t.name,t.lang)),t.default?i.mode=e.hls.subtitleDisplay?"showing":"hidden":i.mode="disabled",e.textTracks.push(i)})}else if(!i&&this.tracks&&this.tracks.length){var a=this.tracks.map(function(t){return{label:t.name,kind:t.type.toLowerCase(),default:t.default,subtitleTrack:t}});this.hls.trigger(u.default.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(function(t){var r=/(?:CC|SERVICE)([1-4])/.exec(t.instreamId);if(r){var i="textTrack"+r[1],n=e.captionsProperties[i];n&&(n.label=t.name,t.lang&&(n.languageCode=t.lang),n.media=t)}})},n.onFragLoaded=function(t){var e=t.frag,r=t.payload,i=this.cea608Parser1,n=this.cea608Parser2,a=this.initPTS,o=this.lastSn,s=this.unparsedVttFrags;if("main"===e.type){var c=e.sn;e.sn!==o+1&&i&&n&&(i.reset(),n.reset()),this.lastSn=c}else if("subtitle"===e.type)if(r.byteLength){if(!Object(l.isFiniteNumber)(a[e.cc]))return s.push(t),void(a.length&&this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e}));var h=e.decryptdata;null!=h&&null!=h.key&&"AES-128"===h.method||this._parseVTTs(e,r)}else this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e})},n._parseVTTs=function(t,e){var r=this,i=this.hls,n=this.prevCC,a=this.textTracks,o=this.vttCCs;o[t.cc]||(o[t.cc]={start:t.start,prevCC:n,new:!0},this.prevCC=t.cc),Ee.parse(e,this.initPTS[t.cc],o,t.cc,function(e){if(r.config.renderTextTracksNatively){var n=a[t.level];if("disabled"===n.mode)return void i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t});e.forEach(function(t){if(!n.cues.getCueById(t.id))try{if(n.addCue(t),!n.cues.getCueById(t.id))throw new Error("addCue is failed for: "+t)}catch(r){c.logger.debug("Failed occurred on adding cues: "+r);var e=new window.TextTrackCue(t.startTime,t.endTime,t.text);e.id=t.id,n.addCue(e)}})}else{var o=r.tracks[t.level].default?"default":"subtitles"+t.level;i.trigger(u.default.CUES_PARSED,{type:"subtitles",cues:e,track:o})}i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(e){c.logger.log("Failed to parse VTT cue: "+e),i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})})},n.onFragDecrypted=function(t){var e=t.frag,r=t.payload;if("subtitle"===e.type){if(!Object(l.isFiniteNumber)(this.initPTS[e.cc]))return void this.unparsedVttFrags.push(t);this._parseVTTs(e,r)}},n.onFragParsingUserdata=function(t){var e=this.cea608Parser1,r=this.cea608Parser2;if(this.enabled&&e&&r)for(var i=0;i<t.samples.length;i++){var n=t.samples[i].bytes;if(n){var a=this.extractCea608Data(n);e.addData(t.samples[i].pts,a[0]),r.addData(t.samples[i].pts,a[1])}}},n.extractCea608Data=function(t){for(var e=31&t[0],r=2,i=[[],[]],n=0;n<e;n++){var a=t[r++],o=127&t[r++],s=127&t[r++],l=3&a;0===o&&0===s||0!=(4&a)&&(0!==l&&1!==l||(i[l].push(o),i[l].push(s)))}return i},i}(d);function Ae(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Ce(t){for(var e=[],r=0;r<t.length;r++){var i=t[r];"subtitles"===i.kind&&i.label&&e.push(t[r])}return e}var xe=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADED,u.default.SUBTITLE_TRACK_LOADED)||this).tracks=[],r.trackId=-1,r.media=null,r.stopped=!0,r.subtitleDisplay=!0,r.queuedDefaultTrack=null,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,s=i.prototype;return s.destroy=function(){d.prototype.destroy.call(this)},s.onMediaAttached=function(t){var e=this;this.media=t.media,this.media&&(Object(l.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){e.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},s.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(l.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),Ce(this.media.textTracks).forEach(function(t){St(t)}),this.subtitleTrack=-1,this.media=null)},s.onManifestLoaded=function(t){var e=this,r=t.subtitles||[];this.tracks=r,this.hls.trigger(u.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:r}),r.forEach(function(t){t.default&&(e.media?e.subtitleTrack=t.id:e.queuedDefaultTrack=t.id)})},s.onSubtitleTrackLoaded=function(t){var e=this,r=t.id,i=t.details,n=this.trackId,a=this.tracks,o=a[n];if(r>=a.length||r!==n||!o||this.stopped)this._clearReloadTimer();else if(c.logger.log("subtitle track "+r+" loaded"),i.live){var s=nt(o.details,i,t.stats.trequest);c.logger.log("Reloading live subtitle playlist in "+s+"ms"),this.timer=setTimeout(function(){e._loadCurrentTrack()},s)}else this._clearReloadTimer()},s.startLoad=function(){this.stopped=!1,this._loadCurrentTrack()},s.stopLoad=function(){this.stopped=!0,this._clearReloadTimer()},s._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},s._loadCurrentTrack=function(){var t=this.trackId,e=this.tracks,r=this.hls,i=e[t];t<0||!i||i.details&&!i.details.live||(c.logger.log("Loading subtitle track "+t),r.trigger(u.default.SUBTITLE_TRACK_LOADING,{url:i.url,id:t}))},s._toggleTrackModes=function(t){var e=this.media,r=this.subtitleDisplay,i=this.trackId;if(e){var n=Ce(e.textTracks);if(-1===t)[].slice.call(n).forEach(function(t){t.mode="disabled"});else{var a=n[i];a&&(a.mode="disabled")}var o=n[t];o&&(o.mode=r?"showing":"hidden")}},s._setSubtitleTrackInternal=function(t){var e=this.hls,r=this.tracks;!Object(l.isFiniteNumber)(t)||t<-1||t>=r.length||(this.trackId=t,c.logger.log("Switching to subtitle track "+t),e.trigger(u.default.SUBTITLE_TRACK_SWITCH,{id:t}),this._loadCurrentTrack())},s._onTextTracksChanged=function(){if(this.media&&this.hls.config.renderTextTracksNatively){for(var t=-1,e=Ce(this.media.textTracks),r=0;r<e.length;r++)if("hidden"===e[r].mode)t=r;else if("showing"===e[r].mode){t=r;break}this.subtitleTrack=t}},n=i,(a=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(t){this.trackId!==t&&(this._toggleTrackModes(t),this._setSubtitleTrackInternal(t))}}])&&Ae(n.prototype,a),o&&Ae(n,o),i}(d),Re=r("./src/crypt/decrypter.js");var Le,De=window.performance,Oe=function(t){var e,r;function i(e,r){var i;return(i=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.ERROR,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.SUBTITLE_TRACKS_UPDATED,u.default.SUBTITLE_TRACK_SWITCH,u.default.SUBTITLE_TRACK_LOADED,u.default.SUBTITLE_FRAG_PROCESSED,u.default.LEVEL_UPDATED)||this).fragmentTracker=r,i.config=e.config,i.state=pt.STOPPED,i.tracks=[],i.tracksBuffered=[],i.currentTrackId=-1,i.decrypter=new Re.default(e,e.config),i.lastAVStart=0,i._onMediaSeeking=i.onMediaSeeking.bind(function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(i)),i}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n=i.prototype;return n.onSubtitleFragProcessed=function(t){var e=t.frag,r=t.success;if(this.fragPrevious=e,this.state=pt.IDLE,r){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var n,a=e.start,o=0;o<i.length;o++)if(a>=i[o].start&&a<=i[o].end){n=i[o];break}var s=e.start+e.duration;n?n.end=s:(n={start:a,end:s},i.push(n))}}},n.onMediaAttached=function(t){var e=t.media;this.media=e,e.addEventListener("seeking",this._onMediaSeeking),this.state=pt.IDLE},n.onMediaDetaching=function(){var t=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(e){t.tracksBuffered[e.id]=[]}),this.media=null,this.state=pt.STOPPED)},n.onError=function(t){var e=t.frag;e&&"subtitle"===e.type&&(this.state=pt.IDLE)},n.onSubtitleTracksUpdated=function(t){var e=this;c.logger.log("subtitle tracks updated"),this.tracksBuffered=[],this.tracks=t.subtitleTracks,this.tracks.forEach(function(t){e.tracksBuffered[t.id]=[]})},n.onSubtitleTrackSwitch=function(t){if(this.currentTrackId=t.id,this.tracks&&this.tracks.length&&-1!==this.currentTrackId){var e=this.tracks[this.currentTrackId];e&&e.details&&this.setInterval(500)}else this.clearInterval()},n.onSubtitleTrackLoaded=function(t){var e=t.id,r=t.details,i=this.currentTrackId,n=this.tracks,a=n[i];e>=n.length||e!==i||!a||(r.live&&function(t,e,r){void 0===r&&(r=0);var i=-1;it(t,e,function(t,e,r){e.start=t.start,i=r});var n=e.fragments;if(i<0)n.forEach(function(t){t.start+=r});else for(var a=i+1;a<n.length;a++)n[a].start=n[a-1].start+n[a-1].duration}(a.details,r,this.lastAVStart),a.details=r,this.setInterval(500))},n.onKeyLoaded=function(){this.state===pt.KEY_LOADING&&(this.state=pt.IDLE)},n.onFragLoaded=function(t){var e=this.fragCurrent,r=t.frag.decryptdata,i=t.frag,n=this.hls;if(this.state===pt.FRAG_LOADING&&e&&"subtitle"===t.frag.type&&e.sn===t.frag.sn&&t.payload.byteLength>0&&r&&r.key&&"AES-128"===r.method){var a=De.now();this.decrypter.decrypt(t.payload,r.key.buffer,r.iv.buffer,function(t){var e=De.now();n.trigger(u.default.FRAG_DECRYPTED,{frag:i,payload:t,stats:{tstart:a,tdecrypt:e}})})}},n.onLevelUpdated=function(t){var e=t.details.fragments;this.lastAVStart=e.length?e[0].start:0},n.doTick=function(){if(this.media)switch(this.state){case pt.IDLE:var t=this.config,e=this.currentTrackId,r=this.fragmentTracker,i=this.media,n=this.tracks;if(!n||!n[e]||!n[e].details)break;var a,o=t.maxBufferHole,s=t.maxFragLookUpTolerance,l=Math.min(t.maxBufferLength,t.maxMaxBufferLength),h=V.bufferedInfo(this._getBuffered(),i.currentTime,o),d=h.end,f=h.len,p=n[e].details,g=p.fragments,v=g.length,m=g[v-1].start+g[v-1].duration;if(f>l)return;var y=this.fragPrevious;d<m?(y&&p.hasProgramDateTime&&(a=lt(g,y.endProgramDateTime,s)),a||(a=ut(y,g,d,s))):a=g[v-1],a&&a.encrypted?(c.logger.log("Loading key for "+a.sn),this.state=pt.KEY_LOADING,this.hls.trigger(u.default.KEY_LOADING,{frag:a})):a&&r.getState(a)===F&&(this.fragCurrent=a,this.state=pt.FRAG_LOADING,this.hls.trigger(u.default.FRAG_LOADING,{frag:a}))}else this.state=pt.IDLE},n.stopLoad=function(){this.lastAVStart=0,t.prototype.stopLoad.call(this)},n._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},n.onMediaSeeking=function(){this.fragPrevious=null},i}(gt);!function(t){t.WIDEVINE="com.widevine.alpha",t.PLAYREADY="com.microsoft.playready"}(Le||(Le={}));var Ie="undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null;function Pe(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var Me=function(t){var e,r;function i(e){var r;return(r=t.call(this,e,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHED,u.default.MANIFEST_PARSED)||this)._widevineLicenseUrl=void 0,r._licenseXhrSetup=void 0,r._emeEnabled=void 0,r._requestMediaKeySystemAccess=void 0,r._drmSystemOptions=void 0,r._config=void 0,r._mediaKeysList=[],r._media=null,r._hasSetMediaKeys=!1,r._requestLicenseFailureCount=0,r.mediaKeysPromise=null,r._onMediaEncrypted=function(t){if(c.logger.log('Media is encrypted using "'+t.initDataType+'" init data type'),!r.mediaKeysPromise)return c.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),void r.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});var e=function(e){r._media&&(r._attemptSetMediaKeys(e),r._generateRequestWithPreferredKeySession(t.initDataType,t.initData))};r.mediaKeysPromise.then(e).catch(e)},r._config=e.config,r._widevineLicenseUrl=r._config.widevineLicenseUrl,r._licenseXhrSetup=r._config.licenseXhrSetup,r._emeEnabled=r._config.emeEnabled,r._requestMediaKeySystemAccess=r._config.requestMediaKeySystemAccessFunc,r._drmSystemOptions=e.config.drmSystemOptions,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r;var n,a,o,l=i.prototype;return l.getLicenseServerUrl=function(t){switch(t){case Le.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+t+'"')},l._attemptKeySystemAccess=function(t,e,r){var i=this,n=function(t,e,r,i){switch(t){case Le.WIDEVINE:return function(t,e,r){var i={audioCapabilities:[],videoCapabilities:[]};return t.forEach(function(t){i.audioCapabilities.push({contentType:'audio/mp4; codecs="'+t+'"',robustness:r.audioRobustness||""})}),e.forEach(function(t){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+t+'"',robustness:r.videoRobustness||""})}),[i]}(e,r,i);default:throw new Error("Unknown key-system: "+t)}}(t,e,r,this._drmSystemOptions);c.logger.log("Requesting encrypted media key-system access");var a=this.requestMediaKeySystemAccess(t,n);this.mediaKeysPromise=a.then(function(e){return i._onMediaKeySystemAccessObtained(t,e)}),a.catch(function(e){c.logger.error('Failed to obtain key-system "'+t+'" access:',e)})},l._onMediaKeySystemAccessObtained=function(t,e){var r=this;c.logger.log('Access for key-system "'+t+'" obtained');var i={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:e,mediaKeySystemDomain:t};this._mediaKeysList.push(i);var n=Promise.resolve().then(function(){return e.createMediaKeys()}).then(function(e){return i.mediaKeys=e,c.logger.log('Media-keys created for key-system "'+t+'"'),r._onMediaKeysCreated(),e});return n.catch(function(t){c.logger.error("Failed to create media-keys:",t)}),n},l._onMediaKeysCreated=function(){var t=this;this._mediaKeysList.forEach(function(e){e.mediaKeysSession||(e.mediaKeysSession=e.mediaKeys.createSession(),t._onNewMediaKeySession(e.mediaKeysSession))})},l._onNewMediaKeySession=function(t){var e=this;c.logger.log("New key-system session "+t.sessionId),t.addEventListener("message",function(r){e._onKeySessionMessage(t,r.message)},!1)},l._onKeySessionMessage=function(t,e){c.logger.log("Got EME message event, creating license request"),this._requestLicense(e,function(e){c.logger.log("Received license data (length: "+(e?e.byteLength:e)+"), updating key-session"),t.update(e)})},l._attemptSetMediaKeys=function(t){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var e=this._mediaKeysList[0];if(!e||!e.mediaKeys)return c.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});c.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(e.mediaKeys),this._hasSetMediaKeys=!0}},l._generateRequestWithPreferredKeySession=function(t,e){var r=this,i=this._mediaKeysList[0];if(!i)return c.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(i.mediaKeysSessionInitialized)c.logger.warn("Key-Session already initialized but requested again");else{var n=i.mediaKeysSession;if(!n)return c.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});if(!e)return c.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});c.logger.log('Generating key-session request for "'+t+'" init data type'),i.mediaKeysSessionInitialized=!0,n.generateRequest(t,e).then(function(){c.logger.debug("Key-session generation succeeded")}).catch(function(t){c.logger.error("Error generating key-session request:",t),r.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})}},l._createLicenseXhr=function(t,e,r){var i=new XMLHttpRequest,n=this._licenseXhrSetup;try{if(n)try{n(i,t)}catch(e){i.open("POST",t,!0),n(i,t)}i.readyState||i.open("POST",t,!0)}catch(t){throw new Error("issue setting up KeySystem license XHR "+t)}return i.responseType="arraybuffer",i.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,i,t,e,r),i},l._onLicenseRequestReadyStageChange=function(t,e,r,i){switch(t.readyState){case 4:if(200===t.status)this._requestLicenseFailureCount=0,c.logger.log("License request succeeded"),"arraybuffer"!==t.responseType&&c.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),i(t.response);else{if(c.logger.error("License Request XHR failed ("+e+"). Status: "+t.status+" ("+t.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>3)return void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});var n=3-this._requestLicenseFailureCount+1;c.logger.warn("Retrying license request, "+n+" attempts left"),this._requestLicense(r,i)}}},l._generateLicenseRequestChallenge=function(t,e){switch(t.mediaKeySystemDomain){case Le.WIDEVINE:return e}throw new Error("unsupported key-system: "+t.mediaKeySystemDomain)},l._requestLicense=function(t,e){c.logger.log("Requesting content license for key-system");var r=this._mediaKeysList[0];if(!r)return c.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var i=this.getLicenseServerUrl(r.mediaKeySystemDomain),n=this._createLicenseXhr(i,t,e);c.logger.log("Sending license request to URL: "+i);var a=this._generateLicenseRequestChallenge(r,t);n.send(a)}catch(t){c.logger.error("Failure requesting DRM license: "+t),this.hls.trigger(u.default.ERROR,{type:s.ErrorTypes.KEY_SYSTEM_ERROR,details:s.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},l.onMediaAttached=function(t){if(this._emeEnabled){var e=t.media;this._media=e,e.addEventListener("encrypted",this._onMediaEncrypted)}},l.onMediaDetached=function(){var t=this._media,e=this._mediaKeysList;t&&(t.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(e.map(function(t){if(t.mediaKeysSession)return t.mediaKeysSession.close().catch(function(){})})).then(function(){return t.setMediaKeys(null)}).catch(function(){}))},l.onManifestParsed=function(t){if(this._emeEnabled){var e=t.levels.map(function(t){return t.audioCodec}),r=t.levels.map(function(t){return t.videoCodec});this._attemptKeySystemAccess(Le.WIDEVINE,e,r)}},n=i,(a=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&Pe(n.prototype,a),o&&Pe(n,o),i}(d);function Ne(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function Fe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ne(Object(r),!0).forEach(function(e){Be(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ne(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function Be(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var je=Fe(Fe({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:Nt,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:Rt,bufferController:Dt,capLevelController:It,fpsController:Mt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:Ie,testBandwidth:!0},{cueHandler:i,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Oe,subtitleTrackController:xe,timelineController:ke,audioStreamController:Gt,audioTrackController:Bt,emeController:Me});function Ue(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function Ge(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ue(Object(r),!0).forEach(function(e){He(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ue(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function He(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ve(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ke(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function We(t,e,r){return e&&Ke(t.prototype,e),r&&Ke(t,r),t}var ze=function(t){var e,r;function i(e){var r;void 0===e&&(e={}),(r=t.call(this)||this).config=void 0,r._autoLevelCapping=void 0,r.abrController=void 0,r.capLevelController=void 0,r.levelController=void 0,r.streamController=void 0,r.networkControllers=void 0,r.audioTrackController=void 0,r.subtitleTrackController=void 0,r.emeController=void 0,r.coreComponents=void 0,r.media=null,r.url=null;var n=i.DefaultConfig;if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");r.config=Ge(Ge({},n),e);var a=Ve(r).config;if(void 0!==a.liveMaxLatencyDurationCount&&a.liveMaxLatencyDurationCount<=a.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==a.liveMaxLatencyDuration&&(void 0===a.liveSyncDuration||a.liveMaxLatencyDuration<=a.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(c.enableLogs)(a.debug),r._autoLevelCapping=-1;var o=r.abrController=new a.abrController(Ve(r)),s=new a.bufferController(Ve(r)),l=r.capLevelController=new a.capLevelController(Ve(r)),u=new a.fpsController(Ve(r)),h=new P(Ve(r)),d=new M(Ve(r)),f=new N(Ve(r)),p=new wt(Ve(r)),g=r.levelController=new _t(Ve(r)),v=new G(Ve(r)),m=[g,r.streamController=new yt(Ve(r),v)],y=a.audioStreamController;y&&m.push(new y(Ve(r),v)),r.networkControllers=m;var b=[h,d,f,o,s,l,u,p,v];if(y=a.audioTrackController){var _=new y(Ve(r));r.audioTrackController=_,b.push(_)}if(y=a.subtitleTrackController){var T=new y(Ve(r));r.subtitleTrackController=T,m.push(T)}if(y=a.emeController){var E=new y(Ve(r));r.emeController=E,b.push(E)}return(y=a.subtitleStreamController)&&m.push(new y(Ve(r),v)),(y=a.timelineController)&&b.push(new y(Ve(r))),r.coreComponents=b,r}r=t,(e=i).prototype=Object.create(r.prototype),e.prototype.constructor=e,e.__proto__=r,i.isSupported=function(){return function(){var t=q();if(!t)return!1;var e=self.SourceBuffer||self.WebKitSourceBuffer,r=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),i=!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove;return!!r&&!!i}()},We(i,null,[{key:"version",get:function(){return"0.14.5"}},{key:"Events",get:function(){return u.default}},{key:"ErrorTypes",get:function(){return s.ErrorTypes}},{key:"ErrorDetails",get:function(){return s.ErrorDetails}},{key:"DefaultConfig",get:function(){return i.defaultConfig?i.defaultConfig:je},set:function(t){i.defaultConfig=t}}]);var n=i.prototype;return n.destroy=function(){c.logger.log("destroy"),this.trigger(u.default.DESTROYING),this.detachMedia(),this.coreComponents.concat(this.networkControllers).forEach(function(t){t.destroy()}),this.url=null,this.removeAllListeners(),this._autoLevelCapping=-1},n.attachMedia=function(t){c.logger.log("attachMedia"),this.media=t,this.trigger(u.default.MEDIA_ATTACHING,{media:t})},n.detachMedia=function(){c.logger.log("detachMedia"),this.trigger(u.default.MEDIA_DETACHING),this.media=null},n.loadSource=function(t){t=o.buildAbsoluteURL(window.location.href,t,{alwaysNormalize:!0}),c.logger.log("loadSource:"+t),this.url=t,this.trigger(u.default.MANIFEST_LOADING,{url:t})},n.startLoad=function(t){void 0===t&&(t=-1),c.logger.log("startLoad("+t+")"),this.networkControllers.forEach(function(e){e.startLoad(t)})},n.stopLoad=function(){c.logger.log("stopLoad"),this.networkControllers.forEach(function(t){t.stopLoad()})},n.swapAudioCodec=function(){c.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},n.recoverMediaError=function(){c.logger.log("recoverMediaError");var t=this.media;this.detachMedia(),t&&this.attachMedia(t)},n.removeLevel=function(t,e){void 0===e&&(e=0),this.levelController.removeLevel(t,e)},We(i,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(t){c.logger.log("set currentLevel:"+t),this.loadLevel=t,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(t){c.logger.log("set nextLevel:"+t),this.levelController.manualLevel=t,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(t){c.logger.log("set loadLevel:"+t),this.levelController.manualLevel=t}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(t){this.levelController.nextLoadLevel=t}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(t){c.logger.log("set firstLevel:"+t),this.levelController.firstLevel=t}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(t){c.logger.log("set startLevel:"+t),-1!==t&&(t=Math.max(t,this.minAutoLevel)),this.levelController.startLevel=t}},{key:"capLevelToPlayerSize",set:function(t){var e=!!t;e!==this.config.capLevelToPlayerSize&&(e?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=e)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(t){c.logger.log("set autoLevelCapping:"+t),this._autoLevelCapping=t}},{key:"bandwidthEstimate",get:function(){var t=this.abrController._bwEstimator;return t?t.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,e=this.config.minAutoBitrate,r=t?t.length:0,i=0;i<r;i++){if((t[i].realBitrate?Math.max(t[i].realBitrate,t[i].bitrate):t[i].bitrate)>e)return i}return 0}},{key:"maxAutoLevel",get:function(){var t=this.levels,e=this.autoLevelCapping;return-1===e&&t&&t.length?t.length-1:e}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(t){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,t)}},{key:"audioTracks",get:function(){var t=this.audioTrackController;return t?t.audioTracks:[]}},{key:"audioTrack",get:function(){var t=this.audioTrackController;return t?t.audioTrack:-1},set:function(t){var e=this.audioTrackController;e&&(e.audioTrack=t)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var t=this.subtitleTrackController;return t?t.subtitleTrack:-1},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleTrack=t)}},{key:"subtitleDisplay",get:function(){var t=this.subtitleTrackController;return!!t&&t.subtitleDisplay},set:function(t){var e=this.subtitleTrackController;e&&(e.subtitleDisplay=t)}}]),i}(X);ze.defaultConfig=void 0},"./src/polyfills/number.js":
/*!*********************************!*\
  !*** ./src/polyfills/number.js ***!
  \*********************************/
/*! exports provided: isFiniteNumber, MAX_SAFE_INTEGER */function(t,e,r){"use strict";r.r(e),r.d(e,"isFiniteNumber",function(){return i}),r.d(e,"MAX_SAFE_INTEGER",function(){return n});var i=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},n=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/utils/get-self-scope.js":
/*!*************************************!*\
  !*** ./src/utils/get-self-scope.js ***!
  \*************************************/
/*! exports provided: getSelfScope */function(t,e,r){"use strict";function i(){return"undefined"==typeof window?self:window}r.r(e),r.d(e,"getSelfScope",function(){return i})},"./src/utils/logger.js":
/*!*****************************!*\
  !*** ./src/utils/logger.js ***!
  \*****************************/
/*! exports provided: enableLogs, logger */function(t,e,r){"use strict";r.r(e),r.d(e,"enableLogs",function(){return u}),r.d(e,"logger",function(){return c});var i=r(/*! ./get-self-scope */"./src/utils/get-self-scope.js");function n(){}var a={trace:n,debug:n,log:n,warn:n,info:n,error:n},o=a;var s=Object(i.getSelfScope)();function l(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];r.forEach(function(e){o[e]=t[e]?t[e].bind(t):function(t){var e=s.console[t];return e?function(){for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];i[0]&&(i[0]=function(t,e){return e="["+t+"] > "+e}(t,i[0])),e.apply(s.console,i)}:n}(e)})}var u=function(t){if(s.console&&!0===t||"object"==typeof t){l(t,"debug","log","info","warn","error");try{o.log()}catch(t){o=a}}else o=a},c=o}}).default},t.exports=i())},YqKu:function(t,e,r){!function(){function e(t){t.directive("wechat-title",function(t,e){!function(t,e){if(void 0!==t&&window.document.title!==t){document.title=t;var r=navigator.userAgent.toLowerCase();if(/iphone|ipad|ipod/.test(r)){var i=document.createElement("iframe");i.style.display="none";var n=/alipay/.test(r)?e:e||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";n&&i.setAttribute("src",n);var a=function(){setTimeout(function(){i.removeEventListener("load",a),document.body.removeChild(i)},0)};i.addEventListener("load",a),document.body.appendChild(i)}}}(e.value,t.getAttribute("img-set")||null)})}t.exports=e}()},awF4:function(t,e,r){(function(e){var r;r="undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},t.exports=r}).call(e,r("DuR2"))},"dwO+":function(t,e,r){(function(e){var i,n=void 0!==e?e:"undefined"!=typeof window?window:{},a=r(0);"undefined"!=typeof document?i=document:(i=n["__GLOBAL_DOCUMENT_CACHE@4"])||(i=n["__GLOBAL_DOCUMENT_CACHE@4"]=a),t.exports=i}).call(e,r("DuR2"))},iqGf:function(t,e,r){var i;i=function(t){return function(t){function e(i){if(r[i])return r[i].exports;var n=r[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};return e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,i){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(e,r){e.exports=t},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){return t&&t.__esModule?t:{default:t}}(r(0)),n=window.videojs||i.default;"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t,e){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n)for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(r[a]=n[a])}return r},writable:!0,configurable:!0});var a=["loadeddata","canplay","canplaythrough","play","pause","waiting","playing","ended","error"];e.default={name:"video-player",props:{start:{type:Number,default:0},crossOrigin:{type:String,default:""},playsinline:{type:Boolean,default:!1},customEventName:{type:String,default:"statechanged"},options:{type:Object,required:!0},events:{type:Array,default:function(){return[]}},globalOptions:{type:Object,default:function(){return{controls:!0,controlBar:{remainingTimeDisplay:!1,playToggle:{},progressControl:{},fullscreenToggle:{},volumeMenuButton:{inline:!1,vertical:!0}},techOrder:["html5"],plugins:{}}}},globalEvents:{type:Array,default:function(){return[]}}},data:function(){return{player:null,reseted:!0}},mounted:function(){this.player||this.initialize()},beforeDestroy:function(){this.player&&this.dispose()},methods:{initialize:function(){var t=this,e=Object.assign({},this.globalOptions,this.options);this.playsinline&&(this.$refs.video.setAttribute("playsinline",this.playsinline),this.$refs.video.setAttribute("webkit-playsinline",this.playsinline),this.$refs.video.setAttribute("x5-playsinline",this.playsinline),this.$refs.video.setAttribute("x5-video-player-type","h5"),this.$refs.video.setAttribute("x5-video-player-fullscreen",!1)),""!==this.crossOrigin&&(this.$refs.video.crossOrigin=this.crossOrigin,this.$refs.video.setAttribute("crossOrigin",this.crossOrigin));var r=function(e,r){e&&t.$emit(e,t.player),r&&t.$emit(t.customEventName,function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},e,r))};e.plugins&&delete e.plugins.__ob__;var i=this;this.player=n(this.$refs.video,e,function(){for(var t=this,e=a.concat(i.events).concat(i.globalEvents),n={},o=0;o<e.length;o++)"string"==typeof e[o]&&void 0===n[e[o]]&&function(e){n[e]=null,t.on(e,function(){r(e,!0)})}(e[o]);this.on("timeupdate",function(){r("timeupdate",this.currentTime())}),i.$emit("ready",this)})},dispose:function(t){var e=this;this.player&&this.player.dispose&&("Flash"!==this.player.techName_&&this.player.pause&&this.player.pause(),this.player.dispose(),this.player=null,this.$nextTick(function(){e.reseted=!1,e.$nextTick(function(){e.reseted=!0,e.$nextTick(function(){t&&t()})})}))}},watch:{options:{deep:!0,handler:function(t,e){var r=this;this.dispose(function(){t&&t.sources&&t.sources.length&&r.initialize()})}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),n=r.n(i);for(var a in i)["default","default"].indexOf(a)<0&&function(t){r.d(e,t,function(){return i[t]})}(a);var o=r(5),s=r(4)(n.a,o.a,!1,null,null,null);e.default=s.exports},function(t,e,r){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.install=e.videoPlayer=e.videojs=void 0;var n=i(r(0)),a=i(r(2)),o=window.videojs||n.default,s=function(t,e){e&&(e.options&&(a.default.props.globalOptions.default=function(){return e.options}),e.events&&(a.default.props.globalEvents.default=function(){return e.events})),t.component(a.default.name,a.default)},l={videojs:o,videoPlayer:a.default,install:s};e.default=l,e.videojs=o,e.videoPlayer=a.default,e.install=s},function(t,e){t.exports=function(t,e,r,i,n,a){var o,s=t=t||{},l=typeof t.default;"object"!==l&&"function"!==l||(o=t,s=t.default);var u,c="function"==typeof s?s.options:s;if(e&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0),r&&(c.functional=!0),n&&(c._scopeId=n),a?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),i&&i.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):i&&(u=i),u){var h=c.functional,d=h?c.render:c.beforeCreate;h?(c._injectStyles=u,c.render=function(t,e){return u.call(e),d(t,e)}):c.beforeCreate=d?[].concat(d,u):[u]}return{esModule:o,exports:s,options:c}}},function(t,e,r){"use strict";var i={render:function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.reseted?r("div",{staticClass:"video-player"},[r("video",{ref:"video",staticClass:"video-js"})]):t._e()},staticRenderFns:[]};e.a=i}])},t.exports=i(r("sM+K"))},"q+vg":function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var i=arguments[e];for(var n in i)r.call(i,n)&&(t[n]=i[n])}return t};var r=Object.prototype.hasOwnProperty},sD9O:function(t,e){var r=function(t){return t.replace(/^\s+|\s+$/g,"")};t.exports=function(t){if(!t)return{};for(var e,i={},n=r(t).split("\n"),a=0;a<n.length;a++){var o=n[a],s=o.indexOf(":"),l=r(o.slice(0,s)).toLowerCase(),u=r(o.slice(s+1));void 0===i[l]?i[l]=u:(e=i[l],"[object Array]"===Object.prototype.toString.call(e)?i[l].push(u):i[l]=[i[l],u])}return i}},"sM+K":function(t,e,r){
/**
 * @license
 * Video.js 6.13.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/master/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/master/LICENSE>
 */
function i(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var n,a=i(r("awF4")),o=i(r("dwO+")),s=i(r("sN1u")),l=i(r("I/+Z")),u=i(r("1Xk4")),c=i(r("sUZj")),h="6.13.0",d=a.navigator&&a.navigator.userAgent||"",f=/AppleWebKit\/([\d.]+)/i.exec(d),p=f?parseFloat(f.pop()):null,g=/iPad/i.test(d),v=/iPhone/i.test(d)&&!g,m=/iPod/i.test(d),y=v||g||m,b=(n=d.match(/OS (\d+)_/i))&&n[1]?n[1]:null,_=/Android/i.test(d),T=function(){var t=d.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!t)return null;var e=t[1]&&parseFloat(t[1]),r=t[2]&&parseFloat(t[2]);return e&&r?parseFloat(t[1]+"."+t[2]):e||null}(),E=_&&/webkit/i.test(d)&&T<2.3,S=_&&T<5&&p<537,w=/Firefox/i.test(d),k=/Edge/i.test(d),A=!k&&(/Chrome/i.test(d)||/CriOS/i.test(d)),C=function(){var t=d.match(/(Chrome|CriOS)\/(\d+)/);return t&&t[2]?parseFloat(t[2]):null}(),x=/MSIE\s8\.0/.test(d),R=function(){var t=/MSIE\s(\d+)\.\d/.exec(d),e=t&&parseFloat(t[1]);return!e&&/Trident\/7.0/i.test(d)&&/rv:11.0/.test(d)&&(e=11),e}(),L=/Safari/i.test(d)&&!A&&!_&&!k,D=(L||y)&&!A,O=tt()&&("ontouchstart"in a||a.navigator.maxTouchPoints||a.DocumentTouch&&a.document instanceof a.DocumentTouch),I=tt()&&"backgroundSize"in a.document.createElement("video").style,P=(Object.freeze||Object)({IS_IPAD:g,IS_IPHONE:v,IS_IPOD:m,IS_IOS:y,IOS_VERSION:b,IS_ANDROID:_,ANDROID_VERSION:T,IS_OLD_ANDROID:E,IS_NATIVE_ANDROID:S,IS_FIREFOX:w,IS_EDGE:k,IS_CHROME:A,CHROME_VERSION:C,IS_IE8:x,IE_VERSION:R,IS_SAFARI:L,IS_ANY_SAFARI:D,TOUCH_ENABLED:O,BACKGROUND_SIZE_SUPPORTED:I}),M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},F=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},B=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},j=function(t,e){return t.raw=e,t},U=Object.prototype.toString,G=function(t){return K(t)?Object.keys(t):[]};function H(t,e){G(t).forEach(function(r){return e(t[r],r)})}function V(t){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return Object.assign?Object.assign.apply(Object,[t].concat(r)):(r.forEach(function(e){e&&H(e,function(e,r){t[r]=e})}),t)}function K(t){return!!t&&"object"===(void 0===t?"undefined":M(t))}function W(t){return K(t)&&"[object Object]"===U.call(t)&&t.constructor===Object}var z=[],q=function(t,e){return function(r,i,n,o){var s=e.levels[i],l=new RegExp("^("+s+")$");if("log"!==r&&n.unshift(r.toUpperCase()+":"),n.unshift(t+":"),z&&z.push([].concat(n)),a.console){var u=a.console[r];u||"debug"!==r||(u=a.console.info||a.console.log),u&&s&&l.test(r)&&(o&&(n=n.map(function(t){if(K(t)||Array.isArray(t))try{return JSON.stringify(t)}catch(e){return String(t)}return String(t)}).join(" ")),u.apply?u[Array.isArray(n)?"apply":"call"](a.console,n):u(n))}}};var Y=function t(e){var r="info",i=void 0,n=function t(){for(var e=t.stringify||R&&R<11,n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];i("log",r,a,e)};return i=q(e,n),n.createLogger=function(r){return t(e+": "+r)},n.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:r},n.level=function(t){if("string"==typeof t){if(!n.levels.hasOwnProperty(t))throw new Error('"'+t+'" in not a valid log level');r=t}return r},(n.history=function(){return z?[].concat(z):[]}).filter=function(t){return(z||[]).filter(function(e){return new RegExp(".*"+t+".*").test(e[0])})},n.history.clear=function(){z&&(z.length=0)},n.history.disable=function(){null!==z&&(z.length=0,z=null)},n.history.enable=function(){null===z&&(z=[])},n.error=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i("error",r,e)},n.warn=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i("warn",r,e)},n.debug=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return i("debug",r,e)},n}("VIDEOJS"),X=Y.createLogger;function $(t,e){if(!t||!e)return"";if("function"==typeof a.getComputedStyle){var r=a.getComputedStyle(t);return r?r[e]:""}return t.currentStyle[e]||""}var J=j(["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."],["Setting attributes in the second argument of createEl()\n                has been deprecated. Use the third argument instead.\n                createEl(type, properties, attributes). Attempting to set "," to ","."]);function Q(t){return"string"==typeof t&&/\S/.test(t)}function Z(t){if(/\s/.test(t))throw new Error("class has illegal whitespace characters")}function tt(){return o===a.document&&void 0!==o.createElement}function et(t){return K(t)&&1===t.nodeType}function rt(){try{return a.parent!==a.self}catch(t){return!0}}function it(t){return function(e,r){if(!Q(e))return o[t](null);Q(r)&&(r=o.querySelector(r));var i=et(r)?r:o;return i[t]&&i[t](e)}}function nt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],n=o.createElement(t);return Object.getOwnPropertyNames(e).forEach(function(t){var r=e[t];-1!==t.indexOf("aria-")||"role"===t||"type"===t?(Y.warn(s(J,t,r)),n.setAttribute(t,r)):"textContent"===t?at(n,r):n[t]=r}),Object.getOwnPropertyNames(r).forEach(function(t){n.setAttribute(t,r[t])}),i&&wt(n,i),n}function at(t,e){return void 0===t.textContent?t.innerText=e:t.textContent=e,t}function ot(t,e){e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t)}function st(t,e){return Z(e),t.classList?t.classList.contains(e):(r=e,new RegExp("(^|\\s)"+r+"($|\\s)")).test(t.className);var r}function lt(t,e){return t.classList?t.classList.add(e):st(t,e)||(t.className=(t.className+" "+e).trim()),t}function ut(t,e){return t.classList?t.classList.remove(e):(Z(e),t.className=t.className.split(/\s+/).filter(function(t){return t!==e}).join(" ")),t}function ct(t,e,r){var i=st(t,e);if("function"==typeof r&&(r=r(t,e)),"boolean"!=typeof r&&(r=!i),r!==i)return r?lt(t,e):ut(t,e),t}function ht(t,e){Object.getOwnPropertyNames(e).forEach(function(r){var i=e[r];null===i||void 0===i||!1===i?t.removeAttribute(r):t.setAttribute(r,!0===i?"":i)})}function dt(t){var e={},r=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(t&&t.attributes&&t.attributes.length>0)for(var i=t.attributes,n=i.length-1;n>=0;n--){var a=i[n].name,o=i[n].value;"boolean"!=typeof t[a]&&-1===r.indexOf(","+a+",")||(o=null!==o),e[a]=o}return e}function ft(t,e){return t.getAttribute(e)}function pt(t,e,r){t.setAttribute(e,r)}function gt(t,e){t.removeAttribute(e)}function vt(){o.body.focus(),o.onselectstart=function(){return!1}}function mt(){o.onselectstart=function(){return!0}}function yt(t){if(t&&t.getBoundingClientRect&&t.parentNode){var e=t.getBoundingClientRect(),r={};return["bottom","height","left","right","top","width"].forEach(function(t){void 0!==e[t]&&(r[t]=e[t])}),r.height||(r.height=parseFloat($(t,"height"))),r.width||(r.width=parseFloat($(t,"width"))),r}}function bt(t){var e=void 0;if(t.getBoundingClientRect&&t.parentNode&&(e=t.getBoundingClientRect()),!e)return{left:0,top:0};var r=o.documentElement,i=o.body,n=r.clientLeft||i.clientLeft||0,s=a.pageXOffset||i.scrollLeft,l=e.left+s-n,u=r.clientTop||i.clientTop||0,c=a.pageYOffset||i.scrollTop,h=e.top+c-u;return{left:Math.round(l),top:Math.round(h)}}function _t(t,e){var r={},i=bt(t),n=t.offsetWidth,a=t.offsetHeight,o=i.top,s=i.left,l=e.pageY,u=e.pageX;return e.changedTouches&&(u=e.changedTouches[0].pageX,l=e.changedTouches[0].pageY),r.y=Math.max(0,Math.min(1,(o-l+a)/a)),r.x=Math.max(0,Math.min(1,(u-s)/n)),r}function Tt(t){return K(t)&&3===t.nodeType}function Et(t){for(;t.firstChild;)t.removeChild(t.firstChild);return t}function St(t){return"function"==typeof t&&(t=t()),(Array.isArray(t)?t:[t]).map(function(t){return"function"==typeof t&&(t=t()),et(t)||Tt(t)?t:"string"==typeof t&&/\S/.test(t)?o.createTextNode(t):void 0}).filter(function(t){return t})}function wt(t,e){return St(e).forEach(function(e){return t.appendChild(e)}),t}function kt(t,e){return wt(Et(t),e)}function At(t){return void 0===t.button&&void 0===t.buttons||(0===t.button&&void 0===t.buttons||(9===R||0===t.button&&1===t.buttons))}var Ct=it("querySelector"),xt=it("querySelectorAll"),Rt=(Object.freeze||Object)({isReal:tt,isEl:et,isInFrame:rt,createEl:nt,textContent:at,prependTo:ot,hasClass:st,addClass:lt,removeClass:ut,toggleClass:ct,setAttributes:ht,getAttributes:dt,getAttribute:ft,setAttribute:pt,removeAttribute:gt,blockTextSelection:vt,unblockTextSelection:mt,getBoundingClientRect:yt,findPosition:bt,getPointerPosition:_t,isTextNode:Tt,emptyEl:Et,normalizeContent:St,appendContent:wt,insertContent:kt,isSingleLeftClick:At,$:Ct,$$:xt}),Lt=1;function Dt(){return Lt++}var Ot={},It="vdata"+(new Date).getTime();function Pt(t){var e=t[It];return e||(e=t[It]=Dt()),Ot[e]||(Ot[e]={}),Ot[e]}function Mt(t){var e=t[It];return!!e&&!!Object.getOwnPropertyNames(Ot[e]).length}function Nt(t){var e=t[It];if(e){delete Ot[e];try{delete t[It]}catch(e){t.removeAttribute?t.removeAttribute(It):t[It]=null}}}function Ft(t,e){var r=Pt(t);0===r.handlers[e].length&&(delete r.handlers[e],t.removeEventListener?t.removeEventListener(e,r.dispatcher,!1):t.detachEvent&&t.detachEvent("on"+e,r.dispatcher)),Object.getOwnPropertyNames(r.handlers).length<=0&&(delete r.handlers,delete r.dispatcher,delete r.disabled),0===Object.getOwnPropertyNames(r).length&&Nt(t)}function Bt(t,e,r,i){r.forEach(function(r){t(e,r,i)})}function jt(t){function e(){return!0}function r(){return!1}if(!t||!t.isPropagationStopped){var i=t||a.event;for(var n in t={},i)"layerX"!==n&&"layerY"!==n&&"keyLocation"!==n&&"webkitMovementX"!==n&&"webkitMovementY"!==n&&("returnValue"===n&&i.preventDefault||(t[n]=i[n]));if(t.target||(t.target=t.srcElement||o),t.relatedTarget||(t.relatedTarget=t.fromElement===t.target?t.toElement:t.fromElement),t.preventDefault=function(){i.preventDefault&&i.preventDefault(),t.returnValue=!1,i.returnValue=!1,t.defaultPrevented=!0},t.defaultPrevented=!1,t.stopPropagation=function(){i.stopPropagation&&i.stopPropagation(),t.cancelBubble=!0,i.cancelBubble=!0,t.isPropagationStopped=e},t.isPropagationStopped=r,t.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation(),t.isImmediatePropagationStopped=e,t.stopPropagation()},t.isImmediatePropagationStopped=r,null!==t.clientX&&void 0!==t.clientX){var s=o.documentElement,l=o.body;t.pageX=t.clientX+(s&&s.scrollLeft||l&&l.scrollLeft||0)-(s&&s.clientLeft||l&&l.clientLeft||0),t.pageY=t.clientY+(s&&s.scrollTop||l&&l.scrollTop||0)-(s&&s.clientTop||l&&l.clientTop||0)}t.which=t.charCode||t.keyCode,null!==t.button&&void 0!==t.button&&(t.button=1&t.button?0:4&t.button?1:2&t.button?2:0)}return t}var Ut=!1;!function(){try{var t=Object.defineProperty({},"passive",{get:function(){Ut=!0}});a.addEventListener("test",null,t),a.removeEventListener("test",null,t)}catch(t){}}();var Gt=["touchstart","touchmove"];function Ht(t,e,r){if(Array.isArray(e))return Bt(Ht,t,e,r);var i=Pt(t);if(i.handlers||(i.handlers={}),i.handlers[e]||(i.handlers[e]=[]),r.guid||(r.guid=Dt()),i.handlers[e].push(r),i.dispatcher||(i.disabled=!1,i.dispatcher=function(e,r){if(!i.disabled){e=jt(e);var n=i.handlers[e.type];if(n)for(var a=n.slice(0),o=0,s=a.length;o<s&&!e.isImmediatePropagationStopped();o++)try{a[o].call(t,e,r)}catch(t){Y.error(t)}}}),1===i.handlers[e].length)if(t.addEventListener){var n=!1;Ut&&Gt.indexOf(e)>-1&&(n={passive:!0}),t.addEventListener(e,i.dispatcher,n)}else t.attachEvent&&t.attachEvent("on"+e,i.dispatcher)}function Vt(t,e,r){if(Mt(t)){var i=Pt(t);if(i.handlers){if(Array.isArray(e))return Bt(Vt,t,e,r);var n=function(t,e){i.handlers[e]=[],Ft(t,e)};if(void 0!==e){var a=i.handlers[e];if(a)if(r){if(r.guid)for(var o=0;o<a.length;o++)a[o].guid===r.guid&&a.splice(o--,1);Ft(t,e)}else n(t,e)}else for(var s in i.handlers)Object.prototype.hasOwnProperty.call(i.handlers||{},s)&&n(t,s)}}}function Kt(t,e,r){var i=Mt(t)?Pt(t):{},n=t.parentNode||t.ownerDocument;if("string"==typeof e?e={type:e,target:t}:e.target||(e.target=t),e=jt(e),i.dispatcher&&i.dispatcher.call(t,e,r),n&&!e.isPropagationStopped()&&!0===e.bubbles)Kt.call(null,n,e,r);else if(!n&&!e.defaultPrevented){var a=Pt(e.target);e.target[e.type]&&(a.disabled=!0,"function"==typeof e.target[e.type]&&e.target[e.type](),a.disabled=!1)}return!e.defaultPrevented}function Wt(t,e,r){if(Array.isArray(e))return Bt(Wt,t,e,r);var i=function i(){Vt(t,e,i),r.apply(this,arguments)};i.guid=r.guid=r.guid||Dt(),Ht(t,e,i)}var zt=(Object.freeze||Object)({fixEvent:jt,on:Ht,off:Vt,trigger:Kt,one:Wt}),qt=!1,Yt=void 0,Xt=function(){if(tt()&&!1!==Yt.options.autoSetup){var t=o.getElementsByTagName("video"),e=o.getElementsByTagName("audio"),r=o.getElementsByTagName("video-js"),i=[];if(t&&t.length>0)for(var n=0,a=t.length;n<a;n++)i.push(t[n]);if(e&&e.length>0)for(var s=0,l=e.length;s<l;s++)i.push(e[s]);if(r&&r.length>0)for(var u=0,c=r.length;u<c;u++)i.push(r[u]);if(i&&i.length>0)for(var h=0,d=i.length;h<d;h++){var f=i[h];if(!f||!f.getAttribute){$t(1);break}void 0===f.player&&null!==f.getAttribute("data-setup")&&Yt(f)}else qt||$t(1)}};function $t(t,e){e&&(Yt=e),a.setTimeout(Xt,t)}tt()&&"complete"===o.readyState?qt=!0:Wt(a,"load",function(){qt=!0});var Jt=function(t){var e=o.createElement("style");return e.className=t,e},Qt=function(t,e){t.styleSheet?t.styleSheet.cssText=e:t.textContent=e},Zt=function(t,e,r){e.guid||(e.guid=Dt());var i=function(){return e.apply(t,arguments)};return i.guid=r?r+"_"+e.guid:e.guid,i},te=function(t,e){var r=Date.now();return function(){var i=Date.now();i-r>=e&&(t.apply(void 0,arguments),r=i)}},ee=function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:a,n=void 0,o=function(){var a=this,o=arguments,s=function(){n=null,s=null,r||t.apply(a,o)};!n&&r&&t.apply(a,o),i.clearTimeout(n),n=i.setTimeout(s,e)};return o.cancel=function(){i.clearTimeout(n),n=null},o},re=function(){};re.prototype.allowedEvents_={},re.prototype.on=function(t,e){var r=this.addEventListener;this.addEventListener=function(){},Ht(this,t,e),this.addEventListener=r},re.prototype.addEventListener=re.prototype.on,re.prototype.off=function(t,e){Vt(this,t,e)},re.prototype.removeEventListener=re.prototype.off,re.prototype.one=function(t,e){var r=this.addEventListener;this.addEventListener=function(){},Wt(this,t,e),this.addEventListener=r},re.prototype.trigger=function(t){var e=t.type||t;"string"==typeof t&&(t={type:e}),t=jt(t),this.allowedEvents_[e]&&this["on"+e]&&this["on"+e](t),Kt(this,t)},re.prototype.dispatchEvent=re.prototype.trigger;var ie=function(t){return t instanceof re||!!t.eventBusEl_&&["on","one","off","trigger"].every(function(e){return"function"==typeof t[e]})},ne=function(t){return"string"==typeof t&&/\S/.test(t)||Array.isArray(t)&&!!t.length},ae=function(t){if(!t.nodeName&&!ie(t))throw new Error("Invalid target; must be a DOM node or evented object.")},oe=function(t){if(!ne(t))throw new Error("Invalid event type; must be a non-empty string or array.")},se=function(t){if("function"!=typeof t)throw new Error("Invalid listener; must be a function.")},le=function(t,e){var r=e.length<3||e[0]===t||e[0]===t.eventBusEl_,i=void 0,n=void 0,a=void 0;return r?(i=t.eventBusEl_,e.length>=3&&e.shift(),n=e[0],a=e[1]):(i=e[0],n=e[1],a=e[2]),ae(i),oe(n),se(a),{isTargetingSelf:r,target:i,type:n,listener:a=Zt(t,a)}},ue=function(t,e,r,i){ae(t),t.nodeName?zt[e](t,r,i):t[e](r,i)},ce={on:function(){for(var t=this,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];var n=le(this,r),a=n.isTargetingSelf,o=n.target,s=n.type,l=n.listener;if(ue(o,"on",s,l),!a){var u=function(){return t.off(o,s,l)};u.guid=l.guid;var c=function(){return t.off("dispose",u)};c.guid=l.guid,ue(this,"on","dispose",u),ue(o,"on","dispose",c)}},one:function(){for(var t=this,e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];var n=le(this,r),a=n.isTargetingSelf,o=n.target,s=n.type,l=n.listener;if(a)ue(o,"one",s,l);else{var u=function e(){for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];t.off(o,s,e),l.apply(null,i)};u.guid=l.guid,ue(o,"one",s,u)}},off:function(t,e,r){if(!t||ne(t))Vt(this.eventBusEl_,t,e);else{var i=t,n=e;ae(i),oe(n),se(r),r=Zt(this,r),this.off("dispose",r),i.nodeName?(Vt(i,n,r),Vt(i,"dispose",r)):ie(i)&&(i.off(n,r),i.off("dispose",r))}},trigger:function(t,e){return Kt(this.eventBusEl_,t,e)}};function he(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).eventBusKey;if(e){if(!t[e].nodeName)throw new Error('The eventBusKey "'+e+'" does not refer to an element.');t.eventBusEl_=t[e]}else t.eventBusEl_=nt("span",{className:"vjs-event-bus"});return V(t,ce),t.on("dispose",function(){t.off(),a.setTimeout(function(){t.eventBusEl_=null},0)}),t}var de={state:{},setState:function(t){var e=this;"function"==typeof t&&(t=t());var r=void 0;return H(t,function(t,i){e.state[i]!==t&&((r=r||{})[i]={from:e.state[i],to:t}),e.state[i]=t}),r&&ie(this)&&this.trigger({changes:r,type:"statechanged"}),r}};function fe(t,e){return V(t,de),t.state=V({},t.state,e),"function"==typeof t.handleStateChanged&&ie(t)&&t.on("statechanged",t.handleStateChanged),t}function pe(t){return"string"!=typeof t?t:t.charAt(0).toUpperCase()+t.slice(1)}function ge(){for(var t={},e=arguments.length,r=Array(e),i=0;i<e;i++)r[i]=arguments[i];return r.forEach(function(e){e&&H(e,function(e,r){W(e)?(W(t[r])||(t[r]={}),t[r]=ge(t[r],e)):t[r]=e})}),t}var ve=function(){function t(e,r,i){if(N(this,t),!e&&this.play?this.player_=e=this:this.player_=e,this.options_=ge({},this.options_),r=this.options_=ge(this.options_,r),this.id_=r.id||r.el&&r.el.id,!this.id_){var n=e&&e.id&&e.id()||"no_player";this.id_=n+"_component_"+Dt()}this.name_=r.name||null,r.el?this.el_=r.el:!1!==r.createEl&&(this.el_=this.createEl()),!1!==r.evented&&he(this,{eventBusKey:this.el_?"el_":null}),fe(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},!1!==r.initChildren&&this.initChildren(),this.ready(i),!1!==r.reportTouchActivity&&this.enableTouchActivity()}return t.prototype.dispose=function(){if(this.trigger({type:"dispose",bubbles:!1}),this.children_)for(var t=this.children_.length-1;t>=0;t--)this.children_[t].dispose&&this.children_[t].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),Nt(this.el_),this.el_=null),this.player_=null},t.prototype.player=function(){return this.player_},t.prototype.options=function(t){return Y.warn("this.options() has been deprecated and will be moved to the constructor in 6.0"),t?(this.options_=ge(this.options_,t),this.options_):this.options_},t.prototype.el=function(){return this.el_},t.prototype.createEl=function(t,e,r){return nt(t,e,r)},t.prototype.localize=function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,i=this.player_.language&&this.player_.language(),n=this.player_.languages&&this.player_.languages(),a=n&&n[i],o=i&&i.split("-")[0],s=n&&n[o],l=r;return a&&a[t]?l=a[t]:s&&s[t]&&(l=s[t]),e&&(l=l.replace(/\{(\d+)\}/g,function(t,r){var i=e[r-1],n=i;return void 0===i&&(n=t),n})),l},t.prototype.contentEl=function(){return this.contentEl_||this.el_},t.prototype.id=function(){return this.id_},t.prototype.name=function(){return this.name_},t.prototype.children=function(){return this.children_},t.prototype.getChildById=function(t){return this.childIndex_[t]},t.prototype.getChild=function(t){if(t)return t=pe(t),this.childNameIndex_[t]},t.prototype.addChild=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.children_.length,n=void 0,a=void 0;if("string"==typeof e){a=pe(e);var o=r.componentClass||a;r.name=a;var s=t.getComponent(o);if(!s)throw new Error("Component "+o+" does not exist");if("function"!=typeof s)return null;n=new s(this.player_||this,r)}else n=e;if(this.children_.splice(i,0,n),"function"==typeof n.id&&(this.childIndex_[n.id()]=n),(a=a||n.name&&pe(n.name()))&&(this.childNameIndex_[a]=n),"function"==typeof n.el&&n.el()){var l=this.contentEl().children[i]||null;this.contentEl().insertBefore(n.el(),l)}return n},t.prototype.removeChild=function(t){if("string"==typeof t&&(t=this.getChild(t)),t&&this.children_){for(var e=!1,r=this.children_.length-1;r>=0;r--)if(this.children_[r]===t){e=!0,this.children_.splice(r,1);break}if(e){this.childIndex_[t.id()]=null,this.childNameIndex_[t.name()]=null;var i=t.el();i&&i.parentNode===this.contentEl()&&this.contentEl().removeChild(t.el())}}},t.prototype.initChildren=function(){var e=this,r=this.options_.children;if(r){var i=this.options_,n=void 0,a=t.getComponent("Tech");(n=Array.isArray(r)?r:Object.keys(r)).concat(Object.keys(this.options_).filter(function(t){return!n.some(function(e){return"string"==typeof e?t===e:t===e.name})})).map(function(t){var i=void 0,n=void 0;return"string"==typeof t?n=r[i=t]||e.options_[i]||{}:(i=t.name,n=t),{name:i,opts:n}}).filter(function(e){var r=t.getComponent(e.opts.componentClass||pe(e.name));return r&&!a.isTech(r)}).forEach(function(t){var r=t.name,n=t.opts;if(void 0!==i[r]&&(n=i[r]),!1!==n){!0===n&&(n={}),n.playerOptions=e.options_.playerOptions;var a=e.addChild(r,n);a&&(e[r]=a)}})}},t.prototype.buildCSSClass=function(){return""},t.prototype.ready=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t)return this.isReady_?void(e?t.call(this):this.setTimeout(t,1)):(this.readyQueue_=this.readyQueue_||[],void this.readyQueue_.push(t))},t.prototype.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var t=this.readyQueue_;this.readyQueue_=[],t&&t.length>0&&t.forEach(function(t){t.call(this)},this),this.trigger("ready")},1)},t.prototype.$=function(t,e){return Ct(t,e||this.contentEl())},t.prototype.$$=function(t,e){return xt(t,e||this.contentEl())},t.prototype.hasClass=function(t){return st(this.el_,t)},t.prototype.addClass=function(t){lt(this.el_,t)},t.prototype.removeClass=function(t){ut(this.el_,t)},t.prototype.toggleClass=function(t,e){ct(this.el_,t,e)},t.prototype.show=function(){this.removeClass("vjs-hidden")},t.prototype.hide=function(){this.addClass("vjs-hidden")},t.prototype.lockShowing=function(){this.addClass("vjs-lock-showing")},t.prototype.unlockShowing=function(){this.removeClass("vjs-lock-showing")},t.prototype.getAttribute=function(t){return ft(this.el_,t)},t.prototype.setAttribute=function(t,e){pt(this.el_,t,e)},t.prototype.removeAttribute=function(t){gt(this.el_,t)},t.prototype.width=function(t,e){return this.dimension("width",t,e)},t.prototype.height=function(t,e){return this.dimension("height",t,e)},t.prototype.dimensions=function(t,e){this.width(t,!0),this.height(e)},t.prototype.dimension=function(t,e,r){if(void 0!==e)return null!==e&&e==e||(e=0),-1!==(""+e).indexOf("%")||-1!==(""+e).indexOf("px")?this.el_.style[t]=e:this.el_.style[t]="auto"===e?"":e+"px",void(r||this.trigger("componentresize"));if(!this.el_)return 0;var i=this.el_.style[t],n=i.indexOf("px");return-1!==n?parseInt(i.slice(0,n),10):parseInt(this.el_["offset"+pe(t)],10)},t.prototype.currentDimension=function(t){var e=0;if("width"!==t&&"height"!==t)throw new Error("currentDimension only accepts width or height value");if("function"==typeof a.getComputedStyle){var r=a.getComputedStyle(this.el_);e=r.getPropertyValue(t)||r[t]}if(0===(e=parseFloat(e))){var i="offset"+pe(t);e=this.el_[i]}return e},t.prototype.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},t.prototype.currentWidth=function(){return this.currentDimension("width")},t.prototype.currentHeight=function(){return this.currentDimension("height")},t.prototype.focus=function(){this.el_.focus()},t.prototype.blur=function(){this.el_.blur()},t.prototype.emitTapEvents=function(){var t=0,e=null,r=void 0;this.on("touchstart",function(i){1===i.touches.length&&(e={pageX:i.touches[0].pageX,pageY:i.touches[0].pageY},t=(new Date).getTime(),r=!0)}),this.on("touchmove",function(t){if(t.touches.length>1)r=!1;else if(e){var i=t.touches[0].pageX-e.pageX,n=t.touches[0].pageY-e.pageY;Math.sqrt(i*i+n*n)>10&&(r=!1)}});var i=function(){r=!1};this.on("touchleave",i),this.on("touchcancel",i),this.on("touchend",function(i){(e=null,!0===r)&&((new Date).getTime()-t<200&&(i.preventDefault(),this.trigger("tap")))})},t.prototype.enableTouchActivity=function(){if(this.player()&&this.player().reportUserActivity){var t=Zt(this.player(),this.player().reportUserActivity),e=void 0;this.on("touchstart",function(){t(),this.clearInterval(e),e=this.setInterval(t,250)});var r=function(r){t(),this.clearInterval(e)};this.on("touchmove",t),this.on("touchend",r),this.on("touchcancel",r)}},t.prototype.setTimeout=function(t,e){var r,i,n=this;return t=Zt(this,t),r=a.setTimeout(function(){n.off("dispose",i),t()},e),(i=function(){return n.clearTimeout(r)}).guid="vjs-timeout-"+r,this.on("dispose",i),r},t.prototype.clearTimeout=function(t){a.clearTimeout(t);var e=function(){};return e.guid="vjs-timeout-"+t,this.off("dispose",e),t},t.prototype.setInterval=function(t,e){var r=this;t=Zt(this,t);var i=a.setInterval(t,e),n=function(){return r.clearInterval(i)};return n.guid="vjs-interval-"+i,this.on("dispose",n),i},t.prototype.clearInterval=function(t){a.clearInterval(t);var e=function(){};return e.guid="vjs-interval-"+t,this.off("dispose",e),t},t.prototype.requestAnimationFrame=function(t){var e,r,i=this;return this.supportsRaf_?(t=Zt(this,t),e=a.requestAnimationFrame(function(){i.off("dispose",r),t()}),(r=function(){return i.cancelAnimationFrame(e)}).guid="vjs-raf-"+e,this.on("dispose",r),e):this.setTimeout(t,1e3/60)},t.prototype.cancelAnimationFrame=function(t){if(this.supportsRaf_){a.cancelAnimationFrame(t);var e=function(){};return e.guid="vjs-raf-"+t,this.off("dispose",e),t}return this.clearTimeout(t)},t.registerComponent=function(e,r){if("string"!=typeof e||!e)throw new Error('Illegal component name, "'+e+'"; must be a non-empty string.');var i=t.getComponent("Tech"),n=i&&i.isTech(r),a=t===r||t.prototype.isPrototypeOf(r.prototype);if(n||!a){var o=void 0;throw o=n?"techs must be registered using Tech.registerTech()":"must be a Component subclass",new Error('Illegal component, "'+e+'"; '+o+".")}e=pe(e),t.components_||(t.components_={});var s=t.getComponent("Player");if("Player"===e&&s&&s.players){var l=s.players,u=Object.keys(l);if(l&&u.length>0&&u.map(function(t){return l[t]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return t.components_[e]=r,r},t.getComponent=function(e){if(e)return e=pe(e),t.components_&&t.components_[e]?t.components_[e]:void 0},t}();function me(t,e,r,i){return function(t,e,r){if("number"!=typeof e||e<0||e>r)throw new Error("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+e+") is non-numeric or out of bounds (0-"+r+").")}(t,i,r.length-1),r[i][e]}function ye(t){return void 0===t||0===t.length?{length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:{length:t.length,start:me.bind(null,"start",0,t),end:me.bind(null,"end",1,t)}}function be(t,e){return Array.isArray(t)?ye(t):void 0===t||void 0===e?ye():ye([[t,e]])}function _e(t,e){var r=0,i=void 0,n=void 0;if(!e)return 0;t&&t.length||(t=be(0,0));for(var a=0;a<t.length;a++)i=t.start(a),(n=t.end(a))>e&&(n=e),r+=n-i;return r/e}ve.prototype.supportsRaf_="function"==typeof a.requestAnimationFrame&&"function"==typeof a.cancelAnimationFrame,ve.registerComponent("Component",ve);for(var Te={},Ee=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Se=Ee[0],we=void 0,ke=0;ke<Ee.length;ke++)if(Ee[ke][1]in o){we=Ee[ke];break}if(we)for(var Ae=0;Ae<we.length;Ae++)Te[Se[Ae]]=we[Ae];function Ce(t){if(t instanceof Ce)return t;"number"==typeof t?this.code=t:"string"==typeof t?this.message=t:K(t)&&("number"==typeof t.code&&(this.code=t.code),V(this,t)),this.message||(this.message=Ce.defaultMessages[this.code]||"")}Ce.prototype.code=0,Ce.prototype.message="",Ce.prototype.status=null,Ce.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Ce.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var xe=0;xe<Ce.errorTypes.length;xe++)Ce[Ce.errorTypes[xe]]=xe,Ce.prototype[Ce.errorTypes[xe]]=xe;function Re(t){return void 0!==t&&null!==t&&"function"==typeof t.then}function Le(t){Re(t)&&t.then(null,function(t){})}var De=function(t){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(e,r,i){return t[r]&&(e[r]=t[r]),e},{cues:t.cues&&Array.prototype.map.call(t.cues,function(t){return{startTime:t.startTime,endTime:t.endTime,text:t.text,id:t.id}})})},Oe=function(t){var e=t.$$("track"),r=Array.prototype.map.call(e,function(t){return t.track});return Array.prototype.map.call(e,function(t){var e=De(t.track);return t.src&&(e.src=t.src),e}).concat(Array.prototype.filter.call(t.textTracks(),function(t){return-1===r.indexOf(t)}).map(De))},Ie=function(t,e){return t.forEach(function(t){var r=e.addRemoteTextTrack(t).track;!t.src&&t.cues&&t.cues.forEach(function(t){return r.addCue(t)})}),e.textTracks()},Pe="vjs-modal-dialog",Me=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.opened_=n.hasBeenOpened_=n.hasBeenFilled_=!1,n.closeable(!n.options_.uncloseable),n.content(n.options_.content),n.contentEl_=nt("div",{className:Pe+"-content"},{role:"document"}),n.descEl_=nt("p",{className:Pe+"-description vjs-control-text",id:n.el().getAttribute("aria-describedby")}),at(n.descEl_,n.description()),n.el_.appendChild(n.descEl_),n.el_.appendChild(n.contentEl_),n}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},e.prototype.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,t.prototype.dispose.call(this)},e.prototype.buildCSSClass=function(){return Pe+" vjs-hidden "+t.prototype.buildCSSClass.call(this)},e.prototype.handleKeyPress=function(t){27===t.which&&this.closeable()&&this.close()},e.prototype.label=function(){return this.localize(this.options_.label||"Modal Window")},e.prototype.description=function(){var t=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(t+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),t},e.prototype.open=function(){if(!this.opened_){var t=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!t.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&t.pause(),this.closeable()&&this.on(this.el_.ownerDocument,"keydown",Zt(this,this.handleKeyPress)),this.hadControls_=t.controls(),t.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},e.prototype.opened=function(t){return"boolean"==typeof t&&this[t?"open":"close"](),this.opened_},e.prototype.close=function(){if(this.opened_){var t=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&t.play(),this.closeable()&&this.off(this.el_.ownerDocument,"keydown",Zt(this,this.handleKeyPress)),this.hadControls_&&t.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},e.prototype.closeable=function(t){if("boolean"==typeof t){var e=this.closeable_=!!t,r=this.getChild("closeButton");if(e&&!r){var i=this.contentEl_;this.contentEl_=this.el_,r=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=i,this.on(r,"close",this.close)}!e&&r&&(this.off(r,"close",this.close),this.removeChild(r),r.dispose())}return this.closeable_},e.prototype.fill=function(){this.fillWith(this.content())},e.prototype.fillWith=function(t){var e=this.contentEl(),r=e.parentNode,i=e.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,r.removeChild(e),this.empty(),kt(e,t),this.trigger("modalfill"),i?r.insertBefore(e,i):r.appendChild(e);var n=this.getChild("closeButton");n&&r.appendChild(n.el_)},e.prototype.empty=function(){this.trigger("beforemodalempty"),Et(this.contentEl()),this.trigger("modalempty")},e.prototype.content=function(t){return void 0!==t&&(this.content_=t),this.content_},e.prototype.conditionalFocus_=function(){var t=o.activeElement,e=this.player_.el_;this.previouslyActiveEl_=null,(e.contains(t)||e===t)&&(this.previouslyActiveEl_=t,this.focus(),this.on(o,"keydown",this.handleKeyDown))},e.prototype.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null),this.off(o,"keydown",this.handleKeyDown)},e.prototype.handleKeyDown=function(t){if(9===t.which){for(var e=this.focusableEls_(),r=this.el_.querySelector(":focus"),i=void 0,n=0;n<e.length;n++)if(r===e[n]){i=n;break}o.activeElement===this.el_&&(i=0),t.shiftKey&&0===i?(e[e.length-1].focus(),t.preventDefault()):t.shiftKey||i!==e.length-1||(e[0].focus(),t.preventDefault())}},e.prototype.focusableEls_=function(){var t=this.el_.querySelectorAll("*");return Array.prototype.filter.call(t,function(t){return(t instanceof a.HTMLAnchorElement||t instanceof a.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof a.HTMLInputElement||t instanceof a.HTMLSelectElement||t instanceof a.HTMLTextAreaElement||t instanceof a.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof a.HTMLIFrameElement||t instanceof a.HTMLObjectElement||t instanceof a.HTMLEmbedElement||t.hasAttribute("tabindex")&&-1!==t.getAttribute("tabindex")||t.hasAttribute("contenteditable")})},e}(ve);Me.prototype.options_={pauseOnOpen:!0,temporary:!0},ve.registerComponent("ModalDialog",Me);var Ne=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;N(this,e);var n=B(this,t.call(this));if(!i&&(i=n,x))for(var a in i=o.createElement("custom"),e.prototype)"constructor"!==a&&(i[a]=e.prototype[a]);i.tracks_=[],Object.defineProperty(i,"length",{get:function(){return this.tracks_.length}});for(var s=0;s<r.length;s++)i.addTrack(r[s]);return B(n,i)}return F(e,t),e.prototype.addTrack=function(t){var e=this.tracks_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.tracks_[e]}}),-1===this.tracks_.indexOf(t)&&(this.tracks_.push(t),this.trigger({track:t,type:"addtrack"}))},e.prototype.removeTrack=function(t){for(var e=void 0,r=0,i=this.length;r<i;r++)if(this[r]===t){(e=this[r]).off&&e.off(),this.tracks_.splice(r,1);break}e&&this.trigger({track:e,type:"removetrack"})},e.prototype.getTrackById=function(t){for(var e=null,r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===t){e=n;break}}return e},e}(re);for(var Fe in Ne.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack"},Ne.prototype.allowedEvents_)Ne.prototype["on"+Fe]=null;var Be=function(t,e){for(var r=0;r<t.length;r++)Object.keys(t[r]).length&&e.id!==t[r].id&&(t[r].enabled=!1)},je=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];N(this,e);for(var n=void 0,a=i.length-1;a>=0;a--)if(i[a].enabled){Be(i,i[a]);break}if(x){for(var s in n=o.createElement("custom"),Ne.prototype)"constructor"!==s&&(n[s]=Ne.prototype[s]);for(var l in e.prototype)"constructor"!==l&&(n[l]=e.prototype[l])}return(n=r=B(this,t.call(this,i,n))).changing_=!1,B(r,n)}return F(e,t),e.prototype.addTrack=function(e){var r=this;e.enabled&&Be(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("enabledchange",function(){r.changing_||(r.changing_=!0,Be(r,e),r.changing_=!1,r.trigger("change"))})},e}(Ne),Ue=function(t,e){for(var r=0;r<t.length;r++)Object.keys(t[r]).length&&e.id!==t[r].id&&(t[r].selected=!1)},Ge=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];N(this,e);for(var n=void 0,a=i.length-1;a>=0;a--)if(i[a].selected){Ue(i,i[a]);break}if(x){for(var s in n=o.createElement("custom"),Ne.prototype)"constructor"!==s&&(n[s]=Ne.prototype[s]);for(var l in e.prototype)"constructor"!==l&&(n[l]=e.prototype[l])}return(n=r=B(this,t.call(this,i,n))).changing_=!1,Object.defineProperty(n,"selectedIndex",{get:function(){for(var t=0;t<this.length;t++)if(this[t].selected)return t;return-1},set:function(){}}),B(r,n)}return F(e,t),e.prototype.addTrack=function(e){var r=this;e.selected&&Ue(this,e),t.prototype.addTrack.call(this,e),e.addEventListener&&e.addEventListener("selectedchange",function(){r.changing_||(r.changing_=!0,Ue(r,e),r.changing_=!1,r.trigger("change"))})},e}(Ne),He=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];N(this,e);var n=void 0;if(x){for(var a in n=o.createElement("custom"),Ne.prototype)"constructor"!==a&&(n[a]=Ne.prototype[a]);for(var s in e.prototype)"constructor"!==s&&(n[s]=e.prototype[s])}return r=B(this,t.call(this,i,n)),B(r,n=r)}return F(e,t),e.prototype.addTrack=function(e){t.prototype.addTrack.call(this,e),e.addEventListener("modechange",Zt(this,function(){this.trigger("change")}));-1===["metadata","chapters"].indexOf(e.kind)&&e.addEventListener("modechange",Zt(this,function(){this.trigger("selectedlanguagechange")}))},e}(Ne),Ve=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];N(this,t);var r=this;if(x)for(var i in r=o.createElement("custom"),t.prototype)"constructor"!==i&&(r[i]=t.prototype[i]);r.trackElements_=[],Object.defineProperty(r,"length",{get:function(){return this.trackElements_.length}});for(var n=0,a=e.length;n<a;n++)r.addTrackElement_(e[n]);if(x)return r}return t.prototype.addTrackElement_=function(t){var e=this.trackElements_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.trackElements_[e]}}),-1===this.trackElements_.indexOf(t)&&this.trackElements_.push(t)},t.prototype.getTrackElementByTrack_=function(t){for(var e=void 0,r=0,i=this.trackElements_.length;r<i;r++)if(t===this.trackElements_[r].track){e=this.trackElements_[r];break}return e},t.prototype.removeTrackElement_=function(t){for(var e=0,r=this.trackElements_.length;e<r;e++)if(t===this.trackElements_[e]){this.trackElements_.splice(e,1);break}},t}(),Ke=function(){function t(e){N(this,t);var r=this;if(x)for(var i in r=o.createElement("custom"),t.prototype)"constructor"!==i&&(r[i]=t.prototype[i]);if(t.prototype.setCues_.call(r,e),Object.defineProperty(r,"length",{get:function(){return this.length_}}),x)return r}return t.prototype.setCues_=function(t){var e=this.length||0,r=0,i=t.length;this.cues_=t,this.length_=t.length;var n=function(t){""+t in this||Object.defineProperty(this,""+t,{get:function(){return this.cues_[t]}})};if(e<i)for(r=e;r<i;r++)n.call(this,r)},t.prototype.getCueById=function(t){for(var e=null,r=0,i=this.length;r<i;r++){var n=this[r];if(n.id===t){e=n;break}}return e},t}(),We={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},ze={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},qe={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Ye={disabled:"disabled",hidden:"hidden",showing:"showing"},Xe=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N(this,e);var i=B(this,t.call(this)),n=i;if(x)for(var a in n=o.createElement("custom"),e.prototype)"constructor"!==a&&(n[a]=e.prototype[a]);var s={id:r.id||"vjs_track_"+Dt(),kind:r.kind||"",label:r.label||"",language:r.language||""},l=function(t){Object.defineProperty(n,t,{get:function(){return s[t]},set:function(){}})};for(var u in s)l(u);return B(i,n)}return F(e,t),e}(re),$e=function(t){var e=["protocol","hostname","port","pathname","search","hash","host"],r=o.createElement("a");r.href=t;var i=""===r.host&&"file:"!==r.protocol,n=void 0;i&&((n=o.createElement("div")).innerHTML='<a href="'+t+'"></a>',r=n.firstChild,n.setAttribute("style","display:none; position:absolute;"),o.body.appendChild(n));for(var s={},l=0;l<e.length;l++)s[e[l]]=r[e[l]];return"http:"===s.protocol&&(s.host=s.host.replace(/:80$/,"")),"https:"===s.protocol&&(s.host=s.host.replace(/:443$/,"")),s.protocol||(s.protocol=a.location.protocol),i&&o.body.removeChild(n),s},Je=function(t){if(!t.match(/^https?:\/\//)){var e=o.createElement("div");e.innerHTML='<a href="'+t+'">x</a>',t=e.firstChild.href}return t},Qe=function(t){if("string"==typeof t){var e=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/i.exec(t);if(e)return e.pop().toLowerCase()}return""},Ze=function(t){var e=a.location,r=$e(t);return(":"===r.protocol?e.protocol:r.protocol)+r.host!==e.protocol+e.host},tr=(Object.freeze||Object)({parseUrl:$e,getAbsoluteURL:Je,getFileExtension:Qe,isCrossOrigin:Ze}),er=function(t,e){var r=new a.WebVTT.Parser(a,a.vttjs,a.WebVTT.StringDecoder()),i=[];r.oncue=function(t){e.addCue(t)},r.onparsingerror=function(t){i.push(t)},r.onflush=function(){e.trigger({type:"loadeddata",target:e})},r.parse(t),i.length>0&&(a.console&&a.console.groupCollapsed&&a.console.groupCollapsed("Text Track parsing errors for "+e.src),i.forEach(function(t){return Y.error(t)}),a.console&&a.console.groupEnd&&a.console.groupEnd()),r.flush()},rr=function(t,e){var r={uri:t},i=Ze(t);i&&(r.cors=i),u(r,Zt(this,function(t,r,i){if(t)return Y.error(t,r);if(e.loaded_=!0,"function"!=typeof a.WebVTT){if(e.tech_){var n=function(){return er(i,e)};e.tech_.on("vttjsloaded",n),e.tech_.on("vttjserror",function(){Y.error("vttjs failed to load, stopping trying to process "+e.src),e.tech_.off("vttjsloaded",n)})}}else er(i,e)}))},ir=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(N(this,e),!i.tech)throw new Error("A tech was not provided.");var n=ge(i,{kind:qe[i.kind]||"subtitles",language:i.language||i.srclang||""}),a=Ye[n.mode]||"disabled",o=n.default;"metadata"!==n.kind&&"chapters"!==n.kind||(a="hidden");var s=r=B(this,t.call(this,n));if(s.tech_=n.tech,x)for(var l in e.prototype)"constructor"!==l&&(s[l]=e.prototype[l]);s.cues_=[],s.activeCues_=[];var u=new Ke(s.cues_),c=new Ke(s.activeCues_),h=!1,d=Zt(s,function(){this.activeCues=this.activeCues,h&&(this.trigger("cuechange"),h=!1)});return"disabled"!==a&&s.tech_.ready(function(){s.tech_.on("timeupdate",d)},!0),Object.defineProperty(s,"default",{get:function(){return o},set:function(){}}),Object.defineProperty(s,"mode",{get:function(){return a},set:function(t){var e=this;Ye[t]&&("disabled"!==(a=t)?this.tech_.ready(function(){e.tech_.on("timeupdate",d)},!0):this.tech_.off("timeupdate",d),this.trigger("modechange"))}}),Object.defineProperty(s,"cues",{get:function(){return this.loaded_?u:null},set:function(){}}),Object.defineProperty(s,"activeCues",{get:function(){if(!this.loaded_)return null;if(0===this.cues.length)return c;for(var t=this.tech_.currentTime(),e=[],r=0,i=this.cues.length;r<i;r++){var n=this.cues[r];n.startTime<=t&&n.endTime>=t?e.push(n):n.startTime===n.endTime&&n.startTime<=t&&n.startTime+.5>=t&&e.push(n)}if(h=!1,e.length!==this.activeCues_.length)h=!0;else for(var a=0;a<e.length;a++)-1===this.activeCues_.indexOf(e[a])&&(h=!0);return this.activeCues_=e,c.setCues_(this.activeCues_),c},set:function(){}}),n.src?(s.src=n.src,rr(n.src,s)):s.loaded_=!0,B(r,s)}return F(e,t),e.prototype.addCue=function(t){var e=t;if(a.vttjs&&!(t instanceof a.vttjs.VTTCue)){for(var r in e=new a.vttjs.VTTCue(t.startTime,t.endTime,t.text),t)r in e||(e[r]=t[r]);e.id=t.id,e.originalCue_=t}for(var i=this.tech_.textTracks(),n=0;n<i.length;n++)i[n]!==this&&i[n].removeCue(e);this.cues_.push(e),this.cues.setCues_(this.cues_)},e.prototype.removeCue=function(t){for(var e=this.cues_.length;e--;){var r=this.cues_[e];if(r===t||r.originalCue_&&r.originalCue_===t){this.cues_.splice(e,1),this.cues.setCues_(this.cues_);break}}},e}(Xe);ir.prototype.allowedEvents_={cuechange:"cuechange"};var nr=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N(this,e);var n=ge(i,{kind:ze[i.kind]||""}),a=r=B(this,t.call(this,n)),o=!1;if(x)for(var s in e.prototype)"constructor"!==s&&(a[s]=e.prototype[s]);return Object.defineProperty(a,"enabled",{get:function(){return o},set:function(t){"boolean"==typeof t&&t!==o&&(o=t,this.trigger("enabledchange"))}}),n.enabled&&(a.enabled=n.enabled),a.loaded_=!0,B(r,a)}return F(e,t),e}(Xe),ar=function(t){function e(){var r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N(this,e);var n=ge(i,{kind:We[i.kind]||""}),a=r=B(this,t.call(this,n)),o=!1;if(x)for(var s in e.prototype)"constructor"!==s&&(a[s]=e.prototype[s]);return Object.defineProperty(a,"selected",{get:function(){return o},set:function(t){"boolean"==typeof t&&t!==o&&(o=t,this.trigger("selectedchange"))}}),n.selected&&(a.selected=n.selected),B(r,a)}return F(e,t),e}(Xe),or=0,sr=2,lr=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};N(this,e);var i=B(this,t.call(this)),n=void 0,a=i;if(x)for(var s in a=o.createElement("custom"),e.prototype)"constructor"!==s&&(a[s]=e.prototype[s]);var l=new ir(r);return a.kind=l.kind,a.src=l.src,a.srclang=l.language,a.label=l.label,a.default=l.default,Object.defineProperty(a,"readyState",{get:function(){return n}}),Object.defineProperty(a,"track",{get:function(){return l}}),n=or,l.addEventListener("loadeddata",function(){n=sr,a.trigger({type:"load",target:a})}),x?B(i,a):i}return F(e,t),e}(re);lr.prototype.allowedEvents_={load:"load"},lr.NONE=or,lr.LOADING=1,lr.LOADED=sr,lr.ERROR=3;var ur={audio:{ListClass:je,TrackClass:nr,capitalName:"Audio"},video:{ListClass:Ge,TrackClass:ar,capitalName:"Video"},text:{ListClass:He,TrackClass:ir,capitalName:"Text"}};Object.keys(ur).forEach(function(t){ur[t].getterName=t+"Tracks",ur[t].privateName=t+"Tracks_"});var cr={remoteText:{ListClass:He,TrackClass:ir,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:Ve,TrackClass:lr,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},hr=ge(ur,cr);cr.names=Object.keys(cr),ur.names=Object.keys(ur),hr.names=[].concat(cr.names).concat(ur.names);var dr=function(t){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};N(this,e),r.reportTouchActivity=!1;var n=B(this,t.call(this,null,r,i));return n.hasStarted_=!1,n.on("playing",function(){this.hasStarted_=!0}),n.on("loadstart",function(){this.hasStarted_=!1}),hr.names.forEach(function(t){var e=hr[t];r&&r[e.getterName]&&(n[e.privateName]=r[e.getterName])}),n.featuresProgressEvents||n.manualProgressOn(),n.featuresTimeupdateEvents||n.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(t){!1===r["native"+t+"Tracks"]&&(n["featuresNative"+t+"Tracks"]=!1)}),!1===r.nativeCaptions||!1===r.nativeTextTracks?n.featuresNativeTextTracks=!1:!0!==r.nativeCaptions&&!0!==r.nativeTextTracks||(n.featuresNativeTextTracks=!0),n.featuresNativeTextTracks||n.emulateTextTracks(),n.autoRemoteTextTracks_=new hr.text.ListClass,n.initTrackListeners(),r.nativeControlsForTouch||n.emitTapEvents(),n.constructor&&(n.name_=n.constructor.name||"Unknown Tech"),n}return F(e,t),e.prototype.triggerSourceset=function(t){var e=this;this.isReady_||this.one("ready",function(){return e.setTimeout(function(){return e.triggerSourceset(t)},1)}),this.trigger({src:t,type:"sourceset"})},e.prototype.manualProgressOn=function(){this.on("durationchange",this.onDurationChange),this.manualProgress=!0,this.one("ready",this.trackProgress)},e.prototype.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange)},e.prototype.trackProgress=function(t){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Zt(this,function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,1===t&&this.stopTrackingProgress()}),500)},e.prototype.onDurationChange=function(t){this.duration_=this.duration()},e.prototype.buffered=function(){return be(0,0)},e.prototype.bufferedPercent=function(){return _e(this.buffered(),this.duration_)},e.prototype.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},e.prototype.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime),this.on("pause",this.stopTrackingCurrentTime)},e.prototype.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime),this.off("pause",this.stopTrackingCurrentTime)},e.prototype.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},e.prototype.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.dispose=function(){this.clearTracks(ur.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),t.prototype.dispose.call(this)},e.prototype.clearTracks=function(t){var e=this;(t=[].concat(t)).forEach(function(t){for(var r=e[t+"Tracks"]()||[],i=r.length;i--;){var n=r[i];"text"===t&&e.removeRemoteTextTrack(n),r.removeTrack(n)}})},e.prototype.cleanupAutoTextTracks=function(){for(var t=this.autoRemoteTextTracks_||[],e=t.length;e--;){var r=t[e];this.removeRemoteTextTrack(r)}},e.prototype.reset=function(){},e.prototype.error=function(t){return void 0!==t&&(this.error_=new Ce(t),this.trigger("error")),this.error_},e.prototype.played=function(){return this.hasStarted_?be(0,0):be()},e.prototype.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},e.prototype.initTrackListeners=function(){var t=this;ur.names.forEach(function(e){var r=ur[e],i=function(){t.trigger(e+"trackchange")},n=t[r.getterName]();n.addEventListener("removetrack",i),n.addEventListener("addtrack",i),t.on("dispose",function(){n.removeEventListener("removetrack",i),n.removeEventListener("addtrack",i)})})},e.prototype.addWebVttScript_=function(){var t=this;if(!a.WebVTT)if(o.body.contains(this.el())){if(!this.options_["vtt.js"]&&W(c)&&Object.keys(c).length>0)return void this.trigger("vttjsloaded");var e=o.createElement("script");e.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.12.4/vtt.min.js",e.onload=function(){t.trigger("vttjsloaded")},e.onerror=function(){t.trigger("vttjserror")},this.on("dispose",function(){e.onload=null,e.onerror=null}),a.WebVTT=!0,this.el().parentNode.appendChild(e)}else this.ready(this.addWebVttScript_)},e.prototype.emulateTextTracks=function(){var t=this,e=this.textTracks(),r=this.remoteTextTracks(),i=function(t){return e.addTrack(t.track)},n=function(t){return e.removeTrack(t.track)};r.on("addtrack",i),r.on("removetrack",n),this.addWebVttScript_();var a=function(){return t.trigger("texttrackchange")},o=function(){a();for(var t=0;t<e.length;t++){var r=e[t];r.removeEventListener("cuechange",a),"showing"===r.mode&&r.addEventListener("cuechange",a)}};o(),e.addEventListener("change",o),e.addEventListener("addtrack",o),e.addEventListener("removetrack",o),this.on("dispose",function(){r.off("addtrack",i),r.off("removetrack",n),e.removeEventListener("change",o),e.removeEventListener("addtrack",o),e.removeEventListener("removetrack",o);for(var t=0;t<e.length;t++){e[t].removeEventListener("cuechange",a)}})},e.prototype.addTextTrack=function(t,e,r){if(!t)throw new Error("TextTrack kind is required but was not provided");return function(t,e,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=t.textTracks();n.kind=e,r&&(n.label=r),i&&(n.language=i),n.tech=t;var o=new hr.text.TrackClass(n);return a.addTrack(o),o}(this,t,e,r)},e.prototype.createRemoteTextTrack=function(t){var e=ge(t,{tech:this});return new cr.remoteTextEl.TrackClass(e)},e.prototype.addRemoteTextTrack=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1],i=this.createRemoteTextTrack(e);return!0!==r&&!1!==r&&(Y.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),r=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),!0!==r&&this.ready(function(){return t.autoRemoteTextTracks_.addTrack(i.track)}),i},e.prototype.removeRemoteTextTrack=function(t){var e=this.remoteTextTrackEls().getTrackElementByTrack_(t);this.remoteTextTrackEls().removeTrackElement_(e),this.remoteTextTracks().removeTrack(t),this.autoRemoteTextTracks_.removeTrack(t)},e.prototype.getVideoPlaybackQuality=function(){return{}},e.prototype.setPoster=function(){},e.prototype.playsinline=function(){},e.prototype.setPlaysinline=function(){},e.prototype.canPlayType=function(){return""},e.canPlayType=function(){return""},e.canPlaySource=function(t,r){return e.canPlayType(t.type)},e.isTech=function(t){return t.prototype instanceof e||t instanceof e||t===e},e.registerTech=function(t,r){if(e.techs_||(e.techs_={}),!e.isTech(r))throw new Error("Tech "+t+" must be a Tech");if(!e.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!e.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return t=pe(t),e.techs_[t]=r,"Tech"!==t&&e.defaultTechOrder_.push(t),r},e.getTech=function(t){if(t)return t=pe(t),e.techs_&&e.techs_[t]?e.techs_[t]:a&&a.videojs&&a.videojs[t]?(Y.warn("The "+t+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),a.videojs[t]):void 0},e}(ve);hr.names.forEach(function(t){var e=hr[t];dr.prototype[e.getterName]=function(){return this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName]}}),dr.prototype.featuresVolumeControl=!0,dr.prototype.featuresMuteControl=!0,dr.prototype.featuresFullscreenResize=!1,dr.prototype.featuresPlaybackRate=!1,dr.prototype.featuresProgressEvents=!1,dr.prototype.featuresSourceset=!1,dr.prototype.featuresTimeupdateEvents=!1,dr.prototype.featuresNativeTextTracks=!1,dr.withSourceHandlers=function(t){t.registerSourceHandler=function(e,r){var i=t.sourceHandlers;i||(i=t.sourceHandlers=[]),void 0===r&&(r=i.length),i.splice(r,0,e)},t.canPlayType=function(e){for(var r=t.sourceHandlers||[],i=void 0,n=0;n<r.length;n++)if(i=r[n].canPlayType(e))return i;return""},t.selectSourceHandler=function(e,r){for(var i=t.sourceHandlers||[],n=0;n<i.length;n++)if(i[n].canHandleSource(e,r))return i[n];return null},t.canPlaySource=function(e,r){var i=t.selectSourceHandler(e,r);return i?i.canHandleSource(e,r):""};["seekable","seeking","duration"].forEach(function(t){var e=this[t];"function"==typeof e&&(this[t]=function(){return this.sourceHandler_&&this.sourceHandler_[t]?this.sourceHandler_[t].apply(this.sourceHandler_,arguments):e.apply(this,arguments)})},t.prototype),t.prototype.setSource=function(e){var r=t.selectSourceHandler(e,this.options_);r||(t.nativeSourceHandler?r=t.nativeSourceHandler:Y.error("No source hander found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler),r!==t.nativeSourceHandler&&(this.currentSource_=e),this.sourceHandler_=r.handleSource(e,this,this.options_),this.on("dispose",this.disposeSourceHandler)},t.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},ve.registerComponent("Tech",dr),dr.registerTech("Tech",dr),dr.defaultTechOrder_=[];var fr={},pr={},gr={};function vr(t,e,r){t.setTimeout(function(){return function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var i=arguments[2];var n=arguments[3];var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];var s=r[0],l=r.slice(1);if("string"==typeof s)t(e,fr[s],i,n,a,o);else if(s){var u=function(t,e){var r=pr[t.id()],i=null;if(void 0===r||null===r)return i=e(t),pr[t.id()]=[[e,i]],i;for(var n=0;n<r.length;n++){var a=r[n],o=a[0],s=a[1];o===e&&(i=s)}null===i&&(i=e(t),r.push([e,i]));return i}(n,s);if(!u.setSource)return a.push(u),t(e,l,i,n,a,o);u.setSource(V({},e),function(r,s){if(r)return t(e,l,i,n,a,o);a.push(u),t(s,e.type===s.type?l:fr[s.type],i,n,a,o)})}else l.length?t(e,l,i,n,a,o):o?i(e,a):t(e,fr["*"],i,n,a,!0)}(e,fr[e.type],r,t)},1)}function mr(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n="call"+pe(r),a=t.reduce(Tr(n),i),o=a===gr,s=o?null:e[r](a);return function(t,e,r,i){for(var n=t.length-1;n>=0;n--){var a=t[n];a[e]&&a[e](i,r)}}(t,r,s,o),s}var yr={buffered:1,currentTime:1,duration:1,seekable:1,played:1,paused:1},br={setCurrentTime:1},_r={play:1,pause:1};function Tr(t){return function(e,r){return e===gr?gr:r[t]?r[t](e):e}}var Er={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",mp3:"audio/mpeg",aac:"audio/aac",oga:"audio/ogg",m3u8:"application/x-mpegURL"},Sr=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=Qe(t);return Er[e.toLowerCase()]||""};function wr(t){var e=Sr(t.src);return!t.type&&e&&(t.type=e),t}var kr=function(t){function e(r,i,n){N(this,e);var a=ge({createEl:!1},i),o=B(this,t.call(this,r,a,n));if(i.playerOptions.sources&&0!==i.playerOptions.sources.length)r.src(i.playerOptions.sources);else for(var s=0,l=i.playerOptions.techOrder;s<l.length;s++){var u=pe(l[s]),c=dr.getTech(u);if(u||(c=ve.getComponent(u)),c&&c.isSupported()){r.loadTech_(u);break}}return o}return F(e,t),e}(ve);ve.registerComponent("MediaLoader",kr);var Ar=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.emitTapEvents(),n.enable(),n}return F(e,t),e.prototype.createEl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};r=V({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass(),tabIndex:0},r),"button"===e&&Y.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),i=V({role:"button"},i),this.tabIndex_=r.tabIndex;var n=t.prototype.createEl.call(this,e,r,i);return this.createControlTextEl(n),n},e.prototype.dispose=function(){this.controlTextEl_=null,t.prototype.dispose.call(this)},e.prototype.createControlTextEl=function(t){return this.controlTextEl_=nt("span",{className:"vjs-control-text"},{"aria-live":"polite"}),t&&t.appendChild(this.controlTextEl_),this.controlText(this.controlText_,t),this.controlTextEl_},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.el();if(void 0===t)return this.controlText_||"Need Text";var r=this.localize(t);this.controlText_=t,at(this.controlTextEl_,r),this.nonIconControl||e.setAttribute("title",r)},e.prototype.buildCSSClass=function(){return"vjs-control vjs-button "+t.prototype.buildCSSClass.call(this)},e.prototype.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),void 0!==this.tabIndex_&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur))},e.prototype.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),void 0!==this.tabIndex_&&this.el_.removeAttribute("tabIndex"),this.off(["tap","click"],this.handleClick),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur)},e.prototype.handleClick=function(t){},e.prototype.handleFocus=function(t){Ht(o,"keydown",Zt(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.trigger("click")):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e.prototype.handleBlur=function(t){Vt(o,"keydown",Zt(this,this.handleKeyPress))},e}(ve);ve.registerComponent("ClickableComponent",Ar);var Cr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.update(),r.on("posterchange",Zt(n,n.update)),n}return F(e,t),e.prototype.dispose=function(){this.player().off("posterchange",this.update),t.prototype.dispose.call(this)},e.prototype.createEl=function(){var t=nt("div",{className:"vjs-poster",tabIndex:-1});return I||(this.fallbackImg_=nt("img"),t.appendChild(this.fallbackImg_)),t},e.prototype.update=function(t){var e=this.player().poster();this.setSrc(e),e?this.show():this.hide()},e.prototype.setSrc=function(t){if(this.fallbackImg_)this.fallbackImg_.src=t;else{var e="";t&&(e='url("'+t+'")'),this.el_.style.backgroundImage=e}},e.prototype.handleClick=function(t){this.player_.controls()&&(this.player_.paused()?Le(this.player_.play()):this.player_.pause())},e}(Ar);ve.registerComponent("PosterImage",Cr);var xr={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function Rr(t,e){var r=void 0;if(4===t.length)r=t[1]+t[1]+t[2]+t[2]+t[3]+t[3];else{if(7!==t.length)throw new Error("Invalid color code provided, "+t+"; must be formatted as e.g. #f0e or #f604e2.");r=t.slice(1)}return"rgba("+parseInt(r.slice(0,2),16)+","+parseInt(r.slice(2,4),16)+","+parseInt(r.slice(4,6),16)+","+e+")"}function Lr(t,e,r){try{t.style[e]=r}catch(t){return}}var Dr=function(t){function e(r,i,n){N(this,e);var o=B(this,t.call(this,r,i,n)),s=Zt(o,o.updateDisplay);return r.on("loadstart",Zt(o,o.toggleDisplay)),r.on("texttrackchange",s),r.on("loadstart",Zt(o,o.preselectTrack)),r.ready(Zt(o,function(){if(r.tech_&&r.tech_.featuresNativeTextTracks)this.hide();else{r.on("fullscreenchange",s),r.on("playerresize",s),a.addEventListener&&a.addEventListener("orientationchange",s),r.on("dispose",function(){return a.removeEventListener("orientationchange",s)});for(var t=this.options_.playerOptions.tracks||[],e=0;e<t.length;e++)this.player_.addRemoteTextTrack(t[e],!0);this.preselectTrack()}})),o}return F(e,t),e.prototype.preselectTrack=function(){for(var t={captions:1,subtitles:1},e=this.player_.textTracks(),r=this.player_.cache_.selectedLanguage,i=void 0,n=void 0,a=void 0,o=0;o<e.length;o++){var s=e[o];r&&r.enabled&&r.language===s.language?s.kind===r.kind?a=s:a||(a=s):r&&!r.enabled?(a=null,i=null,n=null):s.default&&("descriptions"!==s.kind||i?s.kind in t&&!n&&(n=s):i=s)}a?a.mode="showing":n?n.mode="showing":i&&(i.mode="showing")},e.prototype.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},e.prototype.clearDisplay=function(){"function"==typeof a.WebVTT&&a.WebVTT.processCues(a,[],this.el_)},e.prototype.updateDisplay=function(){var t=this.player_.textTracks();this.clearDisplay();for(var e=null,r=null,i=t.length;i--;){var n=t[i];"showing"===n.mode&&("descriptions"===n.kind?e=n:r=n)}r?("off"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","off"),this.updateForTrack(r)):e&&("assertive"!==this.getAttribute("aria-live")&&this.setAttribute("aria-live","assertive"),this.updateForTrack(e))},e.prototype.updateForTrack=function(t){if("function"==typeof a.WebVTT&&t.activeCues){for(var e=[],r=0;r<t.activeCues.length;r++)e.push(t.activeCues[r]);if(a.WebVTT.processCues(a,e,this.el_),this.player_.textTrackSettings)for(var i=this.player_.textTrackSettings.getValues(),n=e.length;n--;){var o=e[n];if(o){var s=o.displayState;if(i.color&&(s.firstChild.style.color=i.color),i.textOpacity&&Lr(s.firstChild,"color",Rr(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(s.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&Lr(s.firstChild,"backgroundColor",Rr(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?Lr(s,"backgroundColor",Rr(i.windowColor,i.windowOpacity)):s.style.backgroundColor=i.windowColor),i.edgeStyle&&("dropshadow"===i.edgeStyle?s.firstChild.style.textShadow="2px 2px 3px #222, 2px 2px 4px #222, 2px 2px 5px #222":"raised"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #222, 2px 2px #222, 3px 3px #222":"depressed"===i.edgeStyle?s.firstChild.style.textShadow="1px 1px #ccc, 0 1px #ccc, -1px -1px #222, 0 -1px #222":"uniform"===i.edgeStyle&&(s.firstChild.style.textShadow="0 0 4px #222, 0 0 4px #222, 0 0 4px #222, 0 0 4px #222")),i.fontPercent&&1!==i.fontPercent){var l=a.parseFloat(s.style.fontSize);s.style.fontSize=l*i.fontPercent+"px",s.style.height="auto",s.style.top="auto",s.style.bottom="2px"}i.fontFamily&&"default"!==i.fontFamily&&("small-caps"===i.fontFamily?s.firstChild.style.fontVariant="small-caps":s.firstChild.style.fontFamily=xr[i.fontFamily])}}}},e}(ve);ve.registerComponent("TextTrackDisplay",Dr);var Or=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){var e=this.player_.isAudio(),r=this.localize(e?"Audio Player":"Video Player"),i=nt("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[r])}),n=t.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return n.appendChild(i),n},e}(ve);ve.registerComponent("LoadingSpinner",Or);var Ir=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};e=V({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"></span>',className:this.buildCSSClass()},e),r=V({type:"button"},r);var i=ve.prototype.createEl.call(this,"button",e,r);return this.createControlTextEl(i),i},e.prototype.addChild=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this.constructor.name;return Y.warn("Adding an actionable (user controllable) child to a Button ("+r+") is not supported; use a ClickableComponent instead."),ve.prototype.addChild.call(this,t,e)},e.prototype.enable=function(){t.prototype.enable.call(this),this.el_.removeAttribute("disabled")},e.prototype.disable=function(){t.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},e.prototype.handleKeyPress=function(e){32!==e.which&&13!==e.which&&t.prototype.handleKeyPress.call(this,e)},e}(Ar);ve.registerComponent("Button",Ir);var Pr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.mouseused_=!1,n.on("mousedown",n.handleMouseDown),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-big-play-button"},e.prototype.handleClick=function(t){var e=this.player_.play();if(this.mouseused_&&t.clientX&&t.clientY)Le(e);else{var r=this.player_.getChild("controlBar"),i=r&&r.getChild("playToggle");if(i){var n=function(){return i.focus()};Re(e)?e.then(n,function(){}):this.setTimeout(n,1)}else this.player_.focus()}},e.prototype.handleKeyPress=function(e){this.mouseused_=!1,t.prototype.handleKeyPress.call(this,e)},e.prototype.handleMouseDown=function(t){this.mouseused_=!0},e}(Ir);Pr.prototype.controlText_="Play Video",ve.registerComponent("BigPlayButton",Pr);var Mr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.controlText(i&&i.controlText||n.localize("Close")),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-close-button "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){this.trigger({type:"close",bubbles:!1})},e}(Ir);ve.registerComponent("CloseButton",Mr);var Nr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"play",n.handlePlay),n.on(r,"pause",n.handlePause),n.on(r,"ended",n.handleEnded),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-play-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handleSeeked=function(t){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(t):this.handlePlay(t)},e.prototype.handlePlay=function(t){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},e.prototype.handlePause=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},e.prototype.handleEnded=function(t){this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",this.handleSeeked)},e}(Ir);Nr.prototype.controlText_="Play",ve.registerComponent("PlayToggle",Nr);var Fr=function(t,e){t=t<0?0:t;var r=Math.floor(t%60),i=Math.floor(t/60%60),n=Math.floor(t/3600),a=Math.floor(e/60%60),o=Math.floor(e/3600);return(isNaN(t)||t===1/0)&&(n=i=r="-"),(n=n>0||o>0?n+":":"")+(i=((n||a>=10)&&i<10?"0"+i:i)+":")+(r=r<10?"0"+r:r)},Br=Fr;var jr=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return Br(t,e)},Ur=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.throttledUpdateContent=te(Zt(n,n.updateContent),25),n.on(r,"timeupdate",n.throttledUpdateContent),n}return F(e,t),e.prototype.createEl=function(e){var r=this.buildCSSClass(),i=t.prototype.createEl.call(this,"div",{className:r+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text">'+this.localize(this.labelText_)+" </span>"});return this.contentEl_=nt("span",{className:r+"-display"},{"aria-live":"off"}),this.updateTextNode_(),i.appendChild(this.contentEl_),i},e.prototype.dispose=function(){this.contentEl_=null,this.textNode_=null,t.prototype.dispose.call(this)},e.prototype.updateTextNode_=function(){if(this.contentEl_){for(;this.contentEl_.firstChild;)this.contentEl_.removeChild(this.contentEl_.firstChild);this.textNode_=o.createTextNode(this.formattedTime_||this.formatTime_(0)),this.contentEl_.appendChild(this.textNode_)}},e.prototype.formatTime_=function(t){return jr(t)},e.prototype.updateFormattedTime_=function(t){var e=this.formatTime_(t);e!==this.formattedTime_&&(this.formattedTime_=e,this.requestAnimationFrame(this.updateTextNode_))},e.prototype.updateContent=function(t){},e}(ve);Ur.prototype.labelText_="Time",Ur.prototype.controlText_="Time",ve.registerComponent("TimeDisplay",Ur);var Gr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"ended",n.handleEnded),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-current-time"},e.prototype.updateContent=function(t){var e=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateFormattedTime_(e)},e.prototype.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(this.player_.duration())},e}(Ur);Gr.prototype.labelText_="Current Time",Gr.prototype.controlText_="Current Time",ve.registerComponent("CurrentTimeDisplay",Gr);var Hr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"durationchange",n.updateContent),n.on(r,"loadedmetadata",n.throttledUpdateContent),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-duration"},e.prototype.updateContent=function(t){var e=this.player_.duration();e&&this.duration_!==e&&(this.duration_=e,this.updateFormattedTime_(e))},e}(Ur);Hr.prototype.labelText_="Duration",Hr.prototype.controlText_="Duration",ve.registerComponent("DurationDisplay",Hr);var Vr=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/</span></div>"})},e}(ve);ve.registerComponent("TimeDivider",Vr);var Kr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"durationchange",n.throttledUpdateContent),n.on(r,"ended",n.handleEnded),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-remaining-time"},e.prototype.formatTime_=function(e){return"-"+t.prototype.formatTime_.call(this,e)},e.prototype.updateContent=function(t){this.player_.duration()&&(this.player_.remainingTimeDisplay?this.updateFormattedTime_(this.player_.remainingTimeDisplay()):this.updateFormattedTime_(this.player_.remainingTime()))},e.prototype.handleEnded=function(t){this.player_.duration()&&this.updateFormattedTime_(0)},e}(Ur);Kr.prototype.labelText_="Remaining Time",Kr.prototype.controlText_="Remaining Time",ve.registerComponent("RemainingTimeDisplay",Kr);var Wr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.updateShowing(),n.on(n.player(),"durationchange",n.updateShowing),n}return F(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=nt("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" </span>"+this.localize("LIVE")},{"aria-live":"off"}),e.appendChild(this.contentEl_),e},e.prototype.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},e.prototype.updateShowing=function(t){this.player().duration()===1/0?this.show():this.hide()},e}(ve);ve.registerComponent("LiveDisplay",Wr);var zr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.bar=n.getChild(n.options_.barName),n.vertical(!!n.options_.vertical),n.enable(),n}return F(e,t),e.prototype.enabled=function(){return this.enabled_},e.prototype.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown),this.on("touchstart",this.handleMouseDown),this.on("focus",this.handleFocus),this.on("blur",this.handleBlur),this.on("click",this.handleClick),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},e.prototype.disable=function(){if(this.enabled()){var t=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown),this.off("touchstart",this.handleMouseDown),this.off("focus",this.handleFocus),this.off("blur",this.handleBlur),this.off("click",this.handleClick),this.off(this.player_,"controlsvisible",this.update),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},e.prototype.createEl=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.className=r.className+" vjs-slider",r=V({tabIndex:0},r),i=V({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},i),t.prototype.createEl.call(this,e,r,i)},e.prototype.handleMouseDown=function(t){var e=this.bar.el_.ownerDocument;"mousedown"===t.type&&t.preventDefault(),"touchstart"!==t.type||A||t.preventDefault(),vt(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(e,"mousemove",this.handleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchmove",this.handleMouseMove),this.on(e,"touchend",this.handleMouseUp),this.handleMouseMove(t)},e.prototype.handleMouseMove=function(t){},e.prototype.handleMouseUp=function(){var t=this.bar.el_.ownerDocument;mt(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(t,"mousemove",this.handleMouseMove),this.off(t,"mouseup",this.handleMouseUp),this.off(t,"touchmove",this.handleMouseMove),this.off(t,"touchend",this.handleMouseUp),this.update()},e.prototype.update=function(){if(this.el_){var t=this.getPercent(),e=this.bar;if(e){("number"!=typeof t||t!=t||t<0||t===1/0)&&(t=0);var r=(100*t).toFixed(2)+"%",i=e.el().style;return this.vertical()?i.height=r:i.width=r,t}}},e.prototype.calculateDistance=function(t){var e=_t(this.el_,t);return this.vertical()?e.y:e.x},e.prototype.handleFocus=function(){this.on(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepBack()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepForward())},e.prototype.handleBlur=function(){this.off(this.bar.el_.ownerDocument,"keydown",this.handleKeyPress)},e.prototype.handleClick=function(t){t.stopImmediatePropagation(),t.preventDefault()},e.prototype.vertical=function(t){if(void 0===t)return this.vertical_||!1;this.vertical_=!!t,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},e}(ve);ve.registerComponent("Slider",zr);var qr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.partEls_=[],n.on(r,"progress",n.update),n}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-load-progress",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Loaded")+"</span>: 0%</span>"})},e.prototype.dispose=function(){this.partEls_=null,t.prototype.dispose.call(this)},e.prototype.update=function(t){var e=this.player_.buffered(),r=this.player_.duration(),i=this.player_.bufferedEnd(),n=this.partEls_,a=function(t,e){var r=t/e||0;return 100*(r>=1?1:r)+"%"};this.el_.style.width=a(i,r);for(var o=0;o<e.length;o++){var s=e.start(o),l=e.end(o),u=n[o];u||(u=this.el_.appendChild(nt()),n[o]=u),u.style.left=a(s,i),u.style.width=a(l-s,i)}for(var c=n.length;c>e.length;c--)this.el_.removeChild(n[c-1]);n.length=e.length},e}(ve);ve.registerComponent("LoadProgressBar",qr);var Yr=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"})},e.prototype.update=function(t,e,r){var i=yt(this.el_),n=yt(this.player_.el()),a=t.width*e;if(n&&i){var o=t.left-n.left+a,s=t.width-a+(n.right-t.right),l=i.width/2;o<l?l+=l-o:s<l&&(l=s),l<0?l=0:l>i.width&&(l=i.width),this.el_.style.right="-"+l+"px",at(this.el_,r)}},e}(ve);ve.registerComponent("TimeTooltip",Yr);var Xr=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar",innerHTML:'<span class="vjs-control-text"><span>'+this.localize("Progress")+"</span>: 0%</span>"})},e.prototype.update=function(t,e){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var i=r.player_.scrubbing()?r.player_.getCache().currentTime:r.player_.currentTime(),n=jr(i,r.player_.duration()),a=r.getChild("timeTooltip");a&&a.update(t,e,n)})},e}(ve);Xr.prototype.options_={children:[]},R&&!(R>8)||y||_||Xr.prototype.options_.children.push("timeTooltip"),ve.registerComponent("PlayProgressBar",Xr);var $r=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.update=te(Zt(n,n.update),25),n}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},e.prototype.update=function(t,e){var r=this;this.rafId_&&this.cancelAnimationFrame(this.rafId_),this.rafId_=this.requestAnimationFrame(function(){var i=r.player_.duration(),n=jr(e*i,i);r.el_.style.left=t.width*e+"px",r.getChild("timeTooltip").update(t,e,n)})},e}(ve);$r.prototype.options_={children:["timeTooltip"]},ve.registerComponent("MouseTimeDisplay",$r);var Jr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.setEventHandlers_(),n}return F(e,t),e.prototype.setEventHandlers_=function(){var t=this;this.update=te(Zt(this,this.update),30),this.on(this.player_,"timeupdate",this.update),this.on(this.player_,"ended",this.handleEnded),this.updateInterval=null,this.on(this.player_,["playing"],function(){t.clearInterval(t.updateInterval),t.updateInterval=t.setInterval(function(){t.requestAnimationFrame(function(){t.update()})},30)}),this.on(this.player_,["ended","pause","waiting"],function(){t.clearInterval(t.updateInterval)}),this.on(this.player_,["timeupdate","ended"],this.update)},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},e.prototype.update_=function(t,e){var r=this.player_.duration();this.el_.setAttribute("aria-valuenow",(100*e).toFixed(2)),this.el_.setAttribute("aria-valuetext",this.localize("progress bar timing: currentTime={1} duration={2}",[jr(t,r),jr(r,r)],"{1} of {2}")),this.bar.update(yt(this.el_),e)},e.prototype.update=function(e){var r=t.prototype.update.call(this);return this.update_(this.getCurrentTime_(),r),r},e.prototype.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},e.prototype.handleEnded=function(t){this.update_(this.player_.duration(),1)},e.prototype.getPercent=function(){var t=this.getCurrentTime_()/this.player_.duration();return t>=1?1:t},e.prototype.handleMouseDown=function(e){At(e)&&(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),t.prototype.handleMouseDown.call(this,e))},e.prototype.handleMouseMove=function(t){if(At(t)){var e=this.calculateDistance(t)*this.player_.duration();e===this.player_.duration()&&(e-=.1),this.player_.currentTime(e)}},e.prototype.enable=function(){t.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.show()},e.prototype.disable=function(){t.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");e&&e.hide()},e.prototype.handleMouseUp=function(e){t.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying&&Le(this.player_.play())},e.prototype.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+5)},e.prototype.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-5)},e.prototype.handleAction=function(t){this.player_.paused()?this.player_.play():this.player_.pause()},e.prototype.handleKeyPress=function(e){32===e.which||13===e.which?(e.preventDefault(),this.handleAction(e)):t.prototype.handleKeyPress&&t.prototype.handleKeyPress.call(this,e)},e}(zr);Jr.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},R&&!(R>8)||y||_||Jr.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),Jr.prototype.playerEvent="timeupdate",ve.registerComponent("SeekBar",Jr);var Qr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.handleMouseMove=te(Zt(n,n.handleMouseMove),25),n.throttledHandleMouseSeek=te(Zt(n,n.handleMouseSeek),25),n.enable(),n}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},e.prototype.handleMouseMove=function(t){var e=this.getChild("seekBar");if(e){var r=e.getChild("mouseTimeDisplay"),i=e.el(),n=yt(i),a=_t(i,t).x;a>1?a=1:a<0&&(a=0),r&&r.update(n,a)}},e.prototype.handleMouseSeek=function(t){var e=this.getChild("seekBar");e&&e.handleMouseMove(t)},e.prototype.enabled=function(){return this.enabled_},e.prototype.disable=function(){this.children().forEach(function(t){return t.disable&&t.disable()}),this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},e.prototype.enable=function(){this.children().forEach(function(t){return t.enable&&t.enable()}),this.enabled()||(this.on(["mousedown","touchstart"],this.handleMouseDown),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},e.prototype.handleMouseDown=function(t){var e=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseDown(t),this.on(e,"mousemove",this.throttledHandleMouseSeek),this.on(e,"touchmove",this.throttledHandleMouseSeek),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseUp=function(t){var e=this.el_.ownerDocument,r=this.getChild("seekBar");r&&r.handleMouseUp(t),this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},e}(ve);Qr.prototype.options_={children:["seekBar"]},ve.registerComponent("ProgressControl",Qr);var Zr=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"fullscreenchange",n.handleFullscreenChange),!1===o[Te.fullscreenEnabled]&&n.disable(),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-fullscreen-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleFullscreenChange=function(t){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},e.prototype.handleClick=function(t){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},e}(Ir);Zr.prototype.controlText_="Fullscreen",ve.registerComponent("FullscreenToggle",Zr);var ti=function(t,e){e.tech_&&!e.tech_.featuresVolumeControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresVolumeControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},ei=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"></span>'})},e}(ve);ve.registerComponent("VolumeLevel",ei);var ri=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on("slideractive",n.updateLastVolume_),n.on(r,"volumechange",n.updateARIAAttributes),r.ready(function(){return n.updateARIAAttributes()}),n}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},e.prototype.handleMouseDown=function(e){At(e)&&t.prototype.handleMouseDown.call(this,e)},e.prototype.handleMouseMove=function(t){At(t)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(t)))},e.prototype.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},e.prototype.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},e.prototype.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},e.prototype.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},e.prototype.updateARIAAttributes=function(t){var e=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",e),this.el_.setAttribute("aria-valuetext",e+"%")},e.prototype.volumeAsPercentage_=function(){return Math.round(100*this.player_.volume())},e.prototype.updateLastVolume_=function(){var t=this,e=this.player_.volume();this.one("sliderinactive",function(){0===t.player_.volume()&&t.player_.lastVolume_(e)})},e}(zr);ri.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},ri.prototype.playerEvent="volumechange",ve.registerComponent("VolumeBar",ri);var ii=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(this,e),i.vertical=i.vertical||!1,(void 0===i.volumeBar||W(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical);var n=B(this,t.call(this,r,i));return ti(n,r),n.throttledHandleMouseMove=te(Zt(n,n.handleMouseMove),25),n.on("mousedown",n.handleMouseDown),n.on("touchstart",n.handleMouseDown),n.on(n.volumeBar,["focus","slideractive"],function(){n.volumeBar.addClass("vjs-slider-active"),n.addClass("vjs-slider-active"),n.trigger("slideractive")}),n.on(n.volumeBar,["blur","sliderinactive"],function(){n.volumeBar.removeClass("vjs-slider-active"),n.removeClass("vjs-slider-active"),n.trigger("sliderinactive")}),n}return F(e,t),e.prototype.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},e.prototype.handleMouseDown=function(t){var e=this.el_.ownerDocument;this.on(e,"mousemove",this.throttledHandleMouseMove),this.on(e,"touchmove",this.throttledHandleMouseMove),this.on(e,"mouseup",this.handleMouseUp),this.on(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseUp=function(t){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseMove),this.off(e,"touchmove",this.throttledHandleMouseMove),this.off(e,"mouseup",this.handleMouseUp),this.off(e,"touchend",this.handleMouseUp)},e.prototype.handleMouseMove=function(t){this.volumeBar.handleMouseMove(t)},e}(ve);ii.prototype.options_={children:["volumeBar"]},ve.registerComponent("VolumeControl",ii);var ni=function(t,e){e.tech_&&!e.tech_.featuresMuteControl&&t.addClass("vjs-hidden"),t.on(e,"loadstart",function(){e.tech_.featuresMuteControl?t.removeClass("vjs-hidden"):t.addClass("vjs-hidden")})},ai=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return ni(n,r),n.on(r,["loadstart","volumechange"],n.update),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-mute-control "+t.prototype.buildCSSClass.call(this)},e.prototype.handleClick=function(t){var e=this.player_.volume(),r=this.player_.lastVolume_();if(0===e){var i=r<.1?.1:r;this.player_.volume(i),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},e.prototype.update=function(t){this.updateIcon_(),this.updateControlText_()},e.prototype.updateIcon_=function(){var t=this.player_.volume(),e=3;y&&this.player_.muted(this.player_.tech_.el_.muted),0===t||this.player_.muted()?e=0:t<.33?e=1:t<.67&&(e=2);for(var r=0;r<4;r++)ut(this.el_,"vjs-vol-"+r);lt(this.el_,"vjs-vol-"+e)},e.prototype.updateControlText_=function(){var t=this.player_.muted()||0===this.player_.volume()?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)},e}(Ir);ai.prototype.controlText_="Mute",ve.registerComponent("MuteToggle",ai);var oi=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(this,e),void 0!==i.inline?i.inline=i.inline:i.inline=!0,(void 0===i.volumeControl||W(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline);var n=B(this,t.call(this,r,i));return n.on(r,["loadstart"],n.volumePanelState_),n.on(n.volumeControl,["slideractive"],n.sliderActive_),n.on(n.volumeControl,["sliderinactive"],n.sliderInactive_),n}return F(e,t),e.prototype.sliderActive_=function(){this.addClass("vjs-slider-active")},e.prototype.sliderInactive_=function(){this.removeClass("vjs-slider-active")},e.prototype.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},e.prototype.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),t.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},e}(ve);oi.prototype.options_={children:["muteToggle","volumeControl"]},ve.registerComponent("VolumePanel",oi);var si=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return i&&(n.menuButton_=i.menuButton),n.focusedChild_=-1,n.on("keydown",n.handleKeyPress),n}return F(e,t),e.prototype.addItem=function(t){this.addChild(t),t.on("click",Zt(this,function(e){this.menuButton_&&(this.menuButton_.unpressButton(),"CaptionSettingsMenuItem"!==t.name()&&this.menuButton_.focus())}))},e.prototype.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=nt(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var r=t.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return r.appendChild(this.contentEl_),Ht(r,"click",function(t){t.preventDefault(),t.stopImmediatePropagation()}),r},e.prototype.dispose=function(){this.contentEl_=null,t.prototype.dispose.call(this)},e.prototype.handleKeyPress=function(t){37===t.which||40===t.which?(t.preventDefault(),this.stepForward()):38!==t.which&&39!==t.which||(t.preventDefault(),this.stepBack())},e.prototype.stepForward=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_+1),this.focus(t)},e.prototype.stepBack=function(){var t=0;void 0!==this.focusedChild_&&(t=this.focusedChild_-1),this.focus(t)},e.prototype.focus=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.children().slice();e.length&&e[0].className&&/vjs-menu-title/.test(e[0].className)&&e.shift(),e.length>0&&(t<0?t=0:t>=e.length&&(t=e.length-1),this.focusedChild_=t,e[t].el_.focus())},e}(ve);ve.registerComponent("Menu",si);var li=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(this,e);var n=B(this,t.call(this,r,i));n.menuButton_=new Ir(r,i),n.menuButton_.controlText(n.controlText_),n.menuButton_.el_.setAttribute("aria-haspopup","true");var a=Ir.prototype.buildCSSClass();return n.menuButton_.el_.className=n.buildCSSClass()+" "+a,n.menuButton_.removeClass("vjs-control"),n.addChild(n.menuButton_),n.update(),n.enabled_=!0,n.on(n.menuButton_,"tap",n.handleClick),n.on(n.menuButton_,"click",n.handleClick),n.on(n.menuButton_,"focus",n.handleFocus),n.on(n.menuButton_,"blur",n.handleBlur),n.on("keydown",n.handleSubmenuKeyPress),n}return F(e,t),e.prototype.update=function(){var t=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=t,this.addChild(t),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},e.prototype.createMenu=function(){var t=new si(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var e=nt("li",{className:"vjs-menu-title",innerHTML:pe(this.options_.title),tabIndex:-1});this.hideThreshold_+=1,t.children_.unshift(e),ot(e,t.contentEl())}if(this.items=this.createItems(),this.items)for(var r=0;r<this.items.length;r++)t.addItem(this.items[r]);return t},e.prototype.createItems=function(){},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},e.prototype.buildWrapperCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+Ir.prototype.buildCSSClass()+" "+t.prototype.buildCSSClass.call(this)},e.prototype.buildCSSClass=function(){var e="vjs-menu-button";return!0===this.options_.inline?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+t.prototype.buildCSSClass.call(this)},e.prototype.controlText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.menuButton_.el();return this.menuButton_.controlText(t,e)},e.prototype.handleClick=function(t){this.one(this.menu.contentEl(),"mouseleave",Zt(this,function(t){this.unpressButton(),this.el_.blur()})),this.buttonPressed_?this.unpressButton():this.pressButton()},e.prototype.focus=function(){this.menuButton_.focus()},e.prototype.blur=function(){this.menuButton_.blur()},e.prototype.handleFocus=function(){Ht(o,"keydown",Zt(this,this.handleKeyPress))},e.prototype.handleBlur=function(){Vt(o,"keydown",Zt(this,this.handleKeyPress))},e.prototype.handleKeyPress=function(t){27===t.which||9===t.which?(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus())):38!==t.which&&40!==t.which||this.buttonPressed_||(this.pressButton(),t.preventDefault())},e.prototype.handleSubmenuKeyPress=function(t){27!==t.which&&9!==t.which||(this.buttonPressed_&&this.unpressButton(),9!==t.which&&(t.preventDefault(),this.menuButton_.el_.focus()))},e.prototype.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),y&&rt())return;this.menu.focus()}},e.prototype.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},e.prototype.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},e.prototype.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},e}(ve);ve.registerComponent("MenuButton",li);var ui=function(t){function e(r,i){N(this,e);var n=i.tracks,a=B(this,t.call(this,r,i));if(a.items.length<=1&&a.hide(),!n)return B(a);var o=Zt(a,a.update);return n.addEventListener("removetrack",o),n.addEventListener("addtrack",o),a.player_.on("ready",o),a.player_.on("dispose",function(){n.removeEventListener("removetrack",o),n.removeEventListener("addtrack",o)}),a}return F(e,t),e}(li);ve.registerComponent("TrackButton",ui);var ci=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.selectable=i.selectable,n.isSelected_=i.selected||!1,n.multiSelectable=i.multiSelectable,n.selected(n.isSelected_),n.selectable?n.multiSelectable?n.el_.setAttribute("role","menuitemcheckbox"):n.el_.setAttribute("role","menuitemradio"):n.el_.setAttribute("role","menuitem"),n}return F(e,t),e.prototype.createEl=function(e,r,i){return this.nonIconControl=!0,t.prototype.createEl.call(this,"li",V({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"</span>",tabIndex:-1},r),i)},e.prototype.handleClick=function(t){this.selected(!0)},e.prototype.selected=function(t){this.selectable&&(t?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},e}(Ar);ve.registerComponent("MenuItem",ci);var hi=function(t){function e(r,i){N(this,e);var n=i.track,s=r.textTracks();i.label=n.label||n.language||"Unknown",i.selected="showing"===n.mode;var l=B(this,t.call(this,r,i));l.track=n;var u=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];l.handleTracksChange.apply(l,e)},c=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];l.handleSelectedLanguageChange.apply(l,e)};if(r.on(["loadstart","texttrackchange"],u),s.addEventListener("change",u),s.addEventListener("selectedlanguagechange",c),l.on("dispose",function(){r.off(["loadstart","texttrackchange"],u),s.removeEventListener("change",u),s.removeEventListener("selectedlanguagechange",c)}),void 0===s.onchange){var h=void 0;l.on(["tap","click"],function(){if("object"!==M(a.Event))try{h=new a.Event("change")}catch(t){}h||(h=o.createEvent("Event")).initEvent("change",!0,!0),s.dispatchEvent(h)})}return l.handleTracksChange(),l}return F(e,t),e.prototype.handleClick=function(e){var r=this.track.kind,i=this.track.kinds,n=this.player_.textTracks();if(i||(i=[r]),t.prototype.handleClick.call(this,e),n)for(var a=0;a<n.length;a++){var o=n[a];o===this.track&&i.indexOf(o.kind)>-1?"showing"!==o.mode&&(o.mode="showing"):"disabled"!==o.mode&&(o.mode="disabled")}},e.prototype.handleTracksChange=function(t){var e="showing"===this.track.mode;e!==this.isSelected_&&this.selected(e)},e.prototype.handleSelectedLanguageChange=function(t){if("showing"===this.track.mode){var e=this.player_.cache_.selectedLanguage;if(e&&e.enabled&&e.language===this.track.language&&e.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},e.prototype.dispose=function(){this.track=null,t.prototype.dispose.call(this)},e}(ci);ve.registerComponent("TextTrackMenuItem",hi);var di=function(t){function e(r,i){return N(this,e),i.track={player:r,kind:i.kind,kinds:i.kinds,default:!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.label?i.track.label=i.label:i.track.label=i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,B(this,t.call(this,r,i))}return F(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),r=!0,i=0,n=e.length;i<n;i++){var a=e[i];if(this.options_.kinds.indexOf(a.kind)>-1&&"showing"===a.mode){r=!1;break}}r!==this.isSelected_&&this.selected(r)},e.prototype.handleSelectedLanguageChange=function(t){for(var e=this.player().textTracks(),r=!0,i=0,n=e.length;i<n;i++){var a=e[i];if(["captions","descriptions","subtitles"].indexOf(a.kind)>-1&&"showing"===a.mode){r=!1;break}}r&&(this.player_.cache_.selectedLanguage={enabled:!1})},e}(hi);ve.registerComponent("OffTextTrackMenuItem",di);var fi=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return N(this,e),i.tracks=r.textTracks(),B(this,t.call(this,r,i))}return F(e,t),e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hi,r=void 0;this.label_&&(r=this.label_+" off"),t.push(new di(this.player_,{kinds:this.kinds_,kind:this.kind_,label:r})),this.hideThreshold_+=1;var i=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var n=0;n<i.length;n++){var a=i[n];if(this.kinds_.indexOf(a.kind)>-1){var o=new e(this.player_,{track:a,selectable:!0,multiSelectable:!1});o.addClass("vjs-"+a.kind+"-menu-item"),t.push(o)}}return t},e}(ui);ve.registerComponent("TextTrackButton",fi);var pi=function(t){function e(r,i){N(this,e);var n=i.track,a=i.cue,o=r.currentTime();i.selectable=!0,i.multiSelectable=!1,i.label=a.text,i.selected=a.startTime<=o&&o<a.endTime;var s=B(this,t.call(this,r,i));return s.track=n,s.cue=a,n.addEventListener("cuechange",Zt(s,s.update)),s}return F(e,t),e.prototype.handleClick=function(e){t.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},e.prototype.update=function(t){var e=this.cue,r=this.player_.currentTime();this.selected(e.startTime<=r&&r<e.endTime)},e}(ci);ve.registerComponent("ChaptersTrackMenuItem",pi);var gi=function(t){function e(r,i,n){return N(this,e),B(this,t.call(this,r,i,n))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-chapters-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.update=function(e){this.track_&&(!e||"addtrack"!==e.type&&"removetrack"!==e.type)||this.setTrack(this.findChaptersTrack()),t.prototype.update.call(this)},e.prototype.setTrack=function(t){if(this.track_!==t){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var e=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);e&&e.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=t,this.track_){this.track_.mode="hidden";var r=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);r&&r.addEventListener("load",this.updateHandler_)}}},e.prototype.findChaptersTrack=function(){for(var t=this.player_.textTracks()||[],e=t.length-1;e>=0;e--){var r=t[e];if(r.kind===this.kind_)return r}},e.prototype.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(pe(this.kind_))},e.prototype.createMenu=function(){return this.options_.title=this.getMenuCaption(),t.prototype.createMenu.call(this)},e.prototype.createItems=function(){var t=[];if(!this.track_)return t;var e=this.track_.cues;if(!e)return t;for(var r=0,i=e.length;r<i;r++){var n=e[r],a=new pi(this.player_,{track:this.track_,cue:n});t.push(a)}return t},e}(fi);gi.prototype.kind_="chapters",gi.prototype.controlText_="Chapters",ve.registerComponent("ChaptersButton",gi);var vi=function(t){function e(r,i,n){N(this,e);var a=B(this,t.call(this,r,i,n)),o=r.textTracks(),s=Zt(a,a.handleTracksChange);return o.addEventListener("change",s),a.on("dispose",function(){o.removeEventListener("change",s)}),a}return F(e,t),e.prototype.handleTracksChange=function(t){for(var e=this.player().textTracks(),r=!1,i=0,n=e.length;i<n;i++){var a=e[i];if(a.kind!==this.kind_&&"showing"===a.mode){r=!0;break}}r?this.disable():this.enable()},e.prototype.buildCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(fi);vi.prototype.kind_="descriptions",vi.prototype.controlText_="Descriptions",ve.registerComponent("DescriptionsButton",vi);var mi=function(t){function e(r,i,n){return N(this,e),B(this,t.call(this,r,i,n))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+t.prototype.buildWrapperCSSClass.call(this)},e}(fi);mi.prototype.kind_="subtitles",mi.prototype.controlText_="Subtitles",ve.registerComponent("SubtitlesButton",mi);var yi=function(t){function e(r,i){N(this,e),i.track={player:r,kind:i.kind,label:i.kind+" settings",selectable:!1,default:!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem";var n=B(this,t.call(this,r,i));return n.addClass("vjs-texttrack-settings"),n.controlText(", opens "+i.kind+" settings dialog"),n}return F(e,t),e.prototype.handleClick=function(t){this.player().getChild("textTrackSettings").open()},e}(hi);ve.registerComponent("CaptionSettingsMenuItem",yi);var bi=function(t){function e(r,i,n){return N(this,e),B(this,t.call(this,r,i,n))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-captions-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-captions-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new yi(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),t.prototype.createItems.call(this,e)},e}(fi);bi.prototype.kind_="captions",bi.prototype.controlText_="Captions",ve.registerComponent("CaptionsButton",bi);var _i=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(e,r,i){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"captions"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"</span>\n      "),n+="</span>",t.prototype.createEl.call(this,e,V({innerHTML:n},r),i)},e}(hi);ve.registerComponent("SubsCapsMenuItem",_i);var Ti=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};N(this,e);var n=B(this,t.call(this,r,i));return n.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(n.player_.language_)>-1&&(n.label_="captions"),n.menuButton_.controlText(pe(n.label_)),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var e=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(e.push(new yi(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=t.prototype.createItems.call(this,e,_i)},e}(fi);Ti.prototype.kinds_=["captions","subtitles"],Ti.prototype.controlText_="Subtitles",ve.registerComponent("SubsCapsButton",Ti);var Ei=function(t){function e(r,i){N(this,e);var n=i.track,a=r.audioTracks();i.label=n.label||n.language||"Unknown",i.selected=n.enabled;var o=B(this,t.call(this,r,i));o.track=n,o.addClass("vjs-"+n.kind+"-menu-item");var s=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];o.handleTracksChange.apply(o,e)};return a.addEventListener("change",s),o.on("dispose",function(){a.removeEventListener("change",s)}),o}return F(e,t),e.prototype.createEl=function(e,r,i){var n='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return"main-desc"===this.options_.track.kind&&(n+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"></span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"</span>\n      "),n+="</span>",t.prototype.createEl.call(this,e,V({innerHTML:n},r),i)},e.prototype.handleClick=function(e){var r=this.player_.audioTracks();t.prototype.handleClick.call(this,e);for(var i=0;i<r.length;i++){var n=r[i];n.enabled=n===this.track}},e.prototype.handleTracksChange=function(t){this.selected(this.track.enabled)},e}(ci);ve.registerComponent("AudioTrackMenuItem",Ei);var Si=function(t){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return N(this,e),i.tracks=r.audioTracks(),B(this,t.call(this,r,i))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-audio-button "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-audio-button "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createItems=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.hideThreshold_=1;for(var e=this.player_.audioTracks(),r=0;r<e.length;r++){var i=e[r];t.push(new Ei(this.player_,{track:i,selectable:!0,multiSelectable:!1}))}return t},e}(ui);Si.prototype.controlText_="Audio Track",ve.registerComponent("AudioTrackButton",Si);var wi=function(t){function e(r,i){N(this,e);var n=i.rate,a=parseFloat(n,10);i.label=n,i.selected=1===a,i.selectable=!0,i.multiSelectable=!1;var o=B(this,t.call(this,r,i));return o.label=n,o.rate=a,o.on(r,"ratechange",o.update),o}return F(e,t),e.prototype.handleClick=function(e){t.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},e.prototype.update=function(t){this.selected(this.player().playbackRate()===this.rate)},e}(ci);wi.prototype.contentElType="button",ve.registerComponent("PlaybackRateMenuItem",wi);var ki=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.updateVisibility(),n.updateLabel(),n.on(r,"loadstart",n.updateVisibility),n.on(r,"ratechange",n.updateLabel),n}return F(e,t),e.prototype.createEl=function(){var e=t.prototype.createEl.call(this);return this.labelEl_=nt("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),e.appendChild(this.labelEl_),e},e.prototype.dispose=function(){this.labelEl_=null,t.prototype.dispose.call(this)},e.prototype.buildCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildCSSClass.call(this)},e.prototype.buildWrapperCSSClass=function(){return"vjs-playback-rate "+t.prototype.buildWrapperCSSClass.call(this)},e.prototype.createMenu=function(){var t=new si(this.player()),e=this.playbackRates();if(e)for(var r=e.length-1;r>=0;r--)t.addChild(new wi(this.player(),{rate:e[r]+"x"}));return t},e.prototype.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},e.prototype.handleClick=function(t){for(var e=this.player().playbackRate(),r=this.playbackRates(),i=r[0],n=0;n<r.length;n++)if(r[n]>e){i=r[n];break}this.player().playbackRate(i)},e.prototype.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},e.prototype.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},e.prototype.updateVisibility=function(t){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},e.prototype.updateLabel=function(t){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},e}(li);ki.prototype.controlText_="Playback Rate",ve.registerComponent("PlaybackRateMenuButton",ki);var Ai=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},e}(ve);ve.registerComponent("Spacer",Ai);var Ci=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-custom-control-spacer "+t.prototype.buildCSSClass.call(this)},e.prototype.createEl=function(){var e=t.prototype.createEl.call(this,{className:this.buildCSSClass()});return e.innerHTML=" ",e},e}(Ai);ve.registerComponent("CustomControlSpacer",Ci);var xi=function(t){function e(){return N(this,e),B(this,t.apply(this,arguments))}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},e}(ve);xi.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},ve.registerComponent("ControlBar",xi);var Ri=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i));return n.on(r,"error",n.open),n}return F(e,t),e.prototype.buildCSSClass=function(){return"vjs-error-display "+t.prototype.buildCSSClass.call(this)},e.prototype.content=function(){var t=this.player().error();return t?this.localize(t.message):""},e}(Me);Ri.prototype.options_=ge(Me.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),ve.registerComponent("ErrorDisplay",Ri);var Li=["#000","Black"],Di=["#00F","Blue"],Oi=["#0FF","Cyan"],Ii=["#0F0","Green"],Pi=["#F0F","Magenta"],Mi=["#F00","Red"],Ni=["#FFF","White"],Fi=["#FF0","Yellow"],Bi=["1","Opaque"],ji=["0.5","Semi-Transparent"],Ui=["0","Transparent"],Gi={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[Li,Ni,Mi,Ii,Di,Fi,Pi,Oi]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[Bi,ji,Ui]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Ni,Li,Mi,Ii,Di,Fi,Pi,Oi]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(t){return"1.00"===t?null:Number(t)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[Bi,ji]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ui,ji,Bi]}};function Hi(t,e){if(e&&(t=e(t)),t&&"none"!==t)return t}Gi.windowColor.options=Gi.backgroundColor.options;var Vi=function(t){function e(r,i){N(this,e),i.temporary=!1;var n=B(this,t.call(this,r,i));return n.updateDisplay=Zt(n,n.updateDisplay),n.fill(),n.hasBeenOpened_=n.hasBeenFilled_=!0,n.endDialog=nt("p",{className:"vjs-control-text",textContent:n.localize("End of dialog window.")}),n.el().appendChild(n.endDialog),n.setDefaults(),void 0===i.persistTextTrackSettings&&(n.options_.persistTextTrackSettings=n.options_.playerOptions.persistTextTrackSettings),n.on(n.$(".vjs-done-button"),"click",function(){n.saveSettings(),n.close()}),n.on(n.$(".vjs-default-button"),"click",function(){n.setDefaults(),n.updateDisplay()}),H(Gi,function(t){n.on(n.$(t.selector),"change",n.updateDisplay)}),n.options_.persistTextTrackSettings&&n.restoreSettings(),n}return F(e,t),e.prototype.dispose=function(){this.endDialog=null,t.prototype.dispose.call(this)},e.prototype.createElSelect_=function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"label",n=Gi[t],a=n.id.replace("%s",this.id_),o=[r,a].join(" ").trim();return["<"+i+' id="'+a+'" class="'+("label"===i?"vjs-label":"")+'">',this.localize(n.label),"</"+i+">",'<select aria-labelledby="'+o+'">'].concat(n.options.map(function(t){var r=a+"-"+t[1].replace(/\W+/g,"");return['<option id="'+r+'" value="'+t[0]+'" ','aria-labelledby="'+o+" "+r+'">',e.localize(t[1]),"</option>"].join("")})).concat("</select>").join("")},e.prototype.createElFgColor_=function(){var t="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",t),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",t),"</span>","</fieldset>"].join("")},e.prototype.createElBgColor_=function(){var t="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",t),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",t),"</span>","</fieldset>"].join("")},e.prototype.createElWinColor_=function(){var t="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+t+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",t),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",t),"</span>","</fieldset>"].join("")},e.prototype.createElColors_=function(){return nt("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},e.prototype.createElFont_=function(){return nt("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},e.prototype.createElControls_=function(){var t=this.localize("restore all settings to the default values");return nt("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+t+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+t+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},e.prototype.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},e.prototype.label=function(){return this.localize("Caption Settings Dialog")},e.prototype.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},e.prototype.buildCSSClass=function(){return t.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},e.prototype.getValues=function(){var t=this;return function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return G(t).reduce(function(r,i){return e(r,t[i],i)},r)}(Gi,function(e,r,i){var n,a,o=(n=t.$(r.selector),a=r.parser,Hi(n.options[n.options.selectedIndex].value,a));return void 0!==o&&(e[i]=o),e},{})},e.prototype.setValues=function(t){var e=this;H(Gi,function(r,i){!function(t,e,r){if(e)for(var i=0;i<t.options.length;i++)if(Hi(t.options[i].value,r)===e){t.selectedIndex=i;break}}(e.$(r.selector),t[i],r.parser)})},e.prototype.setDefaults=function(){var t=this;H(Gi,function(e){var r=e.hasOwnProperty("default")?e.default:0;t.$(e.selector).selectedIndex=r})},e.prototype.restoreSettings=function(){var t=void 0;try{t=JSON.parse(a.localStorage.getItem("vjs-text-track-settings"))}catch(t){Y.warn(t)}t&&this.setValues(t)},e.prototype.saveSettings=function(){if(this.options_.persistTextTrackSettings){var t=this.getValues();try{Object.keys(t).length?a.localStorage.setItem("vjs-text-track-settings",JSON.stringify(t)):a.localStorage.removeItem("vjs-text-track-settings")}catch(t){Y.warn(t)}}},e.prototype.updateDisplay=function(){var t=this.player_.getChild("textTrackDisplay");t&&t.updateDisplay()},e.prototype.conditionalBlur_=function(){this.previouslyActiveEl_=null,this.off(o,"keydown",this.handleKeyDown);var t=this.player_.controlBar,e=t&&t.subsCapsButton,r=t&&t.captionsButton;e?e.focus():r&&r.focus()},e}(Me);ve.registerComponent("TextTrackSettings",Vi);var Ki=function(t){function e(r,i){N(this,e);var n=i.ResizeObserver||a.ResizeObserver;null===i.ResizeObserver&&(n=!1);var o=ge({createEl:!n},i),s=B(this,t.call(this,r,o));return s.ResizeObserver=i.ResizeObserver||a.ResizeObserver,s.loadListener_=null,s.resizeObserver_=null,s.debouncedHandler_=ee(function(){s.resizeHandler()},100,!1,s),n?(s.resizeObserver_=new s.ResizeObserver(s.debouncedHandler_),s.resizeObserver_.observe(r.el())):(s.loadListener_=function(){s.el_&&s.el_.contentWindow&&Ht(s.el_.contentWindow,"resize",s.debouncedHandler_)},s.one("load",s.loadListener_)),s}return F(e,t),e.prototype.createEl=function(){return t.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager"})},e.prototype.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},e.prototype.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.el_&&this.el_.contentWindow&&Vt(this.el_.contentWindow,"resize",this.debouncedHandler_),this.loadListener_&&this.off("load",this.loadListener_),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null},e}(ve);ve.registerComponent("ResizeManager",Ki);var Wi=function(t){var e=t.el();if(e.hasAttribute("src"))return t.triggerSourceset(e.src),!0;var r=t.$$("source"),i=[],n="";if(!r.length)return!1;for(var a=0;a<r.length;a++){var o=r[a].src;o&&-1===i.indexOf(o)&&i.push(o)}return!!i.length&&(1===i.length&&(n=i[0]),t.triggerSourceset(n),!0)},zi={};x||(zi=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(t){var e=o.createElement(this.nodeName.toLowerCase());e.innerHTML=t;for(var r=o.createDocumentFragment();e.childNodes.length;)r.appendChild(e.childNodes[0]);return this.innerText="",a.Element.prototype.appendChild.call(this,r),this.innerHTML}}));var qi=function(t,e){for(var r={},i=0;i<t.length&&!((r=Object.getOwnPropertyDescriptor(t[i],e))&&r.set&&r.get);i++);return r.enumerable=!0,r.configurable=!0,r},Yi=function(t){var e=t.el();if(!e.resetSourceWatch_){var r={},i=function(t){return qi([t.el(),a.HTMLMediaElement.prototype,a.Element.prototype,zi],"innerHTML")}(t),n=function(r){return function(){for(var i=arguments.length,n=Array(i),a=0;a<i;a++)n[a]=arguments[a];var o=r.apply(e,n);return Wi(t),o}};["append","appendChild","insertAdjacentHTML"].forEach(function(t){e[t]&&(r[t]=e[t],e[t]=n(r[t]))}),Object.defineProperty(e,"innerHTML",ge(i,{set:n(i.set)})),e.resetSourceWatch_=function(){e.resetSourceWatch_=null,Object.keys(r).forEach(function(t){e[t]=r[t]}),Object.defineProperty(e,"innerHTML",i)},t.one("sourceset",e.resetSourceWatch_)}},Xi={};x||(Xi=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Je(a.Element.prototype.getAttribute.call(this,"src")):""},set:function(t){return a.Element.prototype.setAttribute.call(this,"src",t),t}}));var $i=function(t){if(t.featuresSourceset){var e=t.el();if(!e.resetSourceset_){var r=function(t){return qi([t.el(),a.HTMLMediaElement.prototype,Xi],"src")}(t),i=e.setAttribute,n=e.load;Object.defineProperty(e,"src",ge(r,{set:function(i){var n=r.set.call(e,i);return t.triggerSourceset(e.src),n}})),e.setAttribute=function(r,n){var a=i.call(e,r,n);return/src/i.test(r)&&t.triggerSourceset(e.src),a},e.load=function(){var r=n.call(e);return Wi(t)||(t.triggerSourceset(""),Yi(t)),r},e.currentSrc?t.triggerSourceset(e.currentSrc):Wi(t)||Yi(t),e.resetSourceset_=function(){e.resetSourceset_=null,e.load=n,e.setAttribute=i,Object.defineProperty(e,"src",r),e.resetSourceWatch_&&e.resetSourceWatch_()}}}},Ji=j(["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."],["Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\n            This may prevent text tracks from loading."]),Qi=function(t){function e(r,i){N(this,e);var n=B(this,t.call(this,r,i)),a=r.source,o=!1;if(a&&(n.el_.currentSrc!==a.src||r.tag&&3===r.tag.initNetworkState_)?n.setSource(a):n.handleLateInit_(n.el_),r.enableSourceset&&n.setupSourcesetHandling_(),n.el_.hasChildNodes()){for(var l=n.el_.childNodes,u=l.length,c=[];u--;){var h=l[u];"track"===h.nodeName.toLowerCase()&&(n.featuresNativeTextTracks?(n.remoteTextTrackEls().addTrackElement_(h),n.remoteTextTracks().addTrack(h.track),n.textTracks().addTrack(h.track),o||n.el_.hasAttribute("crossorigin")||!Ze(h.src)||(o=!0)):c.push(h))}for(var d=0;d<c.length;d++)n.el_.removeChild(c[d])}return n.proxyNativeTracks_(),n.featuresNativeTextTracks&&o&&Y.warn(s(Ji)),n.restoreMetadataTracksInIOSNativePlayer_(),(O||v||S)&&!0===r.nativeControlsForTouch&&n.setControls(!0),n.proxyWebkitFullscreen_(),n.triggerReady(),n}return F(e,t),e.prototype.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),e.disposeMediaElement(this.el_),this.options_=null,t.prototype.dispose.call(this)},e.prototype.setupSourcesetHandling_=function(){$i(this)},e.prototype.restoreMetadataTracksInIOSNativePlayer_=function(){var t=this.textTracks(),e=void 0,r=function(){e=[];for(var r=0;r<t.length;r++){var i=t[r];"metadata"===i.kind&&e.push({track:i,storedMode:i.mode})}};r(),t.addEventListener("change",r),this.on("dispose",function(){return t.removeEventListener("change",r)});var i=function r(){for(var i=0;i<e.length;i++){var n=e[i];"disabled"===n.track.mode&&n.track.mode!==n.storedMode&&(n.track.mode=n.storedMode)}t.removeEventListener("change",r)};this.on("webkitbeginfullscreen",function(){t.removeEventListener("change",r),t.removeEventListener("change",i),t.addEventListener("change",i)}),this.on("webkitendfullscreen",function(){t.removeEventListener("change",r),t.addEventListener("change",r),t.removeEventListener("change",i)})},e.prototype.proxyNativeTracks_=function(){var t=this;ur.names.forEach(function(e){var r=ur[e],i=t.el()[r.getterName],n=t[r.getterName]();if(t["featuresNative"+r.capitalName+"Tracks"]&&i&&i.addEventListener){var a={change:function(t){n.trigger({type:"change",target:n,currentTarget:n,srcElement:n})},addtrack:function(t){n.addTrack(t.track)},removetrack:function(t){n.removeTrack(t.track)}},o=function(){for(var t=[],e=0;e<n.length;e++){for(var r=!1,a=0;a<i.length;a++)if(i[a]===n[e]){r=!0;break}r||t.push(n[e])}for(;t.length;)n.removeTrack(t.shift())};Object.keys(a).forEach(function(e){var r=a[e];i.addEventListener(e,r),t.on("dispose",function(t){return i.removeEventListener(e,r)})}),t.on("loadstart",o),t.on("dispose",function(e){return t.off("loadstart",o)})}})},e.prototype.createEl=function(){var t=this.options_.tag;if(!t||!this.options_.playerElIngest&&!this.movingMediaElementInDOM){if(t){var r=t.cloneNode(!0);t.parentNode&&t.parentNode.insertBefore(r,t),e.disposeMediaElement(t),t=r}else{t=o.createElement("video");var i=ge({},this.options_.tag&&dt(this.options_.tag));O&&!0===this.options_.nativeControlsForTouch||delete i.controls,ht(t,V(i,{id:this.options_.techId,class:"vjs-tech"}))}t.playerId=this.options_.playerId}void 0!==this.options_.preload&&pt(t,"preload",this.options_.preload);for(var n=["loop","muted","playsinline","autoplay"],a=0;a<n.length;a++){var s=n[a],l=this.options_[s];void 0!==l&&(l?pt(t,s,s):gt(t,s),t[s]=l)}return t},e.prototype.handleLateInit_=function(t){if(0!==t.networkState&&3!==t.networkState){if(0===t.readyState){var e=!1,r=function(){e=!0};this.on("loadstart",r);var i=function(){e||this.trigger("loadstart")};return this.on("loadedmetadata",i),void this.ready(function(){this.off("loadstart",r),this.off("loadedmetadata",i),e||this.trigger("loadstart")})}var n=["loadstart"];n.push("loadedmetadata"),t.readyState>=2&&n.push("loadeddata"),t.readyState>=3&&n.push("canplay"),t.readyState>=4&&n.push("canplaythrough"),this.ready(function(){n.forEach(function(t){this.trigger(t)},this)})}},e.prototype.setCurrentTime=function(t){try{this.el_.currentTime=t}catch(t){Y(t,"Video is not ready. (Video.js)")}},e.prototype.duration=function(){var t=this;if(this.el_.duration===1/0&&_&&A&&0===this.el_.currentTime){return this.on("timeupdate",function e(){t.el_.currentTime>0&&(t.el_.duration===1/0&&t.trigger("durationchange"),t.off("timeupdate",e))}),NaN}return this.el_.duration||NaN},e.prototype.width=function(){return this.el_.offsetWidth},e.prototype.height=function(){return this.el_.offsetHeight},e.prototype.proxyWebkitFullscreen_=function(){var t=this;if("webkitDisplayingFullscreen"in this.el_){var e=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},r=function(){"webkitPresentationMode"in this.el_&&"picture-in-picture"!==this.el_.webkitPresentationMode&&(this.one("webkitendfullscreen",e),this.trigger("fullscreenchange",{isFullscreen:!0}))};this.on("webkitbeginfullscreen",r),this.on("dispose",function(){t.off("webkitbeginfullscreen",r),t.off("webkitendfullscreen",e)})}},e.prototype.supportsFullScreen=function(){if("function"==typeof this.el_.webkitEnterFullScreen){var t=a.navigator&&a.navigator.userAgent||"";if(/Android/.test(t)||!/Chrome|Mac OS X 10.5/.test(t))return!0}return!1},e.prototype.enterFullScreen=function(){var t=this.el_;t.paused&&t.networkState<=t.HAVE_METADATA?(this.el_.play(),this.setTimeout(function(){t.pause(),t.webkitEnterFullScreen()},0)):t.webkitEnterFullScreen()},e.prototype.exitFullScreen=function(){this.el_.webkitExitFullScreen()},e.prototype.src=function(t){if(void 0===t)return this.el_.src;this.setSrc(t)},e.prototype.reset=function(){e.resetMediaElement(this.el_)},e.prototype.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},e.prototype.setControls=function(t){this.el_.controls=!!t},e.prototype.addTextTrack=function(e,r,i){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,r,i):t.prototype.addTextTrack.call(this,e,r,i)},e.prototype.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return t.prototype.createRemoteTextTrack.call(this,e);var r=o.createElement("track");return e.kind&&(r.kind=e.kind),e.label&&(r.label=e.label),(e.language||e.srclang)&&(r.srclang=e.language||e.srclang),e.default&&(r.default=e.default),e.id&&(r.id=e.id),e.src&&(r.src=e.src),r},e.prototype.addRemoteTextTrack=function(e,r){var i=t.prototype.addRemoteTextTrack.call(this,e,r);return this.featuresNativeTextTracks&&this.el().appendChild(i),i},e.prototype.removeRemoteTextTrack=function(e){if(t.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var r=this.$$("track"),i=r.length;i--;)e!==r[i]&&e!==r[i].track||this.el().removeChild(r[i])},e.prototype.getVideoPlaybackQuality=function(){if("function"==typeof this.el().getVideoPlaybackQuality)return this.el().getVideoPlaybackQuality();var t={};return void 0!==this.el().webkitDroppedFrameCount&&void 0!==this.el().webkitDecodedFrameCount&&(t.droppedVideoFrames=this.el().webkitDroppedFrameCount,t.totalVideoFrames=this.el().webkitDecodedFrameCount),a.performance&&"function"==typeof a.performance.now?t.creationTime=a.performance.now():a.performance&&a.performance.timing&&"number"==typeof a.performance.timing.navigationStart&&(t.creationTime=a.Date.now()-a.performance.timing.navigationStart),t},e}(dr);if(tt()){Qi.TEST_VID=o.createElement("video");var Zi=o.createElement("track");Zi.kind="captions",Zi.srclang="en",Zi.label="English",Qi.TEST_VID.appendChild(Zi)}Qi.isSupported=function(){try{Qi.TEST_VID.volume=.5}catch(t){return!1}return!(!Qi.TEST_VID||!Qi.TEST_VID.canPlayType)},Qi.canPlayType=function(t){return Qi.TEST_VID.canPlayType(t)},Qi.canPlaySource=function(t,e){return Qi.canPlayType(t.type)},Qi.canControlVolume=function(){try{var t=Qi.TEST_VID.volume;return Qi.TEST_VID.volume=t/2+.1,t!==Qi.TEST_VID.volume}catch(t){return!1}},Qi.canMuteVolume=function(){try{var t=Qi.TEST_VID.muted;return Qi.TEST_VID.muted=!t,Qi.TEST_VID.muted?pt(Qi.TEST_VID,"muted","muted"):gt(Qi.TEST_VID,"muted"),t!==Qi.TEST_VID.muted}catch(t){return!1}},Qi.canControlPlaybackRate=function(){if(_&&A&&C<58)return!1;try{var t=Qi.TEST_VID.playbackRate;return Qi.TEST_VID.playbackRate=t/2+.1,t!==Qi.TEST_VID.playbackRate}catch(t){return!1}},Qi.canOverrideAttributes=function(){if(x)return!1;try{var t=function(){};Object.defineProperty(o.createElement("video"),"src",{get:t,set:t}),Object.defineProperty(o.createElement("audio"),"src",{get:t,set:t}),Object.defineProperty(o.createElement("video"),"innerHTML",{get:t,set:t}),Object.defineProperty(o.createElement("audio"),"innerHTML",{get:t,set:t})}catch(t){return!1}return!0},Qi.supportsNativeTextTracks=function(){return D||y&&A},Qi.supportsNativeVideoTracks=function(){return!(!Qi.TEST_VID||!Qi.TEST_VID.videoTracks)},Qi.supportsNativeAudioTracks=function(){return!(!Qi.TEST_VID||!Qi.TEST_VID.audioTracks)},Qi.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],Qi.prototype.featuresVolumeControl=Qi.canControlVolume(),Qi.prototype.featuresMuteControl=Qi.canMuteVolume(),Qi.prototype.featuresPlaybackRate=Qi.canControlPlaybackRate(),Qi.prototype.featuresSourceset=Qi.canOverrideAttributes(),Qi.prototype.movingMediaElementInDOM=!y,Qi.prototype.featuresFullscreenResize=!0,Qi.prototype.featuresProgressEvents=!0,Qi.prototype.featuresTimeupdateEvents=!0,Qi.prototype.featuresNativeTextTracks=Qi.supportsNativeTextTracks(),Qi.prototype.featuresNativeVideoTracks=Qi.supportsNativeVideoTracks(),Qi.prototype.featuresNativeAudioTracks=Qi.supportsNativeAudioTracks();var tn=Qi.TEST_VID&&Qi.TEST_VID.constructor.prototype.canPlayType,en=/^application\/(?:x-|vnd\.apple\.)mpegurl/i,rn=/^video\/mp4/i;Qi.patchCanPlayType=function(){T>=4&&!w&&!A?Qi.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&en.test(t)?"maybe":tn.call(this,t)}:E&&(Qi.TEST_VID.constructor.prototype.canPlayType=function(t){return t&&rn.test(t)?"maybe":tn.call(this,t)})},Qi.unpatchCanPlayType=function(){var t=Qi.TEST_VID.constructor.prototype.canPlayType;return Qi.TEST_VID.constructor.prototype.canPlayType=tn,t},Qi.patchCanPlayType(),Qi.disposeMediaElement=function(t){if(t){for(t.parentNode&&t.parentNode.removeChild(t);t.hasChildNodes();)t.removeChild(t.firstChild);t.removeAttribute("src"),"function"==typeof t.load&&function(){try{t.load()}catch(t){}}()}},Qi.resetMediaElement=function(t){if(t){for(var e=t.querySelectorAll("source"),r=e.length;r--;)t.removeChild(e[r]);t.removeAttribute("src"),"function"==typeof t.load&&function(){try{t.load()}catch(t){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(t){Qi.prototype[t]=function(){return this.el_[t]||this.el_.hasAttribute(t)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(t){Qi.prototype["set"+pe(t)]=function(e){this.el_[t]=e,e?this.el_.setAttribute(t,t):this.el_.removeAttribute(t)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","played","networkState","readyState","videoWidth","videoHeight"].forEach(function(t){Qi.prototype[t]=function(){return this.el_[t]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate"].forEach(function(t){Qi.prototype["set"+pe(t)]=function(e){this.el_[t]=e}}),["pause","load","play"].forEach(function(t){Qi.prototype[t]=function(){return this.el_[t]()}}),dr.withSourceHandlers(Qi),Qi.nativeSourceHandler={},Qi.nativeSourceHandler.canPlayType=function(t){try{return Qi.TEST_VID.canPlayType(t)}catch(t){return""}},Qi.nativeSourceHandler.canHandleSource=function(t,e){if(t.type)return Qi.nativeSourceHandler.canPlayType(t.type);if(t.src){var r=Qe(t.src);return Qi.nativeSourceHandler.canPlayType("video/"+r)}return""},Qi.nativeSourceHandler.handleSource=function(t,e,r){e.setSrc(t.src)},Qi.nativeSourceHandler.dispose=function(){},Qi.registerSourceHandler(Qi.nativeSourceHandler),dr.registerTech("Html5",Qi);var nn=j(["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "],["\n        Using the tech directly can be dangerous. I hope you know what you're doing.\n        See https://github.com/videojs/video.js/issues/2617 for more info.\n      "]),an=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],on={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},sn=["tiny","xsmall","small","medium","large","xlarge","huge"],ln={};sn.forEach(function(t){var e="x"===t.charAt(0)?"x-"+t.substring(1):t;ln[t]="vjs-layout-"+e});var un={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:1/0},cn=function(t){function e(r,i,n){if(N(this,e),r.id=r.id||i.id||"vjs_video_"+Dt(),(i=V(e.getTagSettings(r),i)).initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language)if("function"==typeof r.closest){var a=r.closest("[lang]");a&&a.getAttribute&&(i.language=a.getAttribute("lang"))}else for(var o=r;o&&1===o.nodeType;){if(dt(o).hasOwnProperty("lang")){i.language=o.getAttribute("lang");break}o=o.parentNode}var s=B(this,t.call(this,null,i,n));if(s.log=X(s.id_),s.isPosterFromTech_=!1,s.queuedCallbacks_=[],s.isReady_=!1,s.hasStarted_=!1,s.userActive_=!1,!s.options_||!s.options_.techOrder||!s.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(s.tag=r,s.tagAttributes=r&&dt(r),s.language(s.options_.language),i.languages){var l={};Object.getOwnPropertyNames(i.languages).forEach(function(t){l[t.toLowerCase()]=i.languages[t]}),s.languages_=l}else s.languages_=e.prototype.options_.languages;s.cache_={},s.poster_=i.poster||"",s.controls_=!!i.controls,s.cache_.lastVolume=1,r.controls=!1,r.removeAttribute("controls"),r.hasAttribute("autoplay")?s.options_.autoplay=!0:s.autoplay(s.options_.autoplay),s.scrubbing_=!1,s.el_=s.createEl(),s.cache_.lastPlaybackRate=s.defaultPlaybackRate(),he(s,{eventBusKey:"el_"});var u=ge(s.options_);if(i.plugins){var c=i.plugins;Object.keys(c).forEach(function(t){if("function"!=typeof this[t])throw new Error('plugin "'+t+'" does not exist');this[t](c[t])},s)}s.options_.playerOptions=u,s.middleware_=[],s.initChildren(),s.isAudio("audio"===r.nodeName.toLowerCase()),s.controls()?s.addClass("vjs-controls-enabled"):s.addClass("vjs-controls-disabled"),s.el_.setAttribute("role","region"),s.isAudio()?s.el_.setAttribute("aria-label",s.localize("Audio Player")):s.el_.setAttribute("aria-label",s.localize("Video Player")),s.isAudio()&&s.addClass("vjs-audio"),s.flexNotSupported_()&&s.addClass("vjs-no-flex"),y||s.addClass("vjs-workinghover"),e.players[s.id_]=s;var d=h.split(".")[0];return s.addClass("vjs-v"+d),s.userActive(!0),s.reportUserActivity(),s.one("play",s.listenForUserActivity_),s.on("fullscreenchange",s.handleFullscreenChange_),s.on("stageclick",s.handleStageClick_),s.breakpoints(s.options_.breakpoints),s.responsive(s.options_.responsive),s.changingSrc_=!1,s.playWaitingForReady_=!1,s.playOnLoadstart_=null,s}return F(e,t),e.prototype.dispose=function(){this.trigger("dispose"),this.off("dispose"),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),e.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),pr[this.id()]=null,t.prototype.dispose.call(this)},e.prototype.createEl=function(){var e=this.tag,r=void 0,i=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player"),n="video-js"===this.tag.tagName.toLowerCase();i?r=this.el_=e.parentNode:n||(r=this.el_=t.prototype.createEl.call(this,"div"));var s=dt(e);if(n){for(r=this.el_=e,e=this.tag=o.createElement("video");r.children.length;)e.appendChild(r.firstChild);st(r,"video-js")||lt(r,"video-js"),r.appendChild(e),i=this.playerElIngest_=r,["autoplay","controls","crossOrigin","defaultMuted","defaultPlaybackRate","loop","muted","playbackRate","src","volume"].forEach(function(t){void 0!==r[t]&&(e[t]=r[t])})}if(e.setAttribute("tabindex","-1"),s.tabindex="-1",R&&(e.setAttribute("role","application"),s.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in s&&delete s.width,"height"in s&&delete s.height,Object.getOwnPropertyNames(s).forEach(function(t){"class"===t?(r.className+=" "+s[t],n&&(e.className+=" "+s[t])):(r.setAttribute(t,s[t]),n&&e.setAttribute(t,s[t]))}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=r.player=this,this.addClass("vjs-paused"),!0!==a.VIDEOJS_NO_DYNAMIC_STYLE){this.styleEl_=Jt("vjs-styles-dimensions");var l=Ct(".vjs-styles-defaults"),u=Ct("head");u.insertBefore(this.styleEl_,l?l.nextSibling:u.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio);for(var c=e.getElementsByTagName("a"),h=0;h<c.length;h++){var d=c.item(h);lt(d,"vjs-hidden"),d.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!i&&e.parentNode.insertBefore(r,e),ot(e,r),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_=r,r},e.prototype.width=function(t){return this.dimension("width",t)},e.prototype.height=function(t){return this.dimension("height",t)},e.prototype.dimension=function(t,e){var r=t+"_";if(void 0===e)return this[r]||0;if(""===e)return this[r]=void 0,void this.updateStyleEl_();var i=parseFloat(e);isNaN(i)?Y.error('Improper value "'+e+'" supplied for for '+t):(this[r]=i,this.updateStyleEl_())},e.prototype.fluid=function(t){if(void 0===t)return!!this.fluid_;this.fluid_=!!t,t?(this.addClass("vjs-fluid"),this.fill(!1)):this.removeClass("vjs-fluid"),this.updateStyleEl_()},e.prototype.fill=function(t){if(void 0===t)return!!this.fill_;this.fill_=!!t,t?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},e.prototype.aspectRatio=function(t){if(void 0===t)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(t))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=t,this.fluid(!0),this.updateStyleEl_()},e.prototype.updateStyleEl_=function(){if(!0!==a.VIDEOJS_NO_DYNAMIC_STYLE){var t=void 0,e=void 0,r=void 0,i=(void 0!==this.aspectRatio_&&"auto"!==this.aspectRatio_?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9").split(":"),n=i[1]/i[0];t=void 0!==this.width_?this.width_:void 0!==this.height_?this.height_/n:this.videoWidth()||300,e=void 0!==this.height_?this.height_:t*n,r=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions",this.addClass(r),Qt(this.styleEl_,"\n      ."+r+" {\n        width: "+t+"px;\n        height: "+e+"px;\n      }\n\n      ."+r+".vjs-fluid {\n        padding-top: "+100*n+"%;\n      }\n    ")}else{var o="number"==typeof this.width_?this.width_:this.options_.width,s="number"==typeof this.height_?this.height_:this.options_.height,l=this.tech_&&this.tech_.el();l&&(o>=0&&(l.width=o),s>=0&&(l.height=s))}},e.prototype.loadTech_=function(t,e){var r=this;this.tech_&&this.unloadTech_();var i=pe(t),n=t.charAt(0).toLowerCase()+t.slice(1);"Html5"!==i&&this.tag&&(dr.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=i,this.isReady_=!1;var a={source:e,autoplay:"string"!=typeof this.autoplay()&&this.autoplay(),nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+n+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset};hr.names.forEach(function(t){var e=hr[t];a[e.getterName]=r[e.privateName]}),V(a,this.options_[i]),V(a,this.options_[n]),V(a,this.options_[t.toLowerCase()]),this.tag&&(a.tag=this.tag),e&&e.src===this.cache_.src&&this.cache_.currentTime>0&&(a.startTime=this.cache_.currentTime);var o=dr.getTech(t);if(!o)throw new Error("No Tech named '"+i+"' exists! '"+i+"' should be registered using videojs.registerTech()'");this.tech_=new o(a),this.tech_.ready(Zt(this,this.handleTechReady_),!0),Ie(this.textTracksJson_||[],this.tech_),an.forEach(function(t){r.on(r.tech_,t,r["handleTech"+pe(t)+"_"])}),Object.keys(on).forEach(function(t){r.on(r.tech_,t,function(e){0===r.tech_.playbackRate()&&r.tech_.seeking()?r.queuedCallbacks_.push({callback:r["handleTech"+on[t]+"_"].bind(r),event:e}):r["handleTech"+on[t]+"_"](e)})}),this.on(this.tech_,"loadstart",this.handleTechLoadStart_),this.on(this.tech_,"sourceset",this.handleTechSourceset_),this.on(this.tech_,"waiting",this.handleTechWaiting_),this.on(this.tech_,"ended",this.handleTechEnded_),this.on(this.tech_,"seeking",this.handleTechSeeking_),this.on(this.tech_,"play",this.handleTechPlay_),this.on(this.tech_,"firstplay",this.handleTechFirstPlay_),this.on(this.tech_,"pause",this.handleTechPause_),this.on(this.tech_,"durationchange",this.handleTechDurationChange_),this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_),this.on(this.tech_,"error",this.handleTechError_),this.on(this.tech_,"loadedmetadata",this.updateStyleEl_),this.on(this.tech_,"posterchange",this.handleTechPosterChange_),this.on(this.tech_,"textdata",this.handleTechTextData_),this.on(this.tech_,"ratechange",this.handleTechRateChange_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode===this.el()||"Html5"===i&&this.tag||ot(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},e.prototype.unloadTech_=function(){var t=this;hr.names.forEach(function(e){var r=hr[e];t[r.privateName]=t[r.getterName]()}),this.textTracksJson_=Oe(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},e.prototype.tech=function(t){return void 0===t&&Y.warn(s(nn)),this.tech_},e.prototype.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"mousedown",this.handleTechClick_),this.on(this.tech_,"touchstart",this.handleTechTouchStart_),this.on(this.tech_,"touchmove",this.handleTechTouchMove_),this.on(this.tech_,"touchend",this.handleTechTouchEnd_),this.on(this.tech_,"tap",this.handleTechTap_)},e.prototype.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_),this.off(this.tech_,"touchstart",this.handleTechTouchStart_),this.off(this.tech_,"touchmove",this.handleTechTouchMove_),this.off(this.tech_,"touchend",this.handleTechTouchEnd_),this.off(this.tech_,"mousedown",this.handleTechClick_)},e.prototype.handleTechReady_=function(){if(this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_(),(this.src()||this.currentSrc())&&this.tag&&this.options_.autoplay&&this.paused())try{delete this.tag.poster}catch(t){Y("deleting tag.poster throws in some browsers",t)}},e.prototype.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay())},e.prototype.manualAutoplay_=function(t){var e=this;if(this.tech_&&"string"==typeof t){var r=function(){var t=e.muted();e.muted(!0);var r=e.play();if(r&&r.then&&r.catch)return r.catch(function(r){e.muted(t)})},i=void 0;if("any"===t?(i=this.play())&&i.then&&i.catch&&i.catch(function(){return r()}):i="muted"===t?r():this.play(),i&&i.then&&i.catch)return i.then(function(){e.trigger({type:"autoplay-success",autoplay:t})}).catch(function(r){e.trigger({type:"autoplay-failure",autoplay:t})})}},e.prototype.updateSourceCaches_=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=t,r="";"string"!=typeof e&&(e=t.src,r=t.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],e&&!r&&(r=function(t,e){if(!e)return"";if(t.cache_.source.src===e&&t.cache_.source.type)return t.cache_.source.type;var r=t.cache_.sources.filter(function(t){return t.src===e});if(r.length)return r[0].type;for(var i=t.$$("source"),n=0;n<i.length;n++){var a=i[n];if(a.type&&a.src&&a.src===e)return a.type}return Sr(e)}(this,e)),this.cache_.source=ge({},t,{src:e,type:r});for(var i=this.cache_.sources.filter(function(t){return t.src&&t.src===e}),n=[],a=this.$$("source"),o=[],s=0;s<a.length;s++){var l=dt(a[s]);n.push(l),l.src&&l.src===e&&o.push(l.src)}o.length&&!i.length?this.cache_.sources=n:i.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=e},e.prototype.handleTechSourceset_=function(t){var e=this;if(!this.changingSrc_){var r=function(t){return e.updateSourceCaches_(t)},i=this.currentSource().src,n=t.src;if(i&&!/^blob:/.test(i)&&/^blob:/.test(n)&&(!this.lastSource_||this.lastSource_.tech!==n&&this.lastSource_.player!==i)&&(r=function(){}),r(n),!t.src){this.tech_.one(["sourceset","loadstart"],function t(r){if("sourceset"!==r.type){var i=e.techGet("currentSrc");e.lastSource_.tech=i,e.updateSourceCaches_(i)}e.tech_.off(["sourceset","loadstart"],t)})}}this.lastSource_={player:this.currentSource().src,tech:t.src},this.trigger({src:t.src,type:"sourceset"})},e.prototype.hasStarted=function(t){if(void 0===t)return this.hasStarted_;t!==this.hasStarted_&&(this.hasStarted_=t,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},e.prototype.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},e.prototype.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&0===this.cache_.lastPlaybackRate&&(this.queuedCallbacks_.forEach(function(t){return t.callback(t.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},e.prototype.handleTechWaiting_=function(){var t=this;this.addClass("vjs-waiting"),this.trigger("waiting"),this.one("timeupdate",function(){return t.removeClass("vjs-waiting")})},e.prototype.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},e.prototype.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},e.prototype.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},e.prototype.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},e.prototype.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.trigger("seeked")},e.prototype.handleTechFirstPlay_=function(){this.options_.starttime&&(Y.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},e.prototype.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},e.prototype.handleTechEnded_=function(){this.addClass("vjs-ended"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},e.prototype.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},e.prototype.handleTechClick_=function(t){At(t)&&this.controls_&&(this.paused()?Le(this.play()):this.pause())},e.prototype.handleTechTap_=function(){this.userActive(!this.userActive())},e.prototype.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},e.prototype.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},e.prototype.handleTechTouchEnd_=function(t){t.preventDefault()},e.prototype.handleFullscreenChange_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},e.prototype.handleStageClick_=function(){this.reportUserActivity()},e.prototype.handleTechFullscreenChange_=function(t,e){e&&this.isFullscreen(e.isFullscreen),this.trigger("fullscreenchange")},e.prototype.handleTechError_=function(){var t=this.tech_.error();this.error(t)},e.prototype.handleTechTextData_=function(){var t=null;arguments.length>1&&(t=arguments[1]),this.trigger("textdata",t)},e.prototype.getCache=function(){return this.cache_},e.prototype.techCall_=function(t,e){this.ready(function(){if(t in br)return function(t,e,r,i){return e[r](t.reduce(Tr(r),i))}(this.middleware_,this.tech_,t,e);if(t in _r)return mr(this.middleware_,this.tech_,t,e);try{this.tech_&&this.tech_[t](e)}catch(t){throw Y(t),t}},!0)},e.prototype.techGet_=function(t){if(this.tech_&&this.tech_.isReady_){if(t in yr)return function(t,e,r){return t.reduceRight(Tr(r),e[r]())}(this.middleware_,this.tech_,t);if(t in _r)return mr(this.middleware_,this.tech_,t);try{return this.tech_[t]()}catch(e){if(void 0===this.tech_[t])throw Y("Video.js: "+t+" method not defined for "+this.techName_+" playback technology.",e),e;if("TypeError"===e.name)throw Y("Video.js: "+t+" unavailable on "+this.techName_+" playback technology element.",e),this.tech_.isReady_=!1,e;throw Y(e),e}}},e.prototype.play=function(){var t=this,e=this.options_.Promise||a.Promise;return e?new e(function(e){t.play_(e)}):this.play_()},e.prototype.play_=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;if(this.playOnLoadstart_&&this.off("loadstart",this.playOnLoadstart_),this.isReady_){if(!this.changingSrc_&&(this.src()||this.currentSrc()))return void e(this.techGet_("play"));this.playOnLoadstart_=function(){t.playOnLoadstart_=null,e(t.play())},this.one("loadstart",this.playOnLoadstart_)}else{if(this.playWaitingForReady_)return;this.playWaitingForReady_=!0,this.ready(function(){t.playWaitingForReady_=!1,e(t.play())})}},e.prototype.pause=function(){this.techCall_("pause")},e.prototype.paused=function(){return!1!==this.techGet_("paused")},e.prototype.played=function(){return this.techGet_("played")||be(0,0)},e.prototype.scrubbing=function(t){if(void 0===t)return this.scrubbing_;this.scrubbing_=!!t,t?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},e.prototype.currentTime=function(t){return void 0!==t?(t<0&&(t=0),void this.techCall_("setCurrentTime",t)):(this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime)},e.prototype.duration=function(t){if(void 0===t)return void 0!==this.cache_.duration?this.cache_.duration:NaN;(t=parseFloat(t))<0&&(t=1/0),t!==this.cache_.duration&&(this.cache_.duration=t,t===1/0?this.addClass("vjs-live"):this.removeClass("vjs-live"),this.trigger("durationchange"))},e.prototype.remainingTime=function(){return this.duration()-this.currentTime()},e.prototype.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},e.prototype.buffered=function(){var t=this.techGet_("buffered");return t&&t.length||(t=be(0,0)),t},e.prototype.bufferedPercent=function(){return _e(this.buffered(),this.duration())},e.prototype.bufferedEnd=function(){var t=this.buffered(),e=this.duration(),r=t.end(t.length-1);return r>e&&(r=e),r},e.prototype.volume=function(t){var e=void 0;return void 0!==t?(e=Math.max(0,Math.min(1,parseFloat(t))),this.cache_.volume=e,this.techCall_("setVolume",e),void(e>0&&this.lastVolume_(e))):(e=parseFloat(this.techGet_("volume")),isNaN(e)?1:e)},e.prototype.muted=function(t){if(void 0===t)return this.techGet_("muted")||!1;this.techCall_("setMuted",t)},e.prototype.defaultMuted=function(t){return void 0!==t?this.techCall_("setDefaultMuted",t):this.techGet_("defaultMuted")||!1},e.prototype.lastVolume_=function(t){if(void 0===t||0===t)return this.cache_.lastVolume;this.cache_.lastVolume=t},e.prototype.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},e.prototype.isFullscreen=function(t){if(void 0===t)return!!this.isFullscreen_;this.isFullscreen_=!!t},e.prototype.requestFullscreen=function(){var t=Te;this.isFullscreen(!0),t.requestFullscreen?(Ht(o,t.fullscreenchange,Zt(this,function e(r){this.isFullscreen(o[t.fullscreenElement]),!1===this.isFullscreen()&&Vt(o,t.fullscreenchange,e),this.trigger("fullscreenchange")})),this.el_[t.requestFullscreen]()):this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):(this.enterFullWindow(),this.trigger("fullscreenchange"))},e.prototype.exitFullscreen=function(){var t=Te;this.isFullscreen(!1),t.requestFullscreen?o[t.exitFullscreen]():this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):(this.exitFullWindow(),this.trigger("fullscreenchange"))},e.prototype.enterFullWindow=function(){this.isFullWindow=!0,this.docOrigOverflow=o.documentElement.style.overflow,Ht(o,"keydown",Zt(this,this.fullWindowOnEscKey)),o.documentElement.style.overflow="hidden",lt(o.body,"vjs-full-window"),this.trigger("enterFullWindow")},e.prototype.fullWindowOnEscKey=function(t){27===t.keyCode&&(!0===this.isFullscreen()?this.exitFullscreen():this.exitFullWindow())},e.prototype.exitFullWindow=function(){this.isFullWindow=!1,Vt(o,"keydown",this.fullWindowOnEscKey),o.documentElement.style.overflow=this.docOrigOverflow,ut(o.body,"vjs-full-window"),this.trigger("exitFullWindow")},e.prototype.canPlayType=function(t){for(var e=void 0,r=0,i=this.options_.techOrder;r<i.length;r++){var n=i[r],a=dr.getTech(n);if(a||(a=ve.getComponent(n)),a){if(a.isSupported()&&(e=a.canPlayType(t)))return e}else Y.error('The "'+n+'" tech is undefined. Skipped browser support check for that tech.')}return""},e.prototype.selectSource=function(t){var e,r=this,i=this.options_.techOrder.map(function(t){return[t,dr.getTech(t)]}).filter(function(t){var e=t[0],r=t[1];return r?r.isSupported():(Y.error('The "'+e+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),n=function(t,e,r){var i=void 0;return t.some(function(t){return e.some(function(e){if(i=r(t,e))return!0})}),i},a=function(t,e){var i=t[0];if(t[1].canPlaySource(e,r.options_[i.toLowerCase()]))return{source:e,tech:i}};return(this.options_.sourceOrder?n(t,i,(e=a,function(t,r){return e(r,t)})):n(i,t,a))||!1},e.prototype.src=function(t){var e=this;if(void 0===t)return this.cache_.src||"";var r=function t(e){if(Array.isArray(e)){var r=[];e.forEach(function(e){e=t(e),Array.isArray(e)?r=r.concat(e):K(e)&&r.push(e)}),e=r}else e="string"==typeof e&&e.trim()?[wr({src:e})]:K(e)&&"string"==typeof e.src&&e.src&&e.src.trim()?[wr(e)]:[];return e}(t);r.length?(this.changingSrc_=!0,this.cache_.sources=r,this.updateSourceCaches_(r[0]),vr(this,r[0],function(t,i){var n,a;if(e.middleware_=i,e.cache_.sources=r,e.updateSourceCaches_(t),e.src_(t))return r.length>1?e.src(r.slice(1)):(e.changingSrc_=!1,e.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),void e.triggerReady());n=i,a=e.tech_,n.forEach(function(t){return t.setTech&&t.setTech(a)})})):this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0)},e.prototype.src_=function(t){var e,r,i=this,n=this.selectSource([t]);return!n||(e=n.tech,r=this.techName_,pe(e)!==pe(r)?(this.changingSrc_=!0,this.loadTech_(n.tech,n.source),this.tech_.ready(function(){i.changingSrc_=!1}),!1):(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",t):this.techCall_("src",t.src),this.changingSrc_=!1},!0),!1))},e.prototype.load=function(){this.techCall_("load")},e.prototype.reset=function(){this.tech_&&this.tech_.clearTracks("text"),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset")},e.prototype.currentSources=function(){var t=this.currentSource(),e=[];return 0!==Object.keys(t).length&&e.push(t),this.cache_.sources||e},e.prototype.currentSource=function(){return this.cache_.source||{}},e.prototype.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},e.prototype.currentType=function(){return this.currentSource()&&this.currentSource().type||""},e.prototype.preload=function(t){return void 0!==t?(this.techCall_("setPreload",t),void(this.options_.preload=t)):this.techGet_("preload")},e.prototype.autoplay=function(t){if(void 0===t)return this.options_.autoplay||!1;var e=void 0;"string"==typeof t&&/(any|play|muted)/.test(t)?(this.options_.autoplay=t,this.manualAutoplay_(t),e=!1):this.options_.autoplay=!!t,e=e||this.options_.autoplay,this.tech_&&this.techCall_("setAutoplay",e)},e.prototype.playsinline=function(t){return void 0!==t?(this.techCall_("setPlaysinline",t),this.options_.playsinline=t,this):this.techGet_("playsinline")},e.prototype.loop=function(t){return void 0!==t?(this.techCall_("setLoop",t),void(this.options_.loop=t)):this.techGet_("loop")},e.prototype.poster=function(t){if(void 0===t)return this.poster_;t||(t=""),t!==this.poster_&&(this.poster_=t,this.techCall_("setPoster",t),this.isPosterFromTech_=!1,this.trigger("posterchange"))},e.prototype.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var t=this.tech_.poster()||"";t!==this.poster_&&(this.poster_=t,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},e.prototype.controls=function(t){if(void 0===t)return!!this.controls_;t=!!t,this.controls_!==t&&(this.controls_=t,this.usingNativeControls()&&this.techCall_("setControls",t),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},e.prototype.usingNativeControls=function(t){if(void 0===t)return!!this.usingNativeControls_;t=!!t,this.usingNativeControls_!==t&&(this.usingNativeControls_=t,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},e.prototype.error=function(t){return void 0===t?this.error_||null:null===t?(this.error_=t,this.removeClass("vjs-error"),void(this.errorDisplay&&this.errorDisplay.close())):(this.error_=new Ce(t),this.addClass("vjs-error"),Y.error("(CODE:"+this.error_.code+" "+Ce.errorTypes[this.error_.code]+")",this.error_.message,this.error_),void this.trigger("error"))},e.prototype.reportUserActivity=function(t){this.userActivity_=!0},e.prototype.userActive=function(t){if(void 0===t)return this.userActive_;if((t=!!t)!==this.userActive_){if(this.userActive_=t,this.userActive_)return this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),void this.trigger("useractive");this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},e.prototype.listenForUserActivity_=function(){var t=void 0,e=void 0,r=void 0,i=Zt(this,this.reportUserActivity);this.on("mousedown",function(){i(),this.clearInterval(t),t=this.setInterval(i,250)}),this.on("mousemove",function(t){t.screenX===e&&t.screenY===r||(e=t.screenX,r=t.screenY,i())}),this.on("mouseup",function(e){i(),this.clearInterval(t)}),this.on("keydown",i),this.on("keyup",i);var n=void 0;this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(n);var t=this.options_.inactivityTimeout;t<=0||(n=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},t))}},250)},e.prototype.playbackRate=function(t){if(void 0===t)return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1;this.techCall_("setPlaybackRate",t)},e.prototype.defaultPlaybackRate=function(t){return void 0!==t?this.techCall_("setDefaultPlaybackRate",t):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},e.prototype.isAudio=function(t){if(void 0===t)return!!this.isAudio_;this.isAudio_=!!t},e.prototype.addTextTrack=function(t,e,r){if(this.tech_)return this.tech_.addTextTrack(t,e,r)},e.prototype.addRemoteTextTrack=function(t,e){if(this.tech_)return this.tech_.addRemoteTextTrack(t,e)},e.prototype.removeRemoteTextTrack=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).track,e=void 0===t?arguments[0]:t;if(this.tech_)return this.tech_.removeRemoteTextTrack(e)},e.prototype.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},e.prototype.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},e.prototype.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},e.prototype.language=function(t){if(void 0===t)return this.language_;this.language_=String(t).toLowerCase()},e.prototype.languages=function(){return ge(e.prototype.options_.languages,this.languages_)},e.prototype.toJSON=function(){var t=ge(this.options_),e=t.tracks;t.tracks=[];for(var r=0;r<e.length;r++){var i=e[r];(i=ge(i)).player=void 0,t.tracks[r]=i}return t},e.prototype.createModal=function(t,e){var r=this;(e=e||{}).content=t||"";var i=new Me(this,e);return this.addChild(i),i.on("dispose",function(){r.removeChild(i)}),i.open(),i},e.prototype.updateCurrentBreakpoint_=function(){if(this.responsive())for(var t=this.currentBreakpoint(),e=this.currentWidth(),r=0;r<sn.length;r++){var i=sn[r];if(e<=this.breakpoints_[i]){if(t===i)return;t&&this.removeClass(ln[t]),this.addClass(ln[i]),this.breakpoint_=i;break}}},e.prototype.removeCurrentBreakpoint_=function(){var t=this.currentBreakpointClass();this.breakpoint_="",t&&this.removeClass(t)},e.prototype.breakpoints=function(t){return void 0===t?V(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=V({},un,t),this.updateCurrentBreakpoint_(),V(this.breakpoints_))},e.prototype.responsive=function(t){return void 0===t?this.responsive_:(t=Boolean(t))!==this.responsive_?(this.responsive_=t,t?(this.on("playerresize",this.updateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),t):void 0},e.prototype.currentBreakpoint=function(){return this.breakpoint_},e.prototype.currentBreakpointClass=function(){return ln[this.breakpoint_]||""},e.getTagSettings=function(t){var e={sources:[],tracks:[]},r=dt(t),i=r["data-setup"];if(st(t,"vjs-fill")&&(r.fill=!0),st(t,"vjs-fluid")&&(r.fluid=!0),null!==i){var n=l(i||"{}"),a=n[0],o=n[1];a&&Y.error(a),V(r,o)}if(V(e,r),t.hasChildNodes())for(var s=t.childNodes,u=0,c=s.length;u<c;u++){var h=s[u],d=h.nodeName.toLowerCase();"source"===d?e.sources.push(dt(h)):"track"===d&&e.tracks.push(dt(h))}return e},e.prototype.flexNotSupported_=function(){var t=o.createElement("i");return!("flexBasis"in t.style||"webkitFlexBasis"in t.style||"mozFlexBasis"in t.style||"msFlexBasis"in t.style||"msFlexOrder"in t.style)},e}(ve);hr.names.forEach(function(t){var e=hr[t];cn.prototype[e.getterName]=function(){return this.tech_?this.tech_[e.getterName]():(this[e.privateName]=this[e.privateName]||new e.ListClass,this[e.privateName])}}),cn.players={};var hn=a.navigator;cn.prototype.options_={techOrder:dr.defaultTechOrder_,html5:{},flash:{},inactivityTimeout:2e3,playbackRates:[],children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","controlBar","errorDisplay","textTrackSettings"],language:hn&&(hn.languages&&hn.languages[0]||hn.userLanguage||hn.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",breakpoints:{},responsive:!1},x||cn.prototype.options_.children.push("resizeManager"),["ended","seeking","seekable","networkState","readyState"].forEach(function(t){cn.prototype[t]=function(){return this.techGet_(t)}}),an.forEach(function(t){cn.prototype["handleTech"+pe(t)+"_"]=function(){return this.trigger(t)}}),ve.registerComponent("Player",cn);var dn={},fn=function(t){return dn.hasOwnProperty(t)},pn=function(t){return fn(t)?dn[t]:void 0},gn=function(t,e){t.activePlugins_=t.activePlugins_||{},t.activePlugins_[e]=!0},vn=function(t,e,r){var i=(r?"before":"")+"pluginsetup";t.trigger(i,e),t.trigger(i+":"+e.name,e)},mn=function(t,e){return e.prototype.name=t,function(){vn(this,{name:t,plugin:e,instance:null},!0);for(var r=arguments.length,i=Array(r),n=0;n<r;n++)i[n]=arguments[n];var a=new(Function.prototype.bind.apply(e,[null].concat([this].concat(i))));return this[t]=function(){return a},vn(this,a.getEventHash()),a}},yn=function(){function t(e){if(N(this,t),this.constructor===t)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=e,he(this),delete this.trigger,fe(this,this.constructor.defaultState),gn(e,this.name),this.dispose=Zt(this,this.dispose),e.on("dispose",this.dispose)}return t.prototype.version=function(){return this.constructor.VERSION},t.prototype.getEventHash=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name=this.name,t.plugin=this.constructor,t.instance=this,t},t.prototype.trigger=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Kt(this.eventBusEl_,t,this.getEventHash(e))},t.prototype.handleStateChanged=function(t){},t.prototype.dispose=function(){var t=this.name,e=this.player;this.trigger("dispose"),this.off(),e.off("dispose",this.dispose),e.activePlugins_[t]=!1,this.player=this.state=null,e[t]=mn(t,dn[t])},t.isBasic=function(e){var r="string"==typeof e?pn(e):e;return"function"==typeof r&&!t.prototype.isPrototypeOf(r.prototype)},t.registerPlugin=function(e,r){if("string"!=typeof e)throw new Error('Illegal plugin name, "'+e+'", must be a string, was '+(void 0===e?"undefined":M(e))+".");if(fn(e))Y.warn('A plugin named "'+e+'" already exists. You may want to avoid re-registering plugins!');else if(cn.prototype.hasOwnProperty(e))throw new Error('Illegal plugin name, "'+e+'", cannot share a name with an existing player method!');if("function"!=typeof r)throw new Error('Illegal plugin for "'+e+'", must be a function, was '+(void 0===r?"undefined":M(r))+".");return dn[e]=r,"plugin"!==e&&(t.isBasic(r)?cn.prototype[e]=function(t,e){var r=function(){vn(this,{name:t,plugin:e,instance:null},!0);var r=e.apply(this,arguments);return gn(this,t),vn(this,{name:t,plugin:e,instance:r}),r};return Object.keys(e).forEach(function(t){r[t]=e[t]}),r}(e,r):cn.prototype[e]=mn(e,r)),r},t.deregisterPlugin=function(t){if("plugin"===t)throw new Error("Cannot de-register base plugin.");fn(t)&&(delete dn[t],delete cn.prototype[t])},t.getPlugins=function(){var t=void 0;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object.keys(dn)).forEach(function(e){var r=pn(e);r&&((t=t||{})[e]=r)}),t},t.getPluginVersion=function(t){var e=pn(t);return e&&e.VERSION||""},t}();yn.getPlugin=pn,yn.BASE_PLUGIN_NAME="plugin",yn.registerPlugin("plugin",yn),cn.prototype.usingPlugin=function(t){return!!this.activePlugins_&&!0===this.activePlugins_[t]},cn.prototype.hasPlugin=function(t){return!!fn(t)};"undefined"==typeof HTMLVideoElement&&tt()&&(o.createElement("video"),o.createElement("audio"),o.createElement("track"),o.createElement("video-js"));var bn=function(t){return 0===t.indexOf("#")?t.slice(1):t};function _n(t,e,r){var i=_n.getPlayer(t);if(i)return e&&Y.warn('Player "'+t+'" is already initialised. Options will not be applied.'),r&&i.ready(r),i;var n="string"==typeof t?Ct("#"+bn(t)):t;if(!et(n))throw new TypeError("The element or ID supplied is not valid. (videojs)");o.body.contains(n)||Y.warn("The element supplied is not included in the DOM"),e=e||{},_n.hooks("beforesetup").forEach(function(t){var r=t(n,ge(e));K(r)&&!Array.isArray(r)?e=ge(e,r):Y.error("please return an object in beforesetup hooks")});var a=ve.getComponent("Player");return i=new a(n,e,r),_n.hooks("setup").forEach(function(t){return t(i)}),i}if(_n.hooks_={},_n.hooks=function(t,e){return _n.hooks_[t]=_n.hooks_[t]||[],e&&(_n.hooks_[t]=_n.hooks_[t].concat(e)),_n.hooks_[t]},_n.hook=function(t,e){_n.hooks(t,e)},_n.hookOnce=function(t,e){_n.hooks(t,[].concat(e).map(function(e){return function r(){return _n.removeHook(t,r),e.apply(void 0,arguments)}}))},_n.removeHook=function(t,e){var r=_n.hooks(t).indexOf(e);return!(r<=-1)&&(_n.hooks_[t]=_n.hooks_[t].slice(),_n.hooks_[t].splice(r,1),!0)},!0!==a.VIDEOJS_NO_DYNAMIC_STYLE&&tt()){var Tn=Ct(".vjs-styles-defaults");if(!Tn){Tn=Jt("vjs-styles-defaults");var En=Ct("head");En&&En.insertBefore(Tn,En.firstChild),Qt(Tn,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")}}$t(1,_n),_n.VERSION=h,_n.options=cn.prototype.options_,_n.getPlayers=function(){return cn.players},_n.getPlayer=function(t){var e=cn.players,r=void 0;if("string"==typeof t){var i=bn(t),n=e[i];if(n)return n;r=Ct("#"+i)}else r=t;if(et(r)){var a=r,o=a.player,s=a.playerId;if(o||e[s])return o||e[s]}},_n.getAllPlayers=function(){return Object.keys(cn.players).map(function(t){return cn.players[t]}).filter(Boolean)},_n.players=cn.players,_n.getComponent=ve.getComponent,_n.registerComponent=function(t,e){dr.isTech(e)&&Y.warn("The "+t+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),ve.registerComponent.call(ve,t,e)},_n.getTech=dr.getTech,_n.registerTech=dr.registerTech,_n.use=function(t,e){fr[t]=fr[t]||[],fr[t].push(e)},!x&&Object.defineProperty?(Object.defineProperty(_n,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(_n.middleware,"TERMINATOR",{value:gr,writeable:!1,enumerable:!0})):_n.middleware={TERMINATOR:gr},_n.browser=P,_n.TOUCH_ENABLED=O,_n.extend=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){t.apply(this,arguments)},i={};for(var n in"object"===(void 0===e?"undefined":M(e))?(e.constructor!==Object.prototype.constructor&&(r=e.constructor),i=e):"function"==typeof e&&(r=e),function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":M(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.super_=e)}(r,t),i)i.hasOwnProperty(n)&&(r.prototype[n]=i[n]);return r},_n.mergeOptions=ge,_n.bind=Zt,_n.registerPlugin=yn.registerPlugin,_n.deregisterPlugin=yn.deregisterPlugin,_n.plugin=function(t,e){return Y.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),yn.registerPlugin(t,e)},_n.getPlugins=yn.getPlugins,_n.getPlugin=yn.getPlugin,_n.getPluginVersion=yn.getPluginVersion,_n.addLanguage=function(t,e){var r;return t=(""+t).toLowerCase(),_n.options.languages=ge(_n.options.languages,((r={})[t]=e,r)),_n.options.languages[t]},_n.log=Y,_n.createLogger=X,_n.createTimeRange=_n.createTimeRanges=be,_n.formatTime=jr,_n.setFormatTime=function(t){Br=t},_n.resetFormatTime=function(){Br=Fr},_n.parseUrl=$e,_n.isCrossOrigin=Ze,_n.EventTarget=re,_n.on=Ht,_n.one=Wt,_n.off=Vt,_n.trigger=Kt,_n.xhr=u,_n.TextTrack=ir,_n.AudioTrack=nr,_n.VideoTrack=ar,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){_n[t]=function(){return Y.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),Rt[t].apply(null,arguments)}}),_n.computedStyle=$,_n.dom=Rt,_n.url=tr,t.exports=_n},sN1u:function(t,e){function r(t){return t.replace(/\n\r?\s*/g,"")}t.exports=function(t){for(var e="",i=0;i<arguments.length;i++)e+=r(t[i])+(arguments[i+1]||"");return e}},sUZj:function(t,e,r){var i=r("awF4"),n=t.exports={WebVTT:r("yacX"),VTTCue:r("VSTS"),VTTRegion:r("Bwfg")};i.vttjs=n,i.WebVTT=n.WebVTT;var a=n.VTTCue,o=n.VTTRegion,s=i.VTTCue,l=i.VTTRegion;n.shim=function(){i.VTTCue=a,i.VTTRegion=o},n.restore=function(){i.VTTCue=s,i.VTTRegion=l},i.VTTCue||n.shim()},yacX:function(t,e){var r=Object.create||function(){function t(){}return function(e){if(1!==arguments.length)throw new Error("Object.create shim only accepts one parameter.");return t.prototype=e,new t}}();function i(t,e){this.name="ParsingError",this.code=t.code,this.message=e||t.message}function n(t){function e(t,e,r,i){return 3600*(0|t)+60*(0|e)+(0|r)+(0|i)/1e3}var r=t.match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/);return r?r[3]?e(r[1],r[2],r[3].replace(":",""),r[4]):r[1]>59?e(r[1],r[2],0,r[4]):e(0,r[1],r[2],r[4]):null}function a(){this.values=r(null)}function o(t,e,r,i){var n=i?t.split(i):[t];for(var a in n)if("string"==typeof n[a]){var o=n[a].split(r);if(2===o.length)e(o[0],o[1])}}function s(t,e,r){var s=t;function l(){var e=n(t);if(null===e)throw new i(i.Errors.BadTimeStamp,"Malformed timestamp: "+s);return t=t.replace(/^[^\sa-zA-Z-]+/,""),e}function u(){t=t.replace(/^\s+/,"")}if(u(),e.startTime=l(),u(),"--\x3e"!==t.substr(0,3))throw new i(i.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);t=t.substr(3),u(),e.endTime=l(),u(),function(t,e){var i=new a;o(t,function(t,e){switch(t){case"region":for(var n=r.length-1;n>=0;n--)if(r[n].id===e){i.set(t,r[n].region);break}break;case"vertical":i.alt(t,e,["rl","lr"]);break;case"line":var a=e.split(","),o=a[0];i.integer(t,o),i.percent(t,o)&&i.set("snapToLines",!1),i.alt(t,o,["auto"]),2===a.length&&i.alt("lineAlign",a[1],["start","middle","end"]);break;case"position":a=e.split(","),i.percent(t,a[0]),2===a.length&&i.alt("positionAlign",a[1],["start","middle","end"]);break;case"size":i.percent(t,e);break;case"align":i.alt(t,e,["start","middle","end","left","right"])}},/:/,/\s/),e.region=i.get("region",null),e.vertical=i.get("vertical",""),e.line=i.get("line","auto"),e.lineAlign=i.get("lineAlign","start"),e.snapToLines=i.get("snapToLines",!0),e.size=i.get("size",100),e.align=i.get("align","middle"),e.position=i.get("position",{start:0,left:0,middle:50,end:100,right:100},e.align),e.positionAlign=i.get("positionAlign",{start:"start",left:"start",middle:"middle",end:"end",right:"end"},e.align)}(t,e)}i.prototype=r(Error.prototype),i.prototype.constructor=i,i.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}},a.prototype={set:function(t,e){this.get(t)||""===e||(this.values[t]=e)},get:function(t,e,r){return r?this.has(t)?this.values[t]:e[r]:this.has(t)?this.values[t]:e},has:function(t){return t in this.values},alt:function(t,e,r){for(var i=0;i<r.length;++i)if(e===r[i]){this.set(t,e);break}},integer:function(t,e){/^-?\d+$/.test(e)&&this.set(t,parseInt(e,10))},percent:function(t,e){return!!(e.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&(e=parseFloat(e))>=0&&e<=100)&&(this.set(t,e),!0)}};var l={"&amp;":"&","&lt;":"<","&gt;":">","&lrm;":"‎","&rlm;":"‏","&nbsp;":" "},u={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},c={v:"title",lang:"lang"},h={rt:"ruby"};function d(t,e){function r(){if(!e)return null;var t,r=e.match(/^([^<]*)(<[^>]*>?)?/);return t=r[1]?r[1]:r[2],e=e.substr(t.length),t}function i(t){return l[t]}function a(t){for(;y=t.match(/&(amp|lt|gt|lrm|rlm|nbsp);/);)t=t.replace(y[0],i);return t}function o(t,e){return!h[e.localName]||h[e.localName]===t.localName}function s(e,r){var i=u[e];if(!i)return null;var n=t.document.createElement(i);n.localName=i;var a=c[e];return a&&r&&(n[a]=r.trim()),n}for(var d,f=t.document.createElement("div"),p=f,g=[];null!==(d=r());)if("<"!==d[0])p.appendChild(t.document.createTextNode(a(d)));else{if("/"===d[1]){g.length&&g[g.length-1]===d.substr(2).replace(">","")&&(g.pop(),p=p.parentNode);continue}var v,m=n(d.substr(1,d.length-2));if(m){v=t.document.createProcessingInstruction("timestamp",m),p.appendChild(v);continue}var y=d.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!y)continue;if(!(v=s(y[1],y[3])))continue;if(!o(p,v))continue;y[2]&&(v.className=y[2].substr(1).replace("."," ")),g.push(y[1]),p.appendChild(v),p=v}return f}var f=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function p(t){for(var e=0;e<f.length;e++){var r=f[e];if(t>=r[0]&&t<=r[1])return!0}return!1}function g(){}function v(t,e,r){var i=/MSIE\s8\.0/.test(navigator.userAgent),n="rgba(255, 255, 255, 1)",a="rgba(0, 0, 0, 0.8)";i&&(n="rgb(255, 255, 255)",a="rgb(0, 0, 0)"),g.call(this),this.cue=e,this.cueDiv=d(t,e.text);var o={color:n,backgroundColor:a,position:"relative",left:0,right:0,top:0,bottom:0,display:"inline"};i||(o.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl",o.unicodeBidi="plaintext"),this.applyStyles(o,this.cueDiv),this.div=t.document.createElement("div"),o={textAlign:"middle"===e.align?"center":e.align,font:r.font,whiteSpace:"pre-line",position:"absolute"},i||(o.direction=function(t){var e=[],r="";if(!t||!t.childNodes)return"ltr";function i(t,e){for(var r=e.childNodes.length-1;r>=0;r--)t.push(e.childNodes[r])}function n(t){if(!t||!t.length)return null;var e=t.pop(),r=e.textContent||e.innerText;if(r){var a=r.match(/^.*(\n|\r)/);return a?(t.length=0,a[0]):r}return"ruby"===e.tagName?n(t):e.childNodes?(i(t,e),n(t)):void 0}for(i(e,t);r=n(e);)for(var a=0;a<r.length;a++)if(p(r.charCodeAt(a)))return"rtl";return"ltr"}(this.cueDiv),o.writingMode=""===e.vertical?"horizontal-tb":"lr"===e.vertical?"vertical-lr":"vertical-rl".stylesunicodeBidi="plaintext"),this.applyStyles(o),this.div.appendChild(this.cueDiv);var s=0;switch(e.positionAlign){case"start":s=e.position;break;case"middle":s=e.position-e.size/2;break;case"end":s=e.position-e.size}""===e.vertical?this.applyStyles({left:this.formatStyle(s,"%"),width:this.formatStyle(e.size,"%")}):this.applyStyles({top:this.formatStyle(s,"%"),height:this.formatStyle(e.size,"%")}),this.move=function(t){this.applyStyles({top:this.formatStyle(t.top,"px"),bottom:this.formatStyle(t.bottom,"px"),left:this.formatStyle(t.left,"px"),right:this.formatStyle(t.right,"px"),height:this.formatStyle(t.height,"px"),width:this.formatStyle(t.width,"px")})}}function m(t){var e,r,i,n,a=/MSIE\s8\.0/.test(navigator.userAgent);if(t.div){r=t.div.offsetHeight,i=t.div.offsetWidth,n=t.div.offsetTop;var o=(o=t.div.childNodes)&&(o=o[0])&&o.getClientRects&&o.getClientRects();t=t.div.getBoundingClientRect(),e=o?Math.max(o[0]&&o[0].height||0,t.height/o.length):0}this.left=t.left,this.right=t.right,this.top=t.top||n,this.height=t.height||r,this.bottom=t.bottom||n+(t.height||r),this.width=t.width||i,this.lineHeight=void 0!==e?e:t.lineHeight,a&&!this.lineHeight&&(this.lineHeight=13)}function y(t,e,r,i){var n=new m(e),a=e.cue,o=function(t){if("number"==typeof t.line&&(t.snapToLines||t.line>=0&&t.line<=100))return t.line;if(!t.track||!t.track.textTrackList||!t.track.textTrackList.mediaElement)return-1;for(var e=t.track,r=e.textTrackList,i=0,n=0;n<r.length&&r[n]!==e;n++)"showing"===r[n].mode&&i++;return-1*++i}(a),s=[];if(a.snapToLines){var l;switch(a.vertical){case"":s=["+y","-y"],l="height";break;case"rl":s=["+x","-x"],l="width";break;case"lr":s=["-x","+x"],l="width"}var u=n.lineHeight,c=u*Math.round(o),h=r[l]+u,d=s[0];Math.abs(c)>h&&(c=c<0?-1:1,c*=Math.ceil(h/u)*u),o<0&&(c+=""===a.vertical?r.height:r.width,s=s.reverse()),n.move(d,c)}else{var f=n.lineHeight/r.height*100;switch(a.lineAlign){case"middle":o-=f/2;break;case"end":o-=f}switch(a.vertical){case"":e.applyStyles({top:e.formatStyle(o,"%")});break;case"rl":e.applyStyles({left:e.formatStyle(o,"%")});break;case"lr":e.applyStyles({right:e.formatStyle(o,"%")})}s=["+y","-x","+x","-y"],n=new m(e)}var p=function(t,e){for(var n,a=new m(t),o=1,s=0;s<e.length;s++){for(;t.overlapsOppositeAxis(r,e[s])||t.within(r)&&t.overlapsAny(i);)t.move(e[s]);if(t.within(r))return t;var l=t.intersectPercentage(r);o>l&&(n=new m(t),o=l),t=new m(a)}return n||a}(n,s);e.move(p.toCSSCompatValues(r))}function b(){}g.prototype.applyStyles=function(t,e){for(var r in e=e||this.div,t)t.hasOwnProperty(r)&&(e.style[r]=t[r])},g.prototype.formatStyle=function(t,e){return 0===t?0:t+e},v.prototype=r(g.prototype),v.prototype.constructor=v,m.prototype.move=function(t,e){switch(e=void 0!==e?e:this.lineHeight,t){case"+x":this.left+=e,this.right+=e;break;case"-x":this.left-=e,this.right-=e;break;case"+y":this.top+=e,this.bottom+=e;break;case"-y":this.top-=e,this.bottom-=e}},m.prototype.overlaps=function(t){return this.left<t.right&&this.right>t.left&&this.top<t.bottom&&this.bottom>t.top},m.prototype.overlapsAny=function(t){for(var e=0;e<t.length;e++)if(this.overlaps(t[e]))return!0;return!1},m.prototype.within=function(t){return this.top>=t.top&&this.bottom<=t.bottom&&this.left>=t.left&&this.right<=t.right},m.prototype.overlapsOppositeAxis=function(t,e){switch(e){case"+x":return this.left<t.left;case"-x":return this.right>t.right;case"+y":return this.top<t.top;case"-y":return this.bottom>t.bottom}},m.prototype.intersectPercentage=function(t){return Math.max(0,Math.min(this.right,t.right)-Math.max(this.left,t.left))*Math.max(0,Math.min(this.bottom,t.bottom)-Math.max(this.top,t.top))/(this.height*this.width)},m.prototype.toCSSCompatValues=function(t){return{top:this.top-t.top,bottom:t.bottom-this.bottom,left:this.left-t.left,right:t.right-this.right,height:this.height,width:this.width}},m.getSimpleBoxPosition=function(t){var e=t.div?t.div.offsetHeight:t.tagName?t.offsetHeight:0,r=t.div?t.div.offsetWidth:t.tagName?t.offsetWidth:0,i=t.div?t.div.offsetTop:t.tagName?t.offsetTop:0;return{left:(t=t.div?t.div.getBoundingClientRect():t.tagName?t.getBoundingClientRect():t).left,right:t.right,top:t.top||i,height:t.height||e,bottom:t.bottom||i+(t.height||e),width:t.width||r}},b.StringDecoder=function(){return{decode:function(t){if(!t)return"";if("string"!=typeof t)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(t))}}},b.convertCueToDOMTree=function(t,e){return t&&e?d(t,e):null};b.processCues=function(t,e,r){if(!t||!e||!r)return null;for(;r.firstChild;)r.removeChild(r.firstChild);var i=t.document.createElement("div");if(i.style.position="absolute",i.style.left="0",i.style.right="0",i.style.top="0",i.style.bottom="0",i.style.margin="1.5%",r.appendChild(i),function(t){for(var e=0;e<t.length;e++)if(t[e].hasBeenReset||!t[e].displayState)return!0;return!1}(e)){var n=[],a=m.getSimpleBoxPosition(i),o={font:Math.round(.05*a.height*100)/100+"px sans-serif"};!function(){for(var r,s,l=0;l<e.length;l++)s=e[l],r=new v(t,s,o),i.appendChild(r.div),y(0,r,a,n),s.displayState=r.div,n.push(m.getSimpleBoxPosition(r))}()}else for(var s=0;s<e.length;s++)i.appendChild(e[s].displayState)},b.Parser=function(t,e,r){r||(r=e,e={}),e||(e={}),this.window=t,this.vttjs=e,this.state="INITIAL",this.buffer="",this.decoder=r||new TextDecoder("utf8"),this.regionList=[]},b.Parser.prototype={reportOrThrowError:function(t){if(!(t instanceof i))throw t;this.onparsingerror&&this.onparsingerror(t)},parse:function(t){var e=this;function r(){for(var t=e.buffer,r=0;r<t.length&&"\r"!==t[r]&&"\n"!==t[r];)++r;var i=t.substr(0,r);return"\r"===t[r]&&++r,"\n"===t[r]&&++r,e.buffer=t.substr(r),i}function l(t){t.match(/X-TIMESTAMP-MAP/)?o(t,function(t,r){switch(t){case"X-TIMESTAMP-MAP":i=r,s=new a,o(i,function(t,e){switch(t){case"MPEGT":s.integer(t+"S",e);break;case"LOCA":s.set(t+"L",n(e))}},/[^\d]:/,/,/),e.ontimestampmap&&e.ontimestampmap({MPEGTS:s.get("MPEGTS"),LOCAL:s.get("LOCAL")})}var i,s},/=/):o(t,function(t,r){switch(t){case"Region":!function(t){var r=new a;if(o(t,function(t,e){switch(t){case"id":r.set(t,e);break;case"width":r.percent(t,e);break;case"lines":r.integer(t,e);break;case"regionanchor":case"viewportanchor":var i=e.split(",");if(2!==i.length)break;var n=new a;if(n.percent("x",i[0]),n.percent("y",i[1]),!n.has("x")||!n.has("y"))break;r.set(t+"X",n.get("x")),r.set(t+"Y",n.get("y"));break;case"scroll":r.alt(t,e,["up"])}},/=/,/\s/),r.has("id")){var i=new(e.vttjs.VTTRegion||e.window.VTTRegion);i.width=r.get("width",100),i.lines=r.get("lines",3),i.regionAnchorX=r.get("regionanchorX",0),i.regionAnchorY=r.get("regionanchorY",100),i.viewportAnchorX=r.get("viewportanchorX",0),i.viewportAnchorY=r.get("viewportanchorY",100),i.scroll=r.get("scroll",""),e.onregion&&e.onregion(i),e.regionList.push({id:r.get("id"),region:i})}}(r)}},/:/)}t&&(e.buffer+=e.decoder.decode(t,{stream:!0}));try{var u;if("INITIAL"===e.state){if(!/\r\n|\n/.test(e.buffer))return this;var c=(u=r()).match(/^WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new i(i.Errors.BadSignature);e.state="HEADER"}for(var h=!1;e.buffer;){if(!/\r\n|\n/.test(e.buffer))return this;switch(h?h=!1:u=r(),e.state){case"HEADER":/:/.test(u)?l(u):u||(e.state="ID");continue;case"NOTE":u||(e.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(u)){e.state="NOTE";break}if(!u)continue;if(e.cue=new(e.vttjs.VTTCue||e.window.VTTCue)(0,0,""),e.state="CUE",-1===u.indexOf("--\x3e")){e.cue.id=u;continue}case"CUE":try{s(u,e.cue,e.regionList)}catch(t){e.reportOrThrowError(t),e.cue=null,e.state="BADCUE";continue}e.state="CUETEXT";continue;case"CUETEXT":var d=-1!==u.indexOf("--\x3e");if(!u||d&&(h=!0)){e.oncue&&e.oncue(e.cue),e.cue=null,e.state="ID";continue}e.cue.text&&(e.cue.text+="\n"),e.cue.text+=u;continue;case"BADCUE":u||(e.state="ID");continue}}}catch(t){e.reportOrThrowError(t),"CUETEXT"===e.state&&e.cue&&e.oncue&&e.oncue(e.cue),e.cue=null,e.state="INITIAL"===e.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),(this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new i(i.Errors.BadSignature)}catch(t){this.reportOrThrowError(t)}return this.onflush&&this.onflush(),this}},t.exports=b}});