webpackJsonp([7],{Icrm:function(t,e){},M0wq:function(t,e){},NyI8:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});n("wiMi"),n("ZKpu");function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function r(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=n("/C1n").a.postIfLogin,i={data:function(){return{ws:null,count:0,userId:null,list:[],contentText:"",userInfo:{}}},created:function(){this.getUserID()},mounted:function(){var t=this;s().then(function(e){console.log(e.data,"oi"),t.userInfo=e.data.userInfo}).catch(function(t){console.log(t)}),this.initWebSocket()},methods:{getUserID:function(){var t=(new Date).getTime();this.userId=t},getUserHead:function(t,e){var n=String(t);return"bck"==e?Number(n.substring(n.length-3)):"polygon"==e?Number(n.substring(n.length-2)):"rotate"==e?Number(n.substring(n.length-3)):void 0},scrollBottm:function(){var t=this.$refs["msg-box"];t.scrollTop=t.scrollHeight},sendText:function(){var t=this;if(t.$refs.sendMsg.focus(),t.contentText){var e={userId:t.userId,msg:t.contentText};t.ws.send(JSON.stringify(e)),t.contentText="",setTimeout(function(){t.scrollBottm()},500)}},initWebSocket:function(){var t=this;if(window.WebSocket){var e=new WebSocket("ws://localhost:3000");t.ws=e,e.onopen=function(){console.log("服务器连接成功")},e.onclose=function(){console.log("服务器连接关闭")},e.onerror=function(){console.log("服务器连接出错")},e.onmessage=function(e){var n=JSON.parse(e.data);"userCount"==n.funName?(t.count=n.users,t.list=n.chat,console.log(n.chat)):t.list=[].concat(r(t.list),[{userId:n.userId,content:n.msg}])}}}}},a={render:function(){var t,e=this,n=e.$createElement,o=e._self._c||n;return o("div",{staticClass:"chat-box"},[o("header",[e._v("聊天室人数："+e._s(e.count))]),e._v(" "),o("div",{ref:"msg-box",staticClass:"msg-box"},e._l(e.list,function(t,n){return o("div",{key:n,staticClass:"msg",style:t.userId==e.userId?"flex-direction:row-reverse":""},[o("div",{staticClass:"user-head"},[o("div",{staticClass:"head",style:" background: hsl("+e.getUserHead(t.userId,"bck")+", 88%, 62%); clip-path:polygon("+e.getUserHead(t.userId,"polygon")+"% 0,100% 100%,0% 100%); transform: rotate("+e.getUserHead(t.userId,"rotate")+"deg)"}),e._v(" "),o("span",[e._v(e._s(e.userInfo.user))])]),e._v(" "),o("div",{staticClass:"user-msg"},[o("span",{class:t.userId==e.userId?"right":"left",style:t.userId==e.userId?" float: right;":""},[e._v(e._s(t.content))])])])}),0),e._v(" "),o("div",{staticClass:"input-box"},[o("input",{directives:[{name:"model",rawName:"v-model",value:e.contentText,expression:"contentText"}],ref:"sendMsg",attrs:{type:"text"},domProps:{value:e.contentText},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendText()},input:function(t){t.target.composing||(e.contentText=t.target.value)}}}),e._v(" "),o("el-button",{staticClass:"btn",class:(t={},t["btn-active"]=e.contentText,t),on:{click:function(t){return e.sendText()}}},[e._v("发送")])],1)])},staticRenderFns:[]};var c={name:"football",components:{Websocket:n("VU/8")(i,a,!1,function(t){n("Icrm")},"data-v-36e0166e",null).exports}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("a",{attrs:{href:"http://www.azhibo.com/zuqiuzhibo"}},[this._v("足球直播")]),this._v(" "),e("Websocket")],1)},staticRenderFns:[]};var l=n("VU/8")(c,u,!1,function(t){n("M0wq")},"data-v-54507ddc",null);e.default=l.exports}});